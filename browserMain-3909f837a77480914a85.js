!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="9ffac5f6-ff3f-49a2-a553-187cbe5626fb",e._sentryDebugIdIdentifier="sentry-dbid-9ffac5f6-ff3f-49a2-a553-187cbe5626fb")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"3ae18205e144817c98fea0ce94c372b9b5faea00"},(()=>{"use strict";var e,t,n,o={92770:(e,t,n)=>{n.d(t,{De:()=>s,PE:()=>o,a2:()=>r});const o={pixelsPerTick:.1,keyHeight:12,keyWidth:64,blackKeyWidthRatio:.64,rulerHeight:32},r=127,s=1/120},20910:(e,t,n)=>{n.d(t,{DA:()=>y,Fl:()=>v,IA:()=>m,PT:()=>k,fX:()=>g,hM:()=>f,j$:()=>x,s0:()=>b,vi:()=>j});var o=n(9680),r=n.n(o),s=n(15883),i=n(71229),l=n(95949),a=n(30876),c=n(20604),d=n(51046),u=n(59061),h=n(15738),p=n(68464);const m=()=>{const{song:{tracks:e},arrangeViewStore:t,arrangeViewStore:{quantizer:n}}=(0,u.g)();return(o,r)=>{t.selection=l.p.fromPoints(o,r,n,e.length)}},g=()=>{const{arrangeViewStore:e,song:{tracks:t}}=(0,u.g)();return()=>{const{selection:n}=e;n&&(e.selectedEventIds=function(e,t){const n={};for(let o=t.fromTrackIndex;o<t.toTrackIndex;o++){const r=e[o].events.filter((0,d.F)(i.Q.create(t.fromTick,t.toTick)));n[o]=r.map((e=>e.id))}return n}(t,n))}},x=()=>{const{arrangeViewStore:e,arrangeViewStore:{quantizer:t},song:{tracks:n}}=(0,u.g)(),o=w();return r=>{const{selection:s}=e;if(null===s)return;r={tick:t.round(r.tick),trackIndex:Math.round(r.trackIndex)},r=a.n.clamp(r,n.length-(s.toTrackIndex-s.fromTrackIndex));const i=a.n.sub(r,l.p.start(s));o(i)}},w=()=>{const{arrangeViewStore:e,song:{tracks:t}}=(0,u.g)();return n=>{if(null===e.selection)return;if(0===n.tick&&0===n.trackIndex)return;const o=l.p.moved(e.selection,n);e.selection=o;const r=[];for(const[o,s]of Object.entries(e.selectedEventIds)){const e=parseInt(o,10),i=t[e],l=s.map((e=>i.getEventById(e))).filter(c.EA);0===n.trackIndex?i.updateEvents(l.map((e=>({id:e.id,tick:e.tick+n.tick})))):r.push({sourceTrackIndex:e,destinationTrackIndex:e+n.trackIndex,events:l.map((e=>({...e,tick:e.tick+n.tick})))})}if(0!==n.trackIndex){const n={};for(const e of r){t[e.sourceTrackIndex].removeEvents(e.events.map((e=>e.id)));const o=t[e.destinationTrackIndex].addEvents(e.events);n[e.destinationTrackIndex]=o.map((e=>e.id))}e.selectedEventIds=n}}},f=()=>{const{arrangeViewStore:{selection:e,selectedEventIds:t},song:{tracks:n}}=(0,u.g)();return()=>{if(null===e)return;const o={type:"arrange_notes",notes:r()(t,((t,o)=>{const r=n[parseInt(o,10)];return t.map((e=>r.getEventById(e))).filter(c.EA).map((t=>({...t,tick:t.tick-e.fromTick})))})),selectedTrackIndex:e.fromTrackIndex};h.A.writeText(JSON.stringify(o))}},v=()=>{const{song:{tracks:e},player:t,arrangeViewStore:{selectedTrackIndex:n},pushHistory:o}=(0,u.g)();return()=>{const r=h.A.readText();if(!r||0===r.length)return;const i=JSON.parse(r);if((0,s.eF)(i)){o();for(const o in i.notes){const r=i.notes[o].map((e=>({...e,tick:e.tick+t.position}))),s=n<0?0:-i.selectedTrackIndex+n,l=parseInt(o)+s;l<e.length&&e[l].addEvents(r)}}}},y=()=>{const{arrangeViewStore:e,song:{tracks:t},pushHistory:n}=(0,u.g)();return()=>{n();for(const n in e.selectedEventIds)t[n].removeEvents(e.selectedEventIds[n]);e.selection=null,e.selectedEventIds=[]}},j=()=>{const{song:e,pushHistory:t,arrangeViewStore:{selectedEventIds:n}}=(0,u.g)();return o=>{t(),e.transposeNotes(o,n)}},k=()=>{const{song:{tracks:e},arrangeViewStore:t,arrangeViewStore:{selection:n,selectedEventIds:o},pushHistory:r}=(0,u.g)();return()=>{if(null===n)return;r();const s=n.toTick-n.fromTick,i={};for(const[t,n]of Object.entries(o)){const o=parseInt(t,10),r=e[o],l=n.map((e=>r.getEventById(e))).filter(c.EA),a=r.addEvents(l.map((e=>({...e,tick:e.tick+s}))));i[o]=a.map((e=>e.id))}t.selection={fromTick:n.fromTick+s,fromTrackIndex:n.fromTrackIndex,toTick:n.toTick+s,toTrackIndex:n.toTrackIndex},t.selectedEventIds=i}},b=()=>{const{arrangeViewStore:e,song:{tracks:t},pushHistory:n}=(0,u.g)();return o=>{const{selectedEventIds:r}=e;n();for(const[e,n]of Object.entries(r)){const r=parseInt(e,10),s=t[r];(0,p.a8)(s,n,o)}}}},11735:(e,t,n)=>{n.d(t,{GB:()=>d,Hd:()=>i,JN:()=>u,cx:()=>a,ps:()=>l,r3:()=>c});var o=n(92390),r=n(59061),s=n(96684);const i=()=>{const{cloudSongDataRepository:e}=(0,r.g)();return async t=>{const n=await e.get(t.songDataId),o=(0,s.fp)(n);return o.name=t.name,o.cloudSongId=t.id,o.cloudSongDataId=t.songDataId,o.isSaved=!0,o}},l=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,r.g)();return async n=>{const o=(0,s.KO)(n),r=await t.create({data:o}),i=await e.create({name:n.name,songDataId:r});n.cloudSongDataId=r,n.cloudSongId=i,n.isSaved=!0}},a=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,r.g)();return async n=>{if(null===n.cloudSongId||null===n.cloudSongDataId)throw new Error("This song is not loaded from the cloud");const o=(0,s.KO)(n);await e.update(n.cloudSongId,{name:n.name}),await t.update(n.cloudSongDataId,{data:o}),n.isSaved=!0}},c=()=>{const{cloudMidiRepository:e}=(0,r.g)();return async t=>{const n=await e.storeMidiFile(t),r=await e.get(n),i=(0,s.fp)(r);return i.name=(0,o.P)(t)??"",i.isSaved=!0,i}},d=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,r.g)();return async(n,o)=>{if(null===n.cloudSongId||null===n.cloudSongDataId)throw new Error("This song is not saved in the cloud");await t.publish(n.cloudSongDataId),await e.publish(n.cloudSongId,o)}},u=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,r.g)();return async n=>{if(null===n.cloudSongId||null===n.cloudSongDataId)throw new Error("This song is not loaded from the cloud");await t.unpublish(n.cloudSongDataId),await e.unpublish(n.cloudSongId)}}},68278:(e,t,n)=>{n.d(t,{$H:()=>a,AT:()=>p,Ay:()=>c,SR:()=>d,mj:()=>h,yw:()=>u});var o=n(17243),r=n(15883),s=n(20604),i=n(59061),l=n(15738);const a=()=>{const{controlStore:{selectedEventIds:e,selectedTrack:t},player:n,pushHistory:o}=(0,i.g)();return r=>{if(void 0===t)return;o();const i=e.map((e=>t.getEventById(e))).filter(s.EA);i.length>0?i.forEach((e=>t.updateEvent(e.id,{value:r.value}))):t.createOrUpdate({...r,tick:n.position})}},c=()=>{const{controlStore:e,controlStore:{selectedEventIds:t,selectedTrack:n},pushHistory:o}=(0,i.g)();return()=>{void 0!==n&&0!==t.length&&(o(),n.removeEvents(t),e.selection=null)}},d=()=>{const{controlStore:e}=(0,i.g)();return()=>{e.selection=null,e.selectedEventIds=[]}},u=()=>{const{controlStore:{selectedEventIds:e,selectedTrack:t}}=(0,i.g)();return()=>{if(void 0===t||0===e.length)return;const n=e.map((e=>t.getEventById(e))).filter(s.EA),r=(0,o.min)(n.map((e=>e.tick)));if(void 0===r)return;const i={type:"control_events",events:n.map((e=>({...e,tick:e.tick-r})))};l.A.writeText(JSON.stringify(i))}},h=()=>{const{pianoRollStore:{selectedTrack:e},player:t,pushHistory:n}=(0,i.g)();return()=>{if(void 0===e)return;const o=l.A.readText();if(!o||0===o.length)return;const s=JSON.parse(o);if(!(0,r.Np)(s))return;n();const i=s.events.map((e=>({...e,tick:e.tick+t.position})));e.transaction((e=>i.forEach((t=>e.createOrUpdate(t)))))}},p=()=>{const{controlStore:e,controlStore:{selectedEventIds:t,selectedTrack:n},pushHistory:r}=(0,i.g)();return()=>{if(void 0===n||0===t.length)return;r();const i=t.map((e=>n.getEventById(e))).filter(s.EA),l=((0,o.maxBy)(i,(e=>e.tick))?.tick??0)-((0,o.minBy)(i,(e=>e.tick))?.tick??0),a=i.map((e=>({...e,tick:e.tick+l}))),c=n.transaction((e=>a.map((t=>e.createOrUpdate(t)))));e.selectedEventIds=c.map((e=>e.id))}}},30201:(e,t,n)=>{n.d(t,{Id:()=>u,j8:()=>d});var o=n(1902),r=n(20994),s=n(80406),i=n(30013),l=n(59061),a=n(97233);const c=()=>new Promise((e=>window.requestAnimationFrame((()=>e())))),d=()=>{const{song:e,synth:t,exportStore:n}=(0,l.g)(),i=(0,a.B2)(),d=(0,r.sp)();return async r=>{if(!h(e))return void await d.show({title:i.export,message:i["export-error-too-short"],actions:[{title:"OK",key:"ok"}]});const l=t.loadedSoundFontData;if(null!==l){n.isCanceled=!1,n.openExportProgressDialog=!0,n.progress=0;try{const t=await(0,o.b7)(l,e.allEvents,e.timebase,44100,{bufferSize:128,cancel:()=>n.isCanceled,waitForEventLoop:c,onProgress:(e,t)=>n.progress=e/t});n.progress=1;const i=p(r),a=await i.encode(t),d=new Blob([a],{type:i.mimeType});n.openExportProgressDialog=!1,(0,s.W)(d,"song."+i.ext)}catch(e){console.warn(e)}}}},u=()=>{const{exportStore:e}=(0,l.g)();return()=>{e.isCanceled=!0}},h=e=>e.allEvents.some((e=>e.tick>=120)),p=e=>{switch(e){case"WAV":return{encode:i.l,ext:"wav",mimeType:"audio/wav"};case"MP3":return{encode:i.X,ext:"mp3",mimeType:"audio/mp3"}}}},13917:(e,t,n)=>{n.d(t,{OJ:()=>h,Ye:()=>a,c6:()=>p,mZ:()=>d,q5:()=>c,z6:()=>u});var o=n(92390),r=n(96684),s=n(94398),i=n(9034);const l="true"===new URL(window.location.href).searchParams.get("disableFileSystem"),a=("chooseFileSystemEntries"in window||"showOpenFilePicker"in window)&&!l,c=()=>{const e=(0,i.pC)();return async()=>{let t;try{t=(await window.showOpenFilePicker({types:[{description:"MIDI file",accept:{"audio/midi":[".mid"]}}]}))[0]}catch(e){if("AbortError"===e.name)return;const t="An error occured trying to open the file.";return console.error(t,e),void alert(t)}const n=await t.getFile(),o=await d(n);o.fileHandle=t,e(o)}},d=async e=>u(await e.arrayBuffer(),"path"in e?e.path:void 0,e.name),u=(e,t,n)=>{const s=(0,r.fp)(new Uint8Array(e)),i=t??n;return 0===s.name.length&&i&&(s.name=(0,o.P)(i)?.replace(/\.[^/.]+$/,"")??""),t&&(s.filepath=t),s.isSaved=!0,s},h=async e=>{const t=e.fileHandle;if(null===t)return void await p(e);const n=(0,r.KO)(e).buffer;try{await(0,s._)(t,n),e.isSaved=!0}catch(e){console.error(e),alert("unable to save file")}},p=async e=>{let t;try{t=await window.showSaveFilePicker({types:[{description:"MIDI file",accept:{"audio/midi":[".mid"]}}]})}catch(e){if("AbortError"===e.name)return;const t="An error occured trying to open the file.";return console.error(t,e),void alert(t)}try{const n=(0,r.KO)(e).buffer;await(0,s._)(t,n),e.isSaved=!0,e.fileHandle=t}catch(e){const t="Unable to save file.";return console.error(t,e),void alert(t)}}},72083:(e,t,n)=>{n.d(t,{Yw:()=>s,cN:()=>i,kT:()=>r});var o=n(59061);const r=()=>{const{historyStore:e}=(0,o.g)();return()=>e.push()},s=()=>{const{historyStore:e}=(0,o.g)();return()=>e.undo()},i=()=>{const{historyStore:e}=(0,o.g)();return()=>e.redo()}},57925:(e,t,n)=>{n.d(t,{i5:()=>d,iW:()=>h,vB:()=>u});var o=n(50119),r=n(68278),s=n(15883),i=n(59061),l=n(15738),a=n(20910),c=n(87188);const d=()=>{const{router:e,pianoRollStore:t,controlStore:n}=(0,i.g)(),s=(0,o.ti)(),l=(0,a.hM)(),d=(0,c.av)(),u=(0,r.yw)();return()=>{switch(e.path){case"/track":t.selectedNoteIds.length>0?s():n.selectedEventIds.length>0&&u();break;case"/arrange":l();break;case"/tempo":d()}}},u=()=>{const{router:e,pianoRollStore:t,controlStore:n}=(0,i.g)(),s=(0,o.ti)(),l=(0,o.Rb)(),d=(0,a.hM)(),u=(0,a.DA)(),h=(0,c.av)(),p=(0,c._C)(),m=(0,r.yw)(),g=(0,r.Ay)();return()=>{switch(e.path){case"/track":t.selectedNoteIds.length>0?(s(),l()):n.selectedEventIds.length>0&&(m(),g());break;case"/arrange":d(),u();break;case"/tempo":h(),p()}}},h=()=>{const{router:e}=(0,i.g)(),t=(0,o.Nl)(),n=(0,a.Fl)(),d=(0,c.e)(),u=(0,r.mj)();return()=>{switch(e.path){case"/track":{const e=l.A.readText();if(!e||0===e.length)return;const n=JSON.parse(e);(0,s.dn)(n)?t():(0,s.Np)(n)&&u();break}case"/arrange":n();break;case"/tempo":d()}}}},50119:(e,t,n)=>{n.d(t,{$8:()=>c.$8,AF:()=>l.AF,Ay:()=>d.A,C4:()=>c.C4,DA:()=>o.DA,Fl:()=>o.Fl,Fv:()=>s.Fv,IA:()=>o.IA,Id:()=>r.Id,J1:()=>l.J1,J2:()=>c.J2,L$:()=>l.L$,LR:()=>l.LR,Mv:()=>a.Mv,Nl:()=>l.Nl,PT:()=>o.PT,Qm:()=>c.Qm,R8:()=>l.R8,Rb:()=>l.Rb,Sf:()=>c.Sf,Te:()=>c.Te,UI:()=>c.UI,Ut:()=>s.Ut,Vd:()=>a.Vd,W0:()=>c.W0,W3:()=>c.W3,XA:()=>l.XA,Yp:()=>s.Yp,Yr:()=>s.Yr,bO:()=>i.b,bS:()=>a.bS,cY:()=>c.cY,d0:()=>s.d0,eE:()=>l.eE,ed:()=>c.ed,fX:()=>o.fX,fm:()=>l.fm,gg:()=>a.gg,hM:()=>o.hM,i:()=>a.i,i5:()=>c.i5,j$:()=>o.j$,j8:()=>r.j8,jX:()=>a.jX,k9:()=>a.k9,m$:()=>s.m$,mG:()=>s.mG,mg:()=>d.m,mv:()=>c.mv,pC:()=>a.pC,ps:()=>a.ps,qo:()=>s.qo,rm:()=>c.rm,s0:()=>o.s0,sQ:()=>s.sQ,t3:()=>s.t3,ti:()=>l.ti,vi:()=>o.vi,z7:()=>l.z7});var o=n(20910),r=n(30201),s=n(21738),i=n(56400),l=n(14589),a=n(9034),c=n(68464),d=n(55753)},21738:(e,t,n)=>{n.d(t,{Fv:()=>p,Ut:()=>d,Yp:()=>c,Yr:()=>g,d0:()=>h,m$:()=>a,mG:()=>m,qo:()=>i,sQ:()=>l,t3:()=>u});var o=n(52188),r=n(59061),s=n(6358);const i=()=>{const{player:e,pianoRollStore:t}=(0,r.g)();return()=>{e.stop(),e.position=0,t.setScrollLeftInTicks(0)}},l=()=>{const{song:e,player:t,pianoRollStore:n}=(0,r.g)();return()=>{const r=o.t.getPreviousMeasureTick(e.measures,t.position,e.timebase);t.position=r,t.position<n.scrollLeftTicks&&n.setScrollLeftInTicks(t.position)}},a=()=>{const{song:e,player:t,pianoRollStore:n}=(0,r.g)();return()=>{const r=o.t.getNextMeasureTick(e.measures,t.position,e.timebase);t.position=r;const{transform:s,scrollLeft:i}=n,l=s.getX(t.position);l-i>.7*n.canvasWidth&&n.setScrollLeftInPixels(l-.7*n.canvasWidth)}},c=()=>{const{pianoRollStore:e,song:t}=(0,r.g)();return()=>{e.selectedTrackIndex=Math.min(e.selectedTrackIndex+1,t.tracks.length-1)}},d=()=>{const{pianoRollStore:e}=(0,r.g)();return()=>{e.selectedTrackIndex=Math.max(e.selectedTrackIndex-1,1)}},u=()=>{const{pianoRollStore:{selectedTrackId:e},trackMute:t}=(0,r.g)();return()=>{t.isSolo(e)?t.unsolo(e):t.solo(e)}},h=()=>{const{pianoRollStore:{selectedTrackId:e},trackMute:t}=(0,r.g)();return()=>{t.isMuted(e)?t.unmute(e):t.mute(e)}},p=()=>{const{pianoRollStore:{selectedTrackId:e},pianoRollStore:t}=(0,r.g)();return()=>{t.notGhostTrackIds.has(e)?t.notGhostTrackIds.delete(e):t.notGhostTrackIds.add(e)}},m=()=>{const{player:e,synthGroup:t}=(0,r.g)();return function(n){let{channel:o,noteNumber:r,velocity:i}=n,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.activate(),e.sendEvent((0,s.d1)(0,o,r,i),l)}},g=()=>{const{player:e}=(0,r.g)();return function(t){let{channel:n,noteNumber:o}=t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.sendEvent((0,s.dG)(0,n,o,0),r)}}},56400:(e,t,n)=>{n.d(t,{b:()=>r});var o=n(59061);const r=()=>{const{midiRecorder:e,player:t}=(0,o.g)();return()=>{e.isRecording?(e.isRecording=!1,t.stop()):(e.isRecording=!0,t.play())}}},14589:(e,t,n)=>{n.d(t,{AF:()=>R,J1:()=>S,L$:()=>v,LR:()=>b,Nl:()=>f,R8:()=>g,Rb:()=>w,XA:()=>p,eE:()=>y,fm:()=>m,ti:()=>x,z7:()=>C});var o=n(17243),r=n(15883),s=n(70480),i=n(40540),l=n(20604),a=n(26556),c=n(59061),d=n(15738),u=n(22095),h=n(21738);function p(e,t){const n={x:t.fromTick,width:t.toTick-t.fromTick,y:t.toNoteNumber,height:t.fromNoteNumber-t.toNoteNumber};return e.filter(u.Fb).filter((e=>s.r.intersects({x:e.tick,width:e.duration,y:e.noteNumber-1,height:1},n)))}const m=()=>{const{song:e,pianoRollStore:t,pianoRollStore:{selectedTrackIndex:n,selection:o,selectedNoteIds:r},pushHistory:s}=(0,c.g)();return l=>{if(s(),null!==o){const e=i.L.moved(o,0,l);t.selection=e}e.transposeNotes(l,{[n]:r})}},g=()=>{const{pianoRollStore:e,pianoRollStore:{selection:t,selectedNoteIds:n,selectedTrack:o}}=(0,c.g)();return()=>{if(void 0===o||null===t)return;const r=n.map((e=>o.getEventById(e))).filter(l.EA).map((e=>({...e})));o.addEvents(r),e.selectedNoteIds=r.map((e=>e.id))}},x=()=>{const{pianoRollStore:{selection:e,selectedNoteIds:t,selectedTrack:n}}=(0,c.g)();return()=>{if(void 0===n||0===t.length)return;const r=t.map((e=>n.getEventById(e))).filter(l.EA).filter(u.Fb),s=e?.fromTick??(0,o.min)(r.map((e=>e.tick))),i={type:"piano_notes",notes:r.map((e=>({...e,tick:e.tick-s})))};d.A.writeText(JSON.stringify(i))}},w=()=>{const{pianoRollStore:e,pianoRollStore:{selection:t,selectedNoteIds:n,selectedTrack:o},pushHistory:r}=(0,c.g)();return()=>{void 0===o||0===n.length&&null===t||(r(),o.removeEvents(n),e.selection=null,e.selectedNoteIds=[])}},f=()=>{const{player:{position:e},pianoRollStore:{selectedTrack:t},pushHistory:n}=(0,c.g)();return()=>{if(void 0===t)return;const o=d.A.readText();if(!o||0===o.length)return;const s=JSON.parse(o);if(!(0,r.dn)(s))return;n();const i=s.notes.map((t=>({...t,tick:Math.max(0,t.tick+e)})));t.addEvents(i)}},v=()=>{const{pianoRollStore:e,pianoRollStore:{selection:t,selectedNoteIds:n,selectedTrack:r},pushHistory:s}=(0,c.g)();return()=>{if(void 0===r||null===t||0===n.length)return;s();let a=t.toTick-t.fromTick;const c=n.map((e=>r.getEventById(e))).filter(l.EA).filter(u.Fb);if(0===a){const e=(0,o.min)(c.map((e=>e.tick)))??0,t=(0,o.max)(c.map((e=>e.tick+e.duration)))??0;a=t-e}const d=c.map((e=>({...e,tick:e.tick+a}))),h=r.addEvents(d);e.selection=i.L.moved(t,a,0),e.selectedNoteIds=h.map((e=>e.id))}},y=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t},controlStore:n}=(0,c.g)();return o=>{void 0!==t&&(n.selectedEventIds=[],e.selectedNoteIds=[o])}},j=e=>e.filter(u.Fb).sort(((e,t)=>e.tick<t.tick?-1:e.tick>t.tick?1:e.noteNumber<t.noteNumber?-1:e.noteNumber>t.noteNumber?1:0)),k=()=>{const{pianoRollStore:{selectedTrack:e,selectedNoteIds:t},song:n}=(0,c.g)(),o=y(),r=(0,h.mG)(),s=(0,h.Yr)();return i=>{if(void 0===e||0===t.length)return;const c=e.events.filter(u.Fb),d=j(t.map((e=>c.find((t=>t.id===e)))).filter(l.EA));if(0===d.length)return;const h=e?.channel??0,p=j(d)[0],m=j(c),g=m.findIndex((e=>e.id===p.id)),x=m[g],w=m[g+i];void 0!==w&&(o(w.id),s({...x,channel:h}),r({...w,channel:h}),s({...w,channel:h},(0,a.bU)(w.duration,120,n.timebase)/1e3))}},b=()=>{const e=k();return()=>e(1)},C=()=>{const e=k();return()=>e(-1)},S=()=>{const{pianoRollStore:{selectedTrack:e,selectedNoteIds:t,enabledQuantizer:n},pushHistory:o}=(0,c.g)();return()=>{if(void 0===e||0===t.length)return;o();const r=t.map((t=>e.getEventById(t))).filter(l.EA).filter(u.Fb).map((e=>({...e,tick:n.round(e.tick)})));e.updateEvents(r)}},R=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t},controlStore:n}=(0,c.g)();return()=>{t&&(e.selectedNoteIds=t.events.filter(u.Fb).map((e=>e.id)),n.selectedEventIds=[])}}},9034:(e,t,n)=>{n.d(t,{Mv:()=>x,Vd:()=>p,bS:()=>m,gg:()=>h,i:()=>g,jX:()=>u,k9:()=>d,pC:()=>a,ps:()=>c});var o=n(59061),r=n(96684),s=n(35521),i=n(22095),l=n(13917);const a=()=>{const{songStore:e,trackMute:t,pianoRollStore:n,player:r,historyStore:s,arrangeViewStore:l}=(0,o.g)();return o=>{e.song=o,t.reset(),n.setScrollLeftInPixels(0),n.notGhostTrackIds=new Set,n.showTrackList=!0,n.selection=null,n.selectedNoteIds=[],n.selectedTrackId=o.tracks.find((e=>!e.isConductorTrack))?.id??i.ql,l.selection=null,l.selectedEventIds=[],s.clear(),r.stop(),r.reset(),r.position=0}},c=()=>{const e=a();return()=>e((0,s.p)())},d=()=>{const{song:e}=(0,o.g)();return()=>{e.isSaved=!0,(0,r.FI)(e)}},u=()=>{const e=a();return async t=>{const n=await(async e=>{if(null===e.files||0===e.files.length)return Promise.resolve(null);const t=e.files[0];return await(0,l.mZ)(t)})(t);null!==n&&e(n)}},h=()=>{const{song:e,pushHistory:t}=(0,o.g)();return()=>{t(),e.addTrack((0,i.BQ)(Math.min(e.tracks.length-1,15)))}},p=()=>{const{song:e,pianoRollStore:t,arrangeViewStore:n,pushHistory:r}=(0,o.g)();return o=>{if(e.tracks.filter((e=>!e.isConductorTrack)).length<=1)return;r();const s=t.selectedTrackIndex,i=n.selectedTrackIndex;e.removeTrack(o),t.selectedTrackIndex=Math.min(s,e.tracks.length-1),n.selectedTrackIndex=Math.min(i,e.tracks.length-1)}},m=()=>{const{pianoRollStore:e}=(0,o.g)();return t=>{e.selectedTrackId=t}},g=()=>{const{song:e,pushHistory:t}=(0,o.g)();return n=>{t(),e.insertTrack((0,i.BQ)(e.tracks.length-1),n)}},x=()=>{const{song:e,pushHistory:t}=(0,o.g)();return n=>{const o=e.getTrack(n);if(void 0===o)throw new Error("No track found");const r=e.tracks.findIndex((e=>e.id===n)),s=o.clone();s.channel=void 0,t(),e.insertTrack(s,r+1)}}},87188:(e,t,n)=>{n.d(t,{GZ:()=>p,Gm:()=>d,_C:()=>c,av:()=>u,e:()=>h});var o=n(17243),r=n(15883),s=n(20604),i=n(59061),l=n(15738),a=n(22095);const c=()=>{const{song:{conductorTrack:e},tempoEditorStore:t,tempoEditorStore:{selectedEventIds:n},pushHistory:o}=(0,i.g)();return()=>{void 0!==e&&0!==n.length&&(o(),e.removeEvents(n),t.selection=null)}},d=()=>{const{tempoEditorStore:e}=(0,i.g)();return()=>{e.selection=null,e.selectedEventIds=[]}},u=()=>{const{song:{conductorTrack:e},tempoEditorStore:{selectedEventIds:t}}=(0,i.g)();return()=>{if(void 0===e||0===t.length)return;const n=t.map((t=>e.getEventById(t))).filter(s.EA).filter(a.u3),r=(0,o.min)(n.map((e=>e.tick)));if(void 0===r)return;const i={type:"tempo_events",events:n.map((e=>({...e,tick:e.tick-r})))};l.A.writeText(JSON.stringify(i))}},h=()=>{const{song:{conductorTrack:e},player:t,pushHistory:n}=(0,i.g)();return()=>{if(void 0===e)return;const o=l.A.readText();if(!o||0===o.length)return;const s=JSON.parse(o);if(!(0,r.dQ)(s))return;n();const i=s.events.map((e=>({...e,tick:e.tick+t.position})));e.transaction((e=>{i.forEach((t=>e.createOrUpdate(t)))}))}},p=()=>{const{song:{conductorTrack:e},tempoEditorStore:t,tempoEditorStore:{selectedEventIds:n},pushHistory:r}=(0,i.g)();return()=>{if(void 0===e||0===n.length)return;r();const i=n.map((t=>e.getEventById(t))).filter(s.EA),l=((0,o.maxBy)(i,(e=>e.tick))?.tick??0)-((0,o.minBy)(i,(e=>e.tick))?.tick??0),a=i.map((e=>({...e,tick:e.tick+l}))),c=e.transaction((e=>a.map((t=>e.createOrUpdate(t)))));t.selectedEventIds=c.map((e=>e.id))}}},68464:(e,t,n)=>{n.d(t,{$8:()=>w,C4:()=>b,J2:()=>f,Qm:()=>R,Sf:()=>p,Te:()=>h,UI:()=>C,W0:()=>m,W3:()=>j,a8:()=>S,cY:()=>g,ed:()=>v,i5:()=>k,mv:()=>y,rm:()=>x});var o=n(17243),r=n(29909),s=n(71229),i=n(52188),l=n(20604),a=n(51046),c=n(59061),d=n(6358),u=n(22095);n(21738);const h=()=>{const{song:e,pushHistory:t}=(0,c.g)();return(n,o)=>{const r=e.conductorTrack;void 0!==r&&(t(),r.updateEvent(n,{microsecondsPerBeat:o}))}},p=()=>{const{pianoRollStore:e,pushHistory:t}=(0,c.g)();return(n,o)=>{const{selectedTrack:r}=e;void 0!==r&&(t(),r.updateEvents(n.map((e=>({id:e,velocity:o})))),e.newNoteVelocity=o)}},m=()=>{const{player:e,pianoRollStore:t,pushHistory:n}=(0,c.g)(),{quantizer:o,selectedTrack:r}=t;return(t,s)=>{if(void 0===r)throw new Error("selected track is undefined");n();const i=r.createOrUpdate({...t,tick:o.round(s??e.position)}).id;return void 0!==s&&e.sendEvent(t),i}},g=()=>{const{pianoRollStore:e}=(0,c.g)();return(t,n,o,r)=>{const{selectedTrack:i,selectedNoteIds:l}=e;if(void 0===i)return;const c=Math.min(t,o),d=Math.max(t,o),h=Math.min(n,r),p=Math.max(n,r),m=(l.length>0?l.map((e=>i.getEventById(e))):i.events.filter(u.Fb)).filter((0,a.F)(s.Q.create(c,d)));i.transaction((e=>{e.updateEvents(m.map((e=>{return{id:e.id,velocity:(s=e.tick,Math.floor(Math.min(p,Math.max(h,(s-t)/(o-t)*(r-n)+n))))};var s})))}))}},x=(e,t,n,o)=>(r,s,i,a)=>{if(void 0===e)throw new Error("track is undefined");const c=Math.min(i,a),d=Math.max(i,a),u=t.floor(Math.max(0,c)),h=t.floor(Math.max(0,d)),p=Math.min(r,s),m=Math.max(r,s),g=a===i?()=>s:e=>Math.floor(Math.min(m,Math.max(p,(e-i)/(a-i)*(s-r)+r))),x=e.events.filter(n).filter((e=>e.tick!==i&&e.tick>=Math.min(c,u)&&e.tick<=Math.max(d,h)));e.transaction((e=>{e.removeEvents(x.map((e=>e.id)));const n=(0,l.Q6)(u,h,t.unit).map((e=>({...o(g(e)),tick:e})));e.addEvents(n)}))},w=()=>{const{pianoRollStore:e}=(0,c.g)();return t=>x(e.selectedTrack,e.quantizer,r.a.getEventPredicate(t),r.a.getEventFactory(t))},f=()=>{const{song:e,player:t,pushHistory:n}=(0,c.g)();return(o,r)=>{n();const s=e.getTrack(o);void 0!==s&&(s.setVolume(r,t.position),void 0!==s.channel&&t.sendEvent((0,d.E0)(0,s.channel,r)))}},v=()=>{const{song:e,player:t,pushHistory:n}=(0,c.g)();return(o,r)=>{n();const s=e.getTrack(o);void 0!==s&&(s.setPan(r,t.position),void 0!==s.channel&&t.sendEvent((0,d.t3)(0,s.channel,r)))}},y=()=>{const{song:e,player:t,pushHistory:n}=(0,c.g)();return(o,r)=>{n();const s=e.getTrack(o);void 0!==s&&(s.setProgramNumber(r),void 0!==s.channel&&t.sendEvent((0,d.Ch)(0,s.channel,r)))}},j=()=>{const{pianoRollStore:e,pushHistory:t}=(0,c.g)();return n=>{t(),e.notGhostTrackIds.has(n)?e.notGhostTrackIds.delete(n):e.notGhostTrackIds.add(n)}},k=()=>{const{song:e,pianoRollStore:t,pushHistory:n}=(0,c.g)();return()=>{if(n(),t.notGhostTrackIds.size>Math.floor(e.tracks.length/2))t.notGhostTrackIds=new Set;else for(const n of e.tracks)t.notGhostTrackIds.add(n.id)}},b=()=>{const{song:e,pushHistory:t}=(0,c.g)();return(n,o,r)=>{const s=i.t.getMeasureStart(e.measures,n,e.timebase).tick;e.timeSignatures?.some((e=>e.tick===s))||(t(),e.conductorTrack?.addEvent({...(0,d.BQ)(0,o,r),tick:s}))}},C=()=>{const{song:e,pushHistory:t}=(0,c.g)();return(n,o,r)=>{t(),e.conductorTrack?.updateEvent(n,{numerator:o,denominator:r})}},S=(e,t,n)=>{const r=t.map((t=>e.getEventById(t))).filter(l.EA).filter(u.Fb);e.updateEvents(r.map((e=>({id:e.id,velocity:(0,o.clamp)(Math.floor(A(n,e.velocity)),1,127)}))))},R=()=>{const{pianoRollStore:e,pushHistory:t}=(0,c.g)(),{selectedTrack:n,selectedNoteIds:o}=e;return e=>{void 0!==n&&(t(),S(n,o,e))}},A=(e,t)=>{switch(e.type){case"set":return e.value;case"add":return t+e.value;case"multiply":return t*e.value}}},55753:(e,t,n)=>{n.d(t,{A:()=>s,m:()=>r});var o=n(59061);const r=()=>{const{song:e,trackMute:t,player:n}=(0,o.g)();return o=>{const r=e.getTrack(o)?.channel;void 0!==r&&(t.isMuted(o)?t.unmute(o):(t.mute(o),n.allSoundsOffChannel(r)))}},s=()=>{const{song:e,trackMute:t,player:n}=(0,o.g)();return o=>{const r=e.getTrack(o)?.channel;void 0!==r&&(t.isSolo(o)?(t.unsolo(o),n.allSoundsOffChannel(r)):(t.solo(o),n.allSoundsOffExclude(r)))}}},15883:(e,t,n)=>{n.d(t,{Np:()=>s,dQ:()=>i,dn:()=>o,eF:()=>r});const o=e=>"piano_notes"===e.type&&"notes"in e,r=e=>"arrange_notes"===e.type&&"notes"in e&&"selectedTrackIndex"in e,s=e=>"control_events"===e.type&&"events"in e,i=e=>"tempo_events"===e.type&&"events"in e},46685:(e,t,n)=>{n.d(t,{q:()=>j});var o=n(20994),r=n(63696),s=n(98914),i=n(87393),l=n(92234),a=n(59061),c=n(9111),d=n(21579),u=n(13546),h=n(73061),p=n(36020),m=n(59797),g=n(19144),x=n(77684),w=n(23945),f=n(30906),v=n(62540);const y=new c.A;function j(){return(0,v.jsx)(r.StrictMode,{children:(0,v.jsx)(a.P.Provider,{value:y,children:(0,v.jsx)(d.N,{children:(0,v.jsx)(s.vd,{children:(0,v.jsx)(o.tE,{component:x.y,children:(0,v.jsx)(o.sk,{component:h.X,children:(0,v.jsx)(o.Co,{component:i.n,children:(0,v.jsx)(o.Vx,{component:u.k,children:(0,v.jsxs)(f.$,{children:[(0,v.jsx)(p.n,{}),(0,v.jsx)(g.r,{}),(0,l.r)()&&(0,v.jsx)(w.q,{}),(0,v.jsx)(m.K,{})]})})})})})})})})})}},47217:(e,t,n)=>{n.d(t,{c:()=>s});var o=n(63696),r=n(62540);const s=e=>{let{onNewFile:t,onClickOpenFile:n,onOpenFile:s,onSaveFile:i,onSaveFileAs:l,onRename:a,onImport:c,onExportWav:d,onExportMp3:u,onUndo:h,onRedo:p,onCut:m,onCopy:g,onPaste:x,onDuplicate:w,onDelete:f,onSelectAll:v,onSelectNextNote:y,onSelectPreviousNote:j,onTransposeUpOctave:k,onTransposeDownOctave:b,onTranspose:C,onQuantize:S,onVelocity:R,onOpenSetting:A,onOpenHelp:T,onBrowserSignInCompleted:E}=e;const[I,D]=(0,o.useState)(!1);return(0,o.useEffect)((()=>window.electronAPI.onNewFile(t)),[t]),(0,o.useEffect)((()=>window.electronAPI.onClickOpenFile(n)),[n]),(0,o.useEffect)((()=>window.electronAPI.onOpenFile(s)),[s]),(0,o.useEffect)((()=>window.electronAPI.onSaveFile(i)),[i]),(0,o.useEffect)((()=>window.electronAPI.onSaveFileAs(l)),[l]),(0,o.useEffect)((()=>window.electronAPI.onRename(a)),[a]),(0,o.useEffect)((()=>window.electronAPI.onImport(c)),[c]),(0,o.useEffect)((()=>window.electronAPI.onExportWav(d)),[d]),(0,o.useEffect)((()=>window.electronAPI.onExportMp3(u)),[u]),(0,o.useEffect)((()=>window.electronAPI.onUndo(h)),[h]),(0,o.useEffect)((()=>window.electronAPI.onRedo(p)),[p]),(0,o.useEffect)((()=>window.electronAPI.onCut(m)),[m]),(0,o.useEffect)((()=>window.electronAPI.onCopy(g)),[g]),(0,o.useEffect)((()=>window.electronAPI.onPaste(x)),[x]),(0,o.useEffect)((()=>window.electronAPI.onDuplicate(w)),[w]),(0,o.useEffect)((()=>window.electronAPI.onDelete(f)),[f]),(0,o.useEffect)((()=>window.electronAPI.onSelectAll(v)),[v]),(0,o.useEffect)((()=>window.electronAPI.onSelectNextNote(y)),[y]),(0,o.useEffect)((()=>window.electronAPI.onSelectPreviousNote(j)),[j]),(0,o.useEffect)((()=>window.electronAPI.onTransposeUpOctave(k)),[k]),(0,o.useEffect)((()=>window.electronAPI.onTransposeDownOctave(b)),[b]),(0,o.useEffect)((()=>window.electronAPI.onTranspose(C)),[C]),(0,o.useEffect)((()=>window.electronAPI.onQuantize(S)),[S]),(0,o.useEffect)((()=>window.electronAPI.onVelocity(R)),[R]),(0,o.useEffect)((()=>window.electronAPI.onOpenSetting(A)),[A]),(0,o.useEffect)((()=>window.electronAPI.onOpenHelp(T)),[T]),(0,o.useEffect)((()=>window.electronAPI.onBrowserSignInCompleted(E)),[E]),(0,o.useEffect)((()=>{I||(D(!0),window.electronAPI.ready())}),[]),(0,r.jsx)(r.Fragment,{})}},23945:(e,t,n)=>{n.d(t,{q:()=>f});var o=n(20994),r=n(17354),s=n(69229),i=n(52932),l=n(50119),a=n(13917),c=n(72083),d=n(57925),u=n(2316),h=n(53416),p=n(59061),m=n(97233),g=n(96684),x=n(47217),w=n(62540);const f=(0,s.PA)((()=>{const{songStore:{song:e},authStore:{isLoggedIn:t},rootViewStore:n,pianoRollStore:s}=(0,p.g)(),f=(0,m.B2)(),v=(0,h.P)(),y=(0,u.R)(),j=(0,o.dj)(),k=(0,d.vB)(),b=(0,d.i5)(),C=(0,d.iW)(),S=(0,l.Rb)(),R=(0,l.L$)(),A=(0,l.AF)(),T=(0,l.LR)(),E=(0,l.z7)(),I=(0,l.J1)(),D=(0,l.fm)(),M=(0,c.Yw)(),O=(0,c.cN)(),P=(0,l.pC)(),B=(0,l.j8)(),N=async()=>{try{const t=await window.electronAPI.showSaveDialog();if(null===t)return;const{path:n}=t,o=(0,g.KO)(e).buffer;e.filepath=n,e.isSaved=!0,await window.electronAPI.saveFile(n,o),window.electronAPI.addRecentDocument(n)}catch(e){alert(e.message)}};return(0,w.jsx)(x.c,{onNewFile:async()=>{t?await y.createNewSong():await v.createNewSong()},onClickOpenFile:async()=>{if(t)await y.openSong();else try{if(e.isSaved||confirm(f["confirm-open"])){const e=await window.electronAPI.showOpenDialog();if(null===e)return;const{path:t,content:n}=e,o=(0,a.z6)(n,t);P(o),window.electronAPI.addRecentDocument(t)}}catch(e){alert(e.message)}},onOpenFile:async t=>{let{filePath:n}=t;try{if(e.isSaved||confirm(f["confirm-open"])){const e=await window.electronAPI.readFile(n),t=(0,a.z6)(e,n);P(t),window.electronAPI.addRecentDocument(n)}}catch(e){alert(e.message)}},onSaveFile:async()=>{if(t)await y.saveSong();else try{if(e.filepath){const t=(0,g.KO)(e).buffer;await window.electronAPI.saveFile(e.filepath,t),e.isSaved=!0}else await N()}catch(e){alert(e.message)}},onSaveFileAs:async()=>{t?await y.saveAsSong():await N()},onRename:async()=>{await y.renameSong()},onImport:async()=>{await y.importSong()},onExportWav:()=>{B("WAV")},onExportMp3:()=>{B("MP3")},onUndo:M,onRedo:O,onCut:k,onCopy:b,onPaste:C,onDuplicate:R,onDelete:S,onSelectAll:A,onSelectNextNote:T,onSelectPreviousNote:E,onTransposeUpOctave:()=>D(12),onTransposeDownOctave:()=>D(-12),onTranspose:()=>{s.openTransposeDialog=!0},onQuantize:I,onVelocity:()=>{s.openVelocityDialog=!0},onOpenSetting:()=>{n.openSettingDialog=!0},onOpenHelp:()=>{n.openHelp=!0},onBrowserSignInCompleted:async e=>{let{credential:t}=e;const n=function(e){switch(e.providerId){case"google.com":return r.HF.credential(e.idToken,e.accessToken);case"github.com":return r.Dt.credential(e.accessToken);case"apple.com":return new r.LD("apple.com").credential({idToken:e.idToken,accessToken:e.accessToken});default:throw new Error("Invalid provider")}}(t);try{await(0,r.eN)(i.j2,n)}catch{j.error("Failed to sign in")}}})}))},30906:(e,t,n)=>{n.d(t,{$:()=>l});var o=n(69229),r=n(59061),s=n(97233),i=n(62540);const l=(0,o.PA)((e=>{let{children:t}=e;const{settingStore:n}=(0,r.g)();return(0,i.jsx)(s.xt.Provider,{value:{language:n.language},children:t})}))},14908:(e,t,n)=>{n.d(t,{p:()=>a});var o=n(69229),r=n(63696),s=n(59061),i=n(76600),l=n(62540);const a=(0,o.PA)((()=>{const{arrangeViewStore:e}=(0,s.g)(),{autoScroll:t}=e,n=(0,r.useCallback)((()=>e.autoScroll=!e.autoScroll),[e]);return(0,l.jsx)(i.X,{onClick:n,selected:t})}))},91936:(e,t,n)=>{n.d(t,{t:()=>a});var o=n(69229),r=n(63696),s=n(59061),i=n(16051),l=n(62540);const a=(0,o.PA)((()=>{const{arrangeViewStore:e}=(0,s.g)(),{quantize:t}=e,n=(0,r.useCallback)((t=>e.quantize=t),[e]);return(0,l.jsx)(i.A,{value:t,enabled:!0,onSelect:n,onClickSwitch:()=>{}})}))},93185:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(46287),r=n(97233),s=n(99677),i=n(14908),l=n(91936),a=n(62540);const c=(0,o.A)("div",{target:"ek8cff31"})({name:"o5zuj0",styles:"font-weight:bold;font-size:1rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:14rem;min-width:3em;margin-left:0.5rem"}),d=(0,o.A)("div",{target:"ek8cff30"})({name:"1ff36h2",styles:"flex-grow:1"}),u=()=>(0,a.jsxs)(s.M,{children:[(0,a.jsx)(c,{children:(0,a.jsx)(r.Oj,{name:"arrangement-view"})}),(0,a.jsx)(d,{}),(0,a.jsx)(l.t,{}),(0,a.jsx)(i.p,{})]})},58124:(e,t,n)=>{n.d(t,{z:()=>h});var o=n(69229),r=n(63696),s=n(50119),i=n(59061),l=n(69673),a=n(97233),c=n(5909),d=n(94724),u=n(62540);const h=(0,o.PA)((e=>{const{handleClose:t}=e,{arrangeViewStore:n}=(0,i.g)(),o=(0,s.hM)(),h=(0,s.DA)(),p=(0,s.Fl)(),m=(0,s.PT)(),g=(0,s.vi)(),x=Object.values(n.selectedEventIds).some((e=>e.length>0)),w=(0,r.useCallback)((()=>{n.openVelocityDialog=!0,t()}),[n]);return(0,u.jsxs)(c.t,{...e,children:[(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),o(),h()},disabled:!x,children:[(0,u.jsx)(a.Oj,{name:"cut"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+X"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),o()},disabled:!x,children:[(0,u.jsx)(a.Oj,{name:"copy"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+C"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),p()},children:[(0,u.jsx)(a.Oj,{name:"paste"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+V"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),m()},disabled:null===n.selection,children:[(0,u.jsx)(a.Oj,{name:"duplicate"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+D"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),h()},disabled:!x,children:[(0,u.jsx)(a.Oj,{name:"delete"}),(0,u.jsx)(c.Z,{children:"Del"})]}),(0,u.jsx)(d.Nj,{}),(0,u.jsx)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),g(12)},disabled:!x,children:(0,u.jsx)(a.Oj,{name:"one-octave-up"})}),(0,u.jsx)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),g(-12)},disabled:!x,children:(0,u.jsx)(a.Oj,{name:"one-octave-down"})}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),n.openTransposeDialog=!0},disabled:!x,children:[(0,u.jsx)(a.Oj,{name:"transpose"}),(0,u.jsx)(c.Z,{children:"T"})]}),(0,u.jsx)(d.Dr,{onClick:w,disabled:!x,children:(0,u.jsx)(a.Oj,{name:"velocity"})})]})}))},22573:(e,t,n)=>{n.d(t,{y:()=>u});var o=n(46287),r=n(93185),s=n(69552),i=n(71751),l=n(8567),a=n(31421),c=n(62540);const d=(0,o.A)("div",{target:"eujt7tr0"})({name:"9itxi",styles:"overflow:hidden;display:flex;flex-direction:column;flex-grow:1;position:relative"}),u=()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(d,{children:[(0,c.jsx)(s.X,{}),(0,c.jsx)(r.Y,{}),(0,c.jsx)(a.y,{})]}),(0,c.jsx)(i.C,{}),(0,c.jsx)(l.I,{})]})},86881:(e,t,n)=>{n.d(t,{A:()=>d});var o=n(69229),r=n(50119),s=n(59061),i=n(97233),l=n(5909),a=n(94724),c=n(62540);const d=(0,o.PA)((e=>{const{handleClose:t}=e,{song:{tracks:n},arrangeViewStore:{selectedTrackIndex:o,selectedTrackId:d}}=(0,s.g)(),u=(0,r.i)(),h=(0,r.Vd)(),p=(0,r.Mv)();return(0,c.jsxs)(l.t,{...e,children:[(0,c.jsx)(a.Dr,{onClick:e=>{e.stopPropagation(),u(o+1),t()},children:(0,c.jsx)(i.Oj,{name:"add-track"})}),o>0&&n.length>2&&(0,c.jsx)(a.Dr,{onClick:e=>{e.stopPropagation(),h(d),t()},children:(0,c.jsx)(i.Oj,{name:"delete-track"})}),o>0&&(0,c.jsx)(a.Dr,{onClick:e=>{e.stopPropagation(),p(d),t()},children:(0,c.jsx)(i.Oj,{name:"duplicate-track"})})]})}))},31421:(e,t,n)=>{n.d(t,{y:()=>E});var o=n(46287),r=n(83785),s=n(96604),i=n.n(s),l=n(17243),a=n(69229),c=n(63696),d=n(92770),u=n(50119),h=n(25649),p=n(78439),m=n(59061),g=n(75710),x=n(8008),w=n(49422),f=n(20038),v=n(58124),y=n(86881),j=n(93975),k=n(43748),b=n(62540);const C=(0,o.A)("div",{target:"eyapa1q4"})("flex-grow:1;display:flex;flex-direction:row;position:relative;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";overflow:hidden;"),S=(0,o.A)("div",{target:"eyapa1q3"})("position:absolute;left:0;top:0;width:100%;box-sizing:border-box;border-bottom:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";"),R=(0,o.A)("div",{target:"eyapa1q2"})("position:absolute;left:0;bottom:0;width:100%;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";"),A=(0,o.A)("div",{target:"eyapa1q1"})("width:8rem;padding:0 0.5rem;box-sizing:border-box;display:flex;border-bottom:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";align-items:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;background-color:",(e=>{let{isSelected:t,theme:n}=e;return t?n.secondaryBackgroundColor:n.backgroundColor}),";"),T=(0,o.A)("div",{target:"eyapa1q0"})("position:relative;border-right:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";"),E=(0,a.PA)((()=>{const{arrangeViewStore:e,arrangeViewStore:{trackHeight:t,contentWidth:n,contentHeight:o,transform:s,scrollLeft:a,scrollTop:E,scrollBy:I,selectedTrackIndex:D},router:M,song:{tracks:O}}=(0,m.g)(),P=(0,u.bS)(),B=(0,k.T)(),N=(0,c.useRef)(null),F=i()(N),z=(0,c.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[]),L=(0,c.useCallback)((t=>e.setScrollTop(t)),[]),G=F.width,H=(0,r.u)();(0,c.useEffect)((()=>{e.canvasWidth=F.width}),[F.width]),(0,c.useEffect)((()=>{e.canvasHeight=F.height}),[F.height]);const W=(0,c.useCallback)((()=>e.scaleAroundPointX(.2,0)),[e]),_=(0,c.useCallback)((()=>e.scaleAroundPointX(-.2,0)),[e]),K=(0,c.useCallback)((()=>e.scaleX=1),[e]),X=(0,c.useCallback)((()=>e.setScaleY(1.2*e.scaleY)),[e]),V=(0,c.useCallback)((()=>e.setScaleY(.8*e.scaleY)),[e]),Y=(0,c.useCallback)((()=>e.setScaleY(1)),[e]),{onContextMenu:q,menuProps:U}=(0,p.E)(),{onContextMenu:$,menuProps:Z}=(0,p.E)(),Q=(0,c.useCallback)((t=>{if(t.shiftKey&&(t.altKey||t.ctrlKey)){let n=(0,h.T)(t.nativeEvent)?.02*t.deltaY:.01*t.deltaX;n=(0,l.clamp)(n,-.15,.15),e.setScaleY(e.scaleY*(1+n))}else if(t.altKey||t.ctrlKey){const n=(0,h.T)(t.nativeEvent)?.01:-.01,o=(0,l.clamp)(t.deltaY*n,-.15,.15);e.scaleAroundPointX(o,t.nativeEvent.offsetX)}else{const n=(0,h.T)(t.nativeEvent)?1:20*s.pixelsPerKey*d.De,o=t.deltaY*n;e.scrollBy(-t.deltaX,-o)}}),[e,I]);return(0,b.jsxs)(C,{children:[(0,b.jsxs)(T,{children:[(0,b.jsx)("div",{style:{marginTop:d.PE.rulerHeight,transform:`translateY(${-E}px)`},children:O.map(((n,o)=>(0,b.jsx)(A,{style:{height:t},isSelected:o===D,onClick:()=>e.selectedTrackIndex=o,onDoubleClick:()=>{return e=n.id,M.pushTrack(),void P(e);var e},onContextMenu:t=>{e.selectedTrackIndex=o,$(t)},children:(0,b.jsx)(x.x,{track:n})},o)))}),(0,b.jsx)(R,{style:{height:f.ZW}})]}),(0,b.jsx)(S,{style:{height:d.PE.rulerHeight}}),(0,b.jsxs)("div",{style:{display:"flex",flexGrow:1,flexDirection:"column",position:"relative",overflow:"hidden"},children:[(0,b.jsxs)("div",{ref:N,onWheel:Q,style:{display:"flex",flexGrow:1,flexDirection:"column",position:"relative",overflow:"hidden",background:H.darkBackgroundColor},children:[(0,b.jsx)(g.A,{rulerStore:e.rulerStore,...B,style:{background:H.backgroundColor,borderBottom:`1px solid ${H.dividerColor}`,boxSizing:"border-box"}}),(0,b.jsx)(j.G,{width:G,onContextMenu:q})]}),(0,b.jsx)("div",{style:{width:`calc(100% - ${f.ZW}px)`,position:"absolute",bottom:0},children:(0,b.jsx)(w.j,{scrollOffset:a,contentLength:n,onScroll:z,onClickScaleUp:W,onClickScaleDown:_,onClickScaleReset:K})})]}),(0,b.jsx)("div",{style:{height:`calc(100% - ${f.ZW}px)`,position:"absolute",top:0,right:0},children:(0,b.jsx)(w.J,{scrollOffset:E,contentLength:o+d.PE.rulerHeight,onScroll:L,onClickScaleUp:X,onClickScaleDown:V,onClickScaleReset:Y})}),(0,b.jsx)("div",{style:{width:f.ZW,height:f.ZW,position:"absolute",bottom:0,right:0,background:H.backgroundColor}}),(0,b.jsx)(v.z,{...U}),(0,b.jsx)(y.A,{...Z})]})}))},93975:(e,t,n)=>{n.d(t,{G:()=>w});var o=n(83785),r=n(47547),s=n(69229),i=n(63696),l=n(28632),a=n(59061),c=n(51618),d=n(98423),u=n(31563),h=n(2697),p=n(70351),m=n(91394),g=n(35487),x=n(62540);const w=(0,s.PA)((e=>{let{width:t,onContextMenu:n}=e;const{arrangeViewStore:{scrollLeft:s,scrollTop:w,contentHeight:f,rulerStore:{beats:v},cursorX:y,selectionRect:j}}=(0,a.g)(),k=(0,o.u)(),b=(0,g.n)(),C=(0,m.c)(),S=(0,i.useMemo)((()=>(0,l.L)(-s,0)),[s]),R=(0,i.useMemo)((()=>(0,l.L)(0,-w)),[w]),A=(0,i.useMemo)((()=>(0,l.L)(-s,-w)),[s,w]),T=(0,i.useCallback)((e=>{switch(e.button){case 0:b.onMouseDown(e);break;case 1:C.onMouseDown(e);break;case 2:n(e)}}),[b,C,n]);return(0,x.jsxs)(r.om,{width:t,height:f,onMouseDown:T,onContextMenu:(0,i.useCallback)((e=>e.preventDefault()),[]),style:{backgroundColor:k.editorBackgroundColor},children:[(0,x.jsx)(r.dL,{matrix:R,children:(0,x.jsx)(h.q,{width:t,zIndex:0})}),(0,x.jsxs)(r.dL,{matrix:S,children:[(0,x.jsx)(c.g,{height:f,beats:v,zIndex:1}),(0,x.jsx)(d.b,{x:y,height:f,zIndex:4})]}),(0,x.jsxs)(r.dL,{matrix:A,children:[(0,x.jsx)(p.u,{zIndex:2}),(0,x.jsx)(u.L,{rect:j,zIndex:3})]})]})}))},2697:(e,t,n)=>{n.d(t,{q:()=>h});var o=n(83785),r=n(47547),s=n(44308),i=n.n(s),l=n(69229),a=n(63696),c=n(72343),d=n(59061),u=n(62540);const h=(0,l.PA)((e=>{let{width:t,zIndex:n}=e;const{song:{tracks:s},arrangeViewStore:{trackTransform:l}}=(0,d.g)(),h=(0,o.u)(),p=e=>({x:0,y:e,width:t,height:1}),m=(0,a.useMemo)((()=>s.map(((e,t)=>l.getY(t+1)-1)).map(p)),[s.length,t,l]),g=(0,c.B)(i()(h.dividerColor));return(0,u.jsx)(r.FX,{rects:m,color:g,zIndex:n})}))},70351:(e,t,n)=>{n.d(t,{u:()=>u});var o=n(83785),r=n(47547),s=n(44308),i=n.n(s),l=n(69229),a=n(72343),c=n(59061),d=n(62540);const u=(0,l.PA)((e=>{let{zIndex:t}=e;const{arrangeViewStore:{notes:n}}=(0,c.g)(),s=(0,o.u)();return(0,d.jsx)(r.FX,{rects:n,color:(0,a.B)(i()(s.themeColor)),zIndex:t})}))},99503:(e,t,n)=>{n.d(t,{r:()=>a});var o=n(50119),r=n(51382),s=n(12968),i=n(54015),l=n(59061);const a=()=>{const{player:e,arrangeViewStore:t,arrangeViewStore:{trackTransform:n}}=(0,l.g)(),a=(0,o.fX)(),c=(0,o.IA)();return{onMouseDown(o,l,d){const u=n.getArrangePoint(d);t.resetSelection(),e.isPlaying||(e.position=t.quantizer.round(u.tick)),t.selectedTrackIndex=Math.floor(u.trackIndex),(0,i.b)({onMouseMove:e=>{const t=r.b.sub((0,s.i)(e),l),o=r.b.add(d,t);c(u,n.getArrangePoint(o))},onMouseUp:()=>{a()}})}}}},91394:(e,t,n)=>{n.d(t,{c:()=>l});var o=n(63696),r=n(51382),s=n(54015),i=n(59061);const l=()=>{const{arrangeViewStore:e,arrangeViewStore:{scrollLeft:t,scrollTop:n}}=(0,i.g)(),l=(0,o.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[]),a=(0,o.useCallback)((t=>e.setScrollTop(t)),[]);return{onMouseDown:(0,o.useCallback)((e=>{function o(e){return{x:e.clientX,y:e.clientY}}const i=o(e.nativeEvent);(0,s.b)({onMouseMove(e){const s=o(e),c=r.b.sub(s,i);l(Math.max(0,t-c.x)),a(Math.max(0,n-c.y))}})}),[t,n,l,a])}}},36782:(e,t,n)=>{n.d(t,{C:()=>a});var o=n(50119),r=n(51382),s=n(12968),i=n(54015),l=n(59061);const a=()=>{const{pushHistory:e,arrangeViewStore:{trackTransform:t}}=(0,l.g)(),n=(0,o.j$)();return{onMouseDown(o,l,a){let c=!1;(0,i.b)({onMouseMove:o=>{const i=r.b.sub((0,s.i)(o),l),d=r.b.add(i,a);0===i.x&&0===i.y||c||(c=!0,e()),n(t.getArrangePoint(d))}})}}}},35487:(e,t,n)=>{n.d(t,{n:()=>c});var o=n(63696),r=n(70480),s=n(12968),i=n(59061),l=n(99503),a=n(36782);const c=()=>{const{arrangeViewStore:{scrollLeft:e,scrollTop:t,selectionRect:n}}=(0,i.g)(),c=(0,a.C)(),d=(0,l.r)();return{onMouseDown:(0,o.useCallback)((o=>{const i={x:o.nativeEvent.offsetX+e,y:o.nativeEvent.offsetY+t},l=(0,s.i)(o.nativeEvent);null!=n&&r.r.containsPoint(n,i)?c.onMouseDown(o,l,n):d.onMouseDown(o,l,i)}),[n,e,t,c,d])}}},43748:(e,t,n)=>{n.d(t,{T:()=>c});var o=n(63696),r=n(50119),s=n(51382),i=n(12968),l=n(54015),a=n(59061);const c=()=>{const{arrangeViewStore:e,song:{tracks:t}}=(0,a.g)(),n=(0,r.IA)(),c=(0,r.fX)();return{onMouseDown:(0,o.useCallback)((o=>{if(0!==o.button||o.ctrlKey||o.altKey)return;const{scrollLeft:r,scrollTop:a,trackTransform:d}=e,u={x:o.nativeEvent.offsetX+r,y:o.nativeEvent.offsetY+a},h=(0,i.i)(o.nativeEvent),p={tick:d.getTick(u.x),trackIndex:0};e.resetSelection(),(0,l.b)({onMouseMove:e=>{const o=s.b.sub((0,i.i)(e),h),r=s.b.add(u,o),l={tick:d.getTick(r.x),trackIndex:t.length};n(p,l)},onMouseUp:()=>{c()}})}),[e,n,c,t])}}},18976:(e,t,n)=>{n.d(t,{j:()=>r}),n(46287);var o=n(62540);const r=()=>(0,o.jsx)(o.Fragment,{})},73245:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(69229),r=n(63696),s=n(59061),i=n(97233),l=n(66459),a=n(5513),c=n(43185),d=n(62540);const u=(0,o.PA)((()=>{const{rootViewStore:e,rootViewStore:{openCloudFileDialog:t}}=(0,s.g)(),n=(0,r.useCallback)((()=>e.openCloudFileDialog=!1),[e]);return(0,d.jsxs)(l.lG,{open:t,onOpenChange:n,style:{minWidth:"30rem"},children:[(0,d.jsx)(l.L3,{children:(0,d.jsx)(i.Oj,{name:"files"})}),(0,d.jsx)(l.Cf,{children:(0,d.jsx)(c.o,{})}),(0,d.jsx)(l.ii,{children:(0,d.jsx)(a.$,{onClick:n,children:(0,d.jsx)(i.Oj,{name:"close"})})})]})}))},43185:(e,t,n)=>{n.d(t,{o:()=>O});var o=n(46287),r=n(83785),s=n(20994),i=n(599),l=n.n(i),a=n(10716),c=n.n(a),d=n(64122),u=n.n(d),h=n(69229),p=n(63696),m=n(50119),g=n(11735),x=n(59061),w=n(97233),f=n(571),v=n(13906),y=n(94724),j=n(44201),k=n(62540);const b=(0,o.A)(u(),{target:"eyexlqs8"})({name:"10s1w75",styles:"width:1.1rem;height:1.1rem"}),C=(0,o.A)(l(),{target:"eyexlqs7"})({name:"10s1w75",styles:"width:1.1rem;height:1.1rem"}),S=(0,o.A)("div",{target:"eyexlqs6"})("display:flex;align-items:center;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";font-weight:",(e=>{let{isSelected:t}=e;return t?"bold":"normal"}),";cursor:pointer;padding:0 1rem;box-sizing:border-box;&:hover{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";}"),R=(0,o.A)(S,{target:"eyexlqs5"})({name:"1ff36h2",styles:"flex-grow:1"}),A=(0,o.A)(S,{target:"eyexlqs4"})({name:"1qnyavj",styles:"width:12rem"}),T=(0,o.A)(S,{target:"eyexlqs3"})({name:"kf9j8v",styles:"width:4rem"}),E=(0,o.A)("div",{target:"eyexlqs2"})("max-height:20rem;overflow-y:auto;tr:hover td{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";}"),I=e=>{let{sortAscending:t}=e;return t?(0,k.jsx)(C,{}):(0,k.jsx)(b,{})},D=(0,o.A)("div",{target:"eyexlqs1"})(""),M=(0,o.A)("div",{target:"eyexlqs0"})({name:"71ye7u",styles:"display:flex;height:2.5rem"}),O=(0,h.PA)((()=>{const{cloudFileStore:e,rootViewStore:t}=(0,x.g)(),n=(0,m.pC)(),o=(0,g.Hd)(),i=(0,s.dj)(),l=(0,r.u)(),a=(0,w.B2)(),{isLoading:d,dateType:u,files:h,selectedColumn:b,sortAscending:C}=e;if((0,p.useEffect)((()=>{e.load()}),[]),d)return(0,k.jsx)(f.P,{});if(0===h.length)return(0,k.jsx)(w.Oj,{name:"no-files"});const S=(()=>{switch(u){case"created":return a["created-date"];case"updated":return a["modified-date"]}})();return(0,k.jsxs)(D,{children:[(0,k.jsxs)(M,{children:[(0,k.jsxs)(R,{onClick:()=>{"name"===e.selectedColumn?e.sortAscending=!e.sortAscending:e.selectedColumn="name"},isSelected:"name"===b,children:[(0,k.jsx)(w.Oj,{name:"name"}),(0,k.jsx)("div",{style:{width:"0.5rem"}}),"name"===b&&(0,k.jsx)(I,{sortAscending:C})]}),(0,k.jsxs)(A,{onClick:()=>{"date"===e.selectedColumn?e.sortAscending=!e.sortAscending:e.selectedColumn="date"},isSelected:"date"===b,children:[S,(0,k.jsxs)(y.W1,{trigger:(0,k.jsx)(v.K,{style:{marginLeft:"0.2em"},children:(0,k.jsx)(c(),{style:{fill:l.secondaryTextColor}})}),children:[(0,k.jsx)(y.Dr,{onClick:()=>e.dateType="created",children:(0,k.jsx)(w.Oj,{name:"created-date"})}),(0,k.jsx)(y.Dr,{onClick:()=>e.dateType="updated",children:(0,k.jsx)(w.Oj,{name:"modified-date"})})]}),"date"===b&&(0,k.jsx)(I,{sortAscending:C})]}),(0,k.jsx)(T,{})]}),(0,k.jsx)(E,{children:h.map((e=>(0,k.jsx)(j.W,{song:e,dateType:u,onClick:()=>(async e=>{try{const r=await o(e);n(r),t.openCloudFileDialog=!1}catch(e){i.error(e.message)}})(e)},e.id)))})]})}))},44201:(e,t,n)=>{n.d(t,{W:()=>y});var o=n(46287),r=n(83785),s=n(20994),i=n(66760),l=n.n(i),a=n(69229),c=n(59061),d=n(97233),u=n(13906),h=n(94724),p=n(62540);const m=(0,o.A)("div",{target:"evrkgu25"})("display:flex;cursor:pointer;height:2.5rem;overflow:hidden;&:hover{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";}"),g=(0,o.A)("div",{target:"evrkgu24"})({name:"mlkjcc",styles:"display:flex;align-items:center;padding:0 1rem;box-sizing:border-box"}),x=(0,o.A)(g,{target:"evrkgu23"})({name:"1b3zlvp",styles:"overflow:hidden;flex-grow:1"}),w=(0,o.A)(g,{target:"evrkgu22"})({name:"s3dr32",styles:"width:12rem;flex-shrink:0"}),f=(0,o.A)(g,{target:"evrkgu21"})({name:"1l04w2j",styles:"width:4rem;flex-shrink:0"}),v=(0,o.A)("span",{target:"evrkgu20"})({name:"aj4kza",styles:"white-space:nowrap;text-overflow:ellipsis;overflow:hidden"}),y=(0,a.PA)((e=>{let{song:t,onClick:n,dateType:o}=e;const i=(0,r.u)(),a=(0,s.dj)(),g=(0,d.B2)(),{cloudFileStore:y}=(0,c.g)(),j=(()=>{switch(o){case"created":return t.createdAt;case"updated":return t.updatedAt}})(),k=t.name.length>0?t.name:g["untitled-song"],b=j.toLocaleDateString()+" "+j.toLocaleTimeString();return(0,p.jsxs)(m,{onClick:n,children:[(0,p.jsx)(x,{children:(0,p.jsx)(v,{children:k})}),(0,p.jsx)(w,{children:b}),(0,p.jsx)(f,{children:(0,p.jsx)(h.W1,{trigger:(0,p.jsx)(u.K,{style:{marginLeft:"0.2em"},children:(0,p.jsx)(l(),{style:{fill:i.secondaryTextColor}})}),children:(0,p.jsx)(h.Dr,{onClick:async e=>{e.stopPropagation();try{await y.deleteSong(t),a.info(g["song-deleted"])}catch(e){console.error(e),a.error(g["song-delete-failed"])}},children:(0,p.jsx)(d.Oj,{name:"delete"})})})})]})}))},89017:(e,t,n)=>{n.d(t,{s:()=>h});var o=n(46287),r=n(53649),s=n.n(r),i=n(97233),l=n(66459),a=n(5513),c=n(62540);const d=(0,o.A)("div",{target:"e1t7ob9n1"})("background-color:",(e=>{let{color:t}=e;return t}),";height:2rem;&:hover{z-index:2;box-shadow:0 0 0 2px white;}"),u=(0,o.A)("div",{target:"e1t7ob9n0"})("display:grid;padding:2px;grid-template-columns:repeat(",8,", 2rem);"),h=e=>{let{open:t,onSelect:n,onClose:o}=e;const r=e=>{n(e),o()},h=[-5,25,45,155,190,230,260,335],p=[65,55,39],m=s()(0,p.length).flatMap((e=>s()(0,h.length).map((t=>`hsl(\n          ${h[t].toFixed()}deg\n          70%\n          ${p[e].toFixed()}%\n        )`))));return(0,c.jsxs)(l.lG,{open:t,onOpenChange:o,children:[(0,c.jsx)(l.Cf,{children:(0,c.jsx)(u,{children:m.map((e=>(0,c.jsx)(d,{color:e,onClick:()=>r(e)},e)))})}),(0,c.jsxs)(l.ii,{children:[(0,c.jsx)(a.$,{onClick:()=>r(null),children:(0,c.jsx)(i.Oj,{name:"reset"})}),(0,c.jsx)(a.$,{onClick:o,children:(0,c.jsx)(i.Oj,{name:"close"})})]})]})}},5909:(e,t,n)=>{n.d(t,{Z:()=>l,t:()=>u});var o=n(46287),r=n(22538),s=n(63696),i=n(62540);const l=(0,o.A)("div",{target:"erver1d3"})("font-size:0.9em;flex-grow:1;text-align:right;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";margin-left:2em;"),a=(0,o.A)("div",{target:"erver1d2"})({name:"1a1cy4u",styles:"position:fixed;left:0;top:0;right:0;bottom:0"}),c=(0,o.A)("div",{target:"erver1d1"})("position:absolute;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border-radius:0.5rem;box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.popupBorderColor}),";padding:0.5rem 0;"),d=(0,o.A)("ul",{target:"erver1d0"})({name:"v5al3",styles:"list-style:none;padding:0;margin:0"}),u=e=>{let{isOpen:t,handleClose:n,position:o,children:l}=e;if((0,s.useEffect)((()=>{const e=e=>{t&&"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),!t)return(0,i.jsx)(i.Fragment,{});const u=Math.min(o.x,window.innerWidth-200);return(0,i.jsx)(r.b,{children:(0,i.jsx)(a,{onClick:n,children:(0,i.jsx)(c,{style:{left:u,top:o.y},onClick:e=>e.stopPropagation(),children:(0,i.jsx)(d,{children:l})})})})}},56383:(e,t,n)=>{n.d(t,{l:()=>m});var o=n(69229),r=n(38038),s=n(86738),i=n(51930),l=n(59061),a=n(22095),c=n(57749),d=n(92620),u=n(62540);const h=i.n["cg-wheatstone-30"];let p="push";const m=(0,o.PA)((e=>{let{width:t,height:n}=e;const{song:o,pianoRollStore:{selectedTrack:i,transform:m,scrollLeft:g,windowedEvents:x,rulerStore:{beats:w},selectedNoteIds:f,cursorX:v,allNotes:y,notes:j}}=(0,l.g)(),k=o.tracks.flatMap(((e,t)=>e.events.filter(a.Fb).map((n=>({noteEvent:n,track:e,trackIndex:t}))))).map((e=>({rect:m.getRect(e.noteEvent),...e}))).filter((e=>e.rect.x<=v&&v<=e.rect.x+e.rect.width)),b=k.map((e=>r.IN.midiToNoteName(e.noteEvent.noteNumber))),C=b.filter((e=>h.layout.some((t=>(0,s.wi)(t.push,e)||(0,s.wi)(t.pull,e))))),S=C.every((e=>h.layout.some((t=>(0,s.wi)(t.push,e))))),R=C.every((e=>h.layout.some((t=>(0,s.wi)(t.pull,e))))),A=S||R,T=A?S&&R?p:S?"push":"pull":null,E=b.map((e=>h.layout.map(((t,n)=>[(0,s.wi)(t.push,e)?{index:n,action:"push"}:null,(0,s.wi)(t.pull,e)?{index:n,action:"pull"}:null])))).flat(2).filter((e=>null!==e)).filter((e=>e.action===T||!T));C.forEach((e=>{if(!A)return;const t=E.filter((t=>(0,s.wi)(h.layout[t.index][t.action],e)));if(t.length<=1)return;const n=t.map((e=>({button:e,closestButton:(0,s.HN)(h,e.index,E.map((e=>e.index)).filter((e=>!t.map((e=>e.index)).includes(e))))}))).reduce(((e,t)=>e.closestButton.distance>t.closestButton.distance?e:t));t.filter((e=>e.index!==n.button.index)).forEach((e=>{const t=E.findIndex((t=>t.index===e.index));E.splice(t,1)}))})),p=T||"push";const I=o.tracks.findIndex((e=>!1===e.isConductorTrack)),D=k.find((e=>e.trackIndex===I)),M=E.find((e=>D&&(0,s.wi)(h.layout[e.index][e.action],r.IN.midiToNoteName(D.noteEvent.noteNumber)))),O=k.filter((e=>f.includes(e.noteEvent.id))).map((e=>E.find((t=>(0,s.wi)(h.layout[t.index][t.action],r.IN.midiToNoteName(e.noteEvent.noteNumber)))))).filter((e=>void 0!==e));return(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsx)(d.S,{instrument:h,strokes:E,highlightStrokes:O}),(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,u.jsx)(c.d,{mainStroke:M,strokes:E,instrument:h})}),(0,u.jsxs)("div",{children:[b.join(","),(0,u.jsx)("br",{}),!A&&(0,u.jsx)("b",{style:{color:"red"},children:"cant be played"}),(0,u.jsx)("br",{}),S?"can be played with all push":"",(0,u.jsx)("br",{}),R?"can be played with all pull":""]})]})}))},39031:(e,t,n)=>{n.d(t,{b:()=>l});var o=n(9788),r=n.n(o),s=n(63696),i=n(62540);const l=e=>{let{abc:t,params:n}=e;const o=(0,s.useRef)(null);return(0,s.useEffect)((()=>{o?.current&&r().renderAbc(o.current,t,n)}),[t,n,o]),(0,i.jsx)("div",{ref:o})}},57749:(e,t,n)=>{n.d(t,{d:()=>i});var o=n(38038),r=n(39031),s=n(62540);const i=e=>{let{mainStroke:t,strokes:n,instrument:i}=e;const l=t?i.layout[t.index][t.action]:null,a=l?o.Df.scientificToAbcNotation(l):"z",c=n.filter((e=>"left"===i.layout[e.index].cooverNotationId?.hand)).map((e=>i.layout[e.index].cooverNotationId?.id)),d=`X: 1\n  |:"^\\n${n.filter((e=>"right"===i.layout[e.index].cooverNotationId?.hand)).map((e=>i.layout[e.index].cooverNotationId?.id)).join("\\n")}""_${c.join("\\n")}"${a}2\n  `;return(0,s.jsx)(r.b,{abc:d})}},92620:(e,t,n)=>{n.d(t,{S:()=>i});var o=n(63696),r=n(86738),s=n(62540);const i=e=>{let{instrument:t,strokes:n=[],highlightStrokes:i=[]}=e;return(0,s.jsx)("div",{style:{whiteSpace:"nowrap"},children:t.layout.map(((e,a)=>(0,s.jsxs)(o.Fragment,{children:[e.newRow&&(0,s.jsx)("br",{}),(0,s.jsx)(l,{btn:e,action:n.find((e=>e.index===a))?.action,index:a,position:(0,r.UX)(t,a),cooverNotationId:t.layout[a]?.cooverNotationId,highlight:!!i.find((e=>e.index===a))})]},a)))})},l=e=>{let{btn:t,action:n,index:o,position:r,cooverNotationId:i,highlight:l}=e;return(0,s.jsxs)("div",{title:`index: ${o}\ncoover id: ${i?.id}\nposition: ${r.row}, ${r.col}`,style:{display:"inline-block",width:50,height:50,textAlign:"center",marginLeft:t.x,verticalAlign:"bottom",backgroundColor:"#3E3E3E",color:"black",position:"relative",borderRadius:99,overflow:"hidden",fontWeight:"bold",fontSize:15,lineHeight:1.32,border:l?"2px dashed white":"2px solid transparent",boxShadow:"push"===n?"0px 0px 0px 4px #F6295A":"pull"===n?"0px 0px 0px 4px #0059D6":"",zIndex:l||n?1:0},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"flex-end",width:"100%",height:"50%",background:"push"===n?"#fda2b8":"transparent",verticalAlign:"bottom",boxShadow:"inset 0px -2px 0px 0px #292828"},children:[t.push.replace(/[^a-zA-Z#]/g,""),(0,s.jsx)("span",{style:{fontSize:16,fontFamily:"Times, serif",fontWeight:"bold"},children:t.push.replace(/[^0-9]/g,"")})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"flex-start",width:"100%",height:"50%",background:"pull"===n?"#83aae0":"transparent"},children:[t.pull.replace(/[^a-zA-Z#]/g,""),(0,s.jsx)("span",{style:{fontSize:16,fontFamily:"Garamond, serif",fontWeight:"bold"},children:t.pull.replace(/[^0-9]/g,"")})]})]})}},9414:(e,t,n)=>{n.d(t,{N:()=>i});var o=n(10962),r=n(97233),s=n(62540);const i=e=>{let{mode:t}=e;switch(t.type){case"concertina":return"Concertina";case"velocity":return(0,s.jsx)(r.Oj,{name:"velocity"});case"pitchBend":return(0,s.jsx)(r.Oj,{name:"pitch-bend"});case"controller":switch(t.controllerType){case o.M$.MSB_MAIN_VOLUME:return(0,s.jsx)(r.Oj,{name:"volume"});case o.M$.MSB_PAN:return(0,s.jsx)(r.Oj,{name:"panpot"});case o.M$.MSB_EXPRESSION:return(0,s.jsx)(r.Oj,{name:"expression"});case o.M$.SUSTAIN:return(0,s.jsx)(r.Oj,{name:"hold-pedal"});default:return(0,s.jsx)(s.Fragment,{children:"Undefined"===o.ZG[t.controllerType]?`CC${t.controllerType}`:o.ZG[t.controllerType]})}}}},54773:(e,t,n)=>{n.d(t,{A:()=>S});var o=n(46287),r=n(96604),s=n.n(r),i=n(66760),l=n.n(i),a=n(69229),c=n(63696),d=n(92770),u=n(59061),h=n(60790),p=n(56383),m=n(9414),g=n(68306),x=n(58573),w=n(62540);const f=(0,o.A)("div",{target:"e1q3u1dm5"})("background:transparent;-webkit-appearance:none;padding:0.5em 0.8em;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";outline:none;font-size:0.75rem;cursor:default;display:flex;align-items:center;justify-content:center;flex-shrink:0;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),v=(0,o.A)(f,{target:"e1q3u1dm4"})("width:8em;overflow:hidden;border-bottom:1px solid;border-color:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:"transparent"}),";color:",(e=>{let{theme:t,selected:n}=e;return n?t.textColor:t.secondaryTextColor}),";"),y=(0,o.A)("span",{target:"e1q3u1dm3"})({name:"12wal98",styles:"text-overflow:ellipsis;overflow:hidden;white-space:nowrap"}),j=(0,o.A)("div",{target:"e1q3u1dm2"})("box-sizing:border-box;display:flex;margin-left:",d.PE.keyWidth,"px;height:2rem;flex-shrink:0;overflow-x:auto;&::-webkit-scrollbar{display:none;}"),k=c.memo((0,a.PA)((e=>{let{onSelect:t,selectedMode:n}=e;const{controlStore:o,rootViewStore:r}=(0,u.g)(),{controlModes:s}=o;return(0,w.jsxs)(j,{children:[s.map(((e,o)=>(0,w.jsx)(v,{selected:(0,h.Tk)(n,e),onMouseDown:()=>t(e),children:(0,w.jsx)(y,{children:(0,w.jsx)(m.N,{mode:e})})},o))),(0,w.jsx)(f,{onClick:()=>r.openControlSettingDialog=!0,children:(0,w.jsx)(l(),{style:{width:"1rem"}})})]})}))),b=(0,o.A)("div",{target:"e1q3u1dm1"})("width:100%;height:100%;display:flex;flex-direction:column;background:",(e=>{let{theme:t}=e;return t.darkBackgroundColor}),";"),C=(0,o.A)("div",{target:"e1q3u1dm0"})({name:"uqc6kb",styles:"flex-grow:1;position:relative;>canvas,>.LineGraph{position:absolute;top:0;left:0;}"}),S=(0,a.PA)((()=>{const e=(0,c.useRef)(null),t=s()(e),{controlStore:n}=(0,u.g)(),{controlMode:o}=n,r=(0,c.useCallback)((e=>n.controlMode=e),[]),i={width:t.width-d.PE.keyWidth-1,height:t.height-30},l=(()=>{switch(o.type){case"velocity":return(0,w.jsx)(x.A,{...i});case"concertina":return(0,w.jsx)(p.l,{...i});default:return(0,w.jsx)(g.W,{...i,type:o})}})();return(0,w.jsxs)(b,{ref:e,children:[(0,w.jsx)(k,{onSelect:r,selectedMode:o}),(0,w.jsx)(C,{children:l})]})}))},24381:(e,t,n)=>{n.d(t,{u:()=>h});var o=n(69229),r=n(63696),s=n(68278),i=n(59061),l=n(69673),a=n(97233),c=n(5909),d=n(94724),u=n(62540);const h=(0,o.PA)((e=>{const{handleClose:t}=e,{controlStore:n}=(0,i.g)(),o=n.selectedEventIds.length>0,h=(0,s.yw)(),p=(0,s.Ay)(),m=(0,s.AT)(),g=(0,s.mj)(),x=(0,r.useCallback)((()=>{h(),p(),t()}),[h,p]),w=(0,r.useCallback)((()=>{h(),t()}),[h]),f=(0,r.useCallback)((()=>{g(),t()}),[g]),v=(0,r.useCallback)((()=>{m(),t()}),[m]),y=(0,r.useCallback)((()=>{p(),t()}),[p]);return(0,u.jsxs)(c.t,{...e,children:[(0,u.jsxs)(d.Dr,{onClick:x,disabled:!o,children:[(0,u.jsx)(a.Oj,{name:"cut"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+X"]})]}),(0,u.jsxs)(d.Dr,{onClick:w,disabled:!o,children:[(0,u.jsx)(a.Oj,{name:"copy"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+C"]})]}),(0,u.jsxs)(d.Dr,{onClick:f,children:[(0,u.jsx)(a.Oj,{name:"paste"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+V"]})]}),(0,u.jsxs)(d.Dr,{onClick:v,disabled:!o,children:[(0,u.jsx)(a.Oj,{name:"duplicate"}),(0,u.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+D"]})]}),(0,u.jsxs)(d.Dr,{onClick:y,disabled:!o,children:[(0,u.jsx)(a.Oj,{name:"delete"}),(0,u.jsx)(c.Z,{children:"Del"})]})]})}))},44723:(e,t,n)=>{n.d(t,{r:()=>i});var o=n(51382),r=n(54015),s=n(59061);const i=()=>{const{pianoRollStore:e,controlStore:t,controlStore:{quantizer:n},player:i}=(0,s.g)();return{onMouseDown(s,l,a,c){t.selectedEventIds=[];const d=n.round(a.getTick(l.x));e.selection=null,e.selectedNoteIds=[],i.isPlaying||(i.position=d),t.selection={fromTick:d,toTick:d},(0,r.R)(s,{onMouseMove:(e,r)=>{const s=o.b.add(l,r),i=n.round(a.getTick(s.x));t.selection={fromTick:Math.min(d,i),toTick:Math.max(d,i)}},onMouseUp:()=>{const{selection:e}=t;null!==e&&(t.selectedEventIds=c(e),t.selection=null)}})}}}},97637:(e,t,n)=>{n.d(t,{d:()=>s});var o=n(54015),r=n(59061);const s=()=>{const{controlStore:e,controlStore:{selectedTrack:t},pushHistory:n}=(0,r.g)();return{onMouseDown(r,s,i,l){if(void 0===t)return;n(),e.selectedEventIds.includes(s)||(e.selectedEventIds=[s]);const a=t.events.filter((t=>e.selectedEventIds.includes(t.id))).map((e=>({...e}))),c=a.find((e=>e.id===s));if(void 0===c)return;const d=l.getValue(i.y);(0,o.R)(r,{onMouseMove:(n,o)=>{const r=l.getTick(o.x),s=r-(c.tick+r-e.quantizer.round(c.tick+r)),u=l.getValue(i.y+o.y)-d;t.updateEvents(a.map((e=>({id:e.id,tick:Math.max(0,Math.floor(e.tick+s)),value:Math.min(l.maxValue,Math.max(0,Math.floor(e.value+u)))}))))},onMouseUp:()=>{const n=t.events.filter((t=>e.selectedEventIds.includes(t.id)));t.transaction((e=>n.forEach((t=>e.removeRedundantEvents(t)))))}})}}}},49464:(e,t,n)=>{n.d(t,{_:()=>d});var o=n(50119),r=n(72083),s=n(29909),i=n(51382),l=n(12968),a=n(54015),c=n(59061);const d=()=>{const{controlStore:e,pianoRollStore:t}=(0,c.g)(),n=(0,o.W0)(),d=(0,o.$8)(),u=(0,r.kT)();return{onMouseDown(o,r,c,h){u(),e.selectedEventIds=[],e.selection=null,t.selection=null,t.selectedNoteIds=[];const p=(0,l.i)(o),m=c.fromPosition(r),g=s.a.getEventFactory(h)(m.value);n(g,m.tick);let x=m.tick,w=m.value;(0,a.b)({onMouseMove:e=>{const t=(0,l.i)(e),n=i.b.sub(t,p),o=i.b.add(r,n),s=Math.max(0,Math.min(c.maxValue,c.fromPosition(o).value)),a=c.getTick(o.x);d(h)(w,s,x,a),x=a,w=s}})}}}},68306:(e,t,n)=>{n.d(t,{W:()=>c});var o=n(10962),r=n(69229),s=n(63696),i=n(59061),l=n(79625),a=n(62540);const c=s.memo((0,r.PA)((e=>{let{width:t,height:n,type:r}=e;const{controlStore:{controlValueEvents:c}}=(0,i.g)(),d=(0,s.useMemo)((()=>(e=>{switch(e.type){case"controller":return[0,32,64,96,127];case"pitchBend":return[0,4096,8192,12288,16383]}})(r)),[r]),u=(0,s.useMemo)((()=>(e=>{switch(e.type){case"controller":return 127;case"pitchBend":return 16384}})(r)),[r]),h=(0,s.useMemo)((()=>(e=>{switch(e.type){case"controller":return e.controllerType===o.M$.MSB_PAN?e=>(e-64).toString():e=>e.toString();case"pitchBend":return e=>(e-8192).toString();default:return e=>e.toString()}})(r)),[r]);return(0,a.jsx)(l.A,{width:t,height:n,maxValue:u,events:c,axis:d,eventType:r,axisLabelFormatter:h})})))},29980:(e,t,n)=>{n.d(t,{i:()=>d});var o=n(46287),r=n(63696),s=n(92770),i=n(62540);const l=(0,o.A)("div",{target:"eyj16ty2"})("text-align:right;width:",s.PE.keyWidth,"px;padding-right:0.3em;box-sizing:border-box;"),a=(0,o.A)("div",{target:"eyj16ty1"})({name:"m5cun2",styles:"position:relative;height:100%;display:flex;flex-direction:column;justify-content:space-between"}),c=(0,o.A)("div",{target:"eyj16ty0"})("padding:0.3em;font-size:90%;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";cursor:default;}"),d=r.memo((e=>{let{values:t,valueFormatter:n=(e=>e.toString()),onClick:o}=e;return(0,i.jsx)(l,{children:(0,i.jsx)(a,{children:t.slice().reverse().map((e=>(0,i.jsx)(c,{className:"AxisValue",onClick:()=>o(e),children:n(e)},e)))})})}))},79625:(e,t,n)=>{n.d(t,{A:()=>b});var o=n(83785),r=n(69229),s=n(63696),i=n(68278),l=n(29909),a=n(71229),c=n(70480),d=n(67178),u=n(51046),h=n(78439),p=n(59061),m=n(53603),g=n(24381),x=n(44723),w=n(97637),f=n(49464),v=n(29980),y=n(53093),j=n(62540);const k=(0,r.PA)((e=>{let{maxValue:t,events:n,eventType:r,width:k,height:b,lineWidth:C=2,circleRadius:S=4,axis:R,axisLabelFormatter:A=(e=>e.toString())}=e;const{controlStore:{scrollLeft:T,transform:E,cursor:I,mouseMode:D}}=(0,p.g)(),M=(0,o.u)(),O=(0,i.$H)(),P=(0,f._)(),B=(0,w.d)(),N=(0,x.r)(),F=(0,s.useMemo)((()=>new d.d(E,t,b,C)),[E.horizontalId,t,b,C]),z=n.map((e=>({id:e.id,...F.toPosition(e.tick,e.value)}))),L=z.map((e=>({...(0,m.o)(e,S),id:e.id}))),G=(0,s.useCallback)((e=>L.find((t=>c.r.containsPoint(t,e)))?.id),[L]),H=e=>({x:e.offsetX+T,y:e.offsetY}),W=(0,s.useCallback)((e=>{const t=H(e.nativeEvent);P.onMouseDown(e.nativeEvent,t,F,r)}),[T,F,r,P]),_=(0,s.useCallback)((e=>{const t=H(e.nativeEvent),o=G(t);void 0!==o?B.onMouseDown(e.nativeEvent,o,t,F):N.onMouseDown(e.nativeEvent,t,F,(e=>n.filter((0,u.F)(a.Q.create(e.fromTick,e.toTick))).map((e=>e.id))))}),[F,T,n,r,G,B,N]),K="pencil"===D?W:_,X=(0,s.useCallback)((e=>{const t=l.a.getEventFactory(r)(e);O(t)}),[r,O]),{onContextMenu:V,menuProps:Y}=(0,h.E)();return(0,j.jsxs)("div",{style:{display:"flex"},children:[(0,j.jsx)(v.i,{values:R,valueFormatter:A,onClick:X}),(0,j.jsx)(y.z,{style:{cursor:I,backgroundColor:M.editorBackgroundColor},onMouseDown:K,onContextMenu:V,width:k,height:b,maxValue:t,controlPoints:L,items:z}),(0,j.jsx)(g.u,{...Y})]})})),b=s.memo(k)},53093:(e,t,n)=>{n.d(t,{z:()=>m});var o=n(47547),r=n(69229),s=n(63696),i=n(67178),l=n(28632),a=n(59061),c=n(51618),d=n(98423),u=n(31563),h=n(8957),p=n(62540);const m=(0,r.PA)((e=>{let{items:t,width:n,height:r,style:m,maxValue:g,controlPoints:x,onMouseDown:w,onContextMenu:f}=e;const{controlStore:{selection:v,scrollLeft:y,selectedEventIds:j,cursorX:k,transform:b,rulerStore:{beats:C}}}=(0,a.g)(),S=(0,s.useMemo)((()=>new i.d(b,g,r,2)),[b.horizontalId,g,r]),R=null!==v?S.transformSelection(v):null,A=(0,s.useMemo)((()=>(0,l.L)(-Math.floor(y),0)),[y]);return(0,p.jsx)(o.om,{width:n,height:r,onMouseDown:w,onContextMenu:f,style:m,children:(0,p.jsxs)(o.dL,{matrix:A,children:[(0,p.jsx)(c.g,{height:r,beats:C,zIndex:0}),(0,p.jsx)(h.B,{scrollLeft:y,width:n,items:t,selectedEventIds:j,controlPoints:x,lineWidth:2,zIndex:1}),(0,p.jsx)(u.L,{rect:R,zIndex:2}),(0,p.jsx)(d.b,{x:k,height:r,zIndex:3})]})})}))},8957:(e,t,n)=>{n.d(t,{B:()=>u});var o=n(83785),r=n(47547),s=n(44308),i=n.n(s),l=n(17243),a=n(72343),c=n(20604),d=n(62540);const u=e=>{let{width:t,scrollLeft:n,items:s,selectedEventIds:c,controlPoints:u,lineWidth:p,zIndex:m}=e;const g=(0,o.u)(),x=n+t,w=s.map((e=>({...e,id:e.id}))),f=h(w,p,x),[v,y]=(0,l.partition)(u,(e=>c.includes(e.id)));return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.FX,{rects:f,color:(0,a.B)(i()(g.themeColor)),zIndex:m}),(0,d.jsx)(r.rE,{rects:y,zIndex:m+.1,strokeColor:(0,a.B)(i()(g.themeColor)),fillColor:(0,a.B)(i()(g.themeColor))}),(0,d.jsx)(r.rE,{rects:v,zIndex:m+.2,strokeColor:(0,a.B)(i()(g.themeColor)),fillColor:(0,a.B)(i()(g.textColor))})]})},h=(e,t,n)=>{const o=e.map(((o,r)=>{let{x:s,y:i}=o;const l=e[r+1],a=l?l.x:n;return{x:s,y:i-t/2,width:a-s,height:t}}));return(0,c.F9)(o,((e,n)=>{const o=Math.min(e.y,n.y),r=Math.abs(e.y-n.y)+t;return{x:n.x-t/2,y:o,width:t,height:r}}))}},58573:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(46287),r=n(69229),s=n(63696),i=n(29980),l=n(95577),a=n(62540);const c=(0,o.A)("div",{target:"es96sm00"})({name:"exvagw",styles:"display:flex;position:absolute;top:0;left:0"}),d=(0,r.PA)((e=>{let{width:t,height:n}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(i.i,{values:[1,32,64,96,127],onClick:()=>{}}),(0,a.jsx)(l.R,{width:t,height:n})]})}));function u(e,t){return e.width===t.width&&e.height===t.height}const h=s.memo(d,u)},95577:(e,t,n)=>{n.d(t,{R:()=>j});var o=n(83785),r=n(47547),s=n(44308),i=n.n(s),l=n(69229),a=n(63696),c=n(50119),d=n(51382),u=n(70480),h=n(72343),p=n(28632),m=n(54015),g=n(59061),x=n(22095),w=n(51618),f=n(98423),v=n(85562),y=n(62540);const j=(0,l.PA)((e=>{let{width:t,height:n}=e;const{pianoRollStore:{transform:s,scrollLeft:l,windowedEvents:j,rulerStore:{beats:k},selectedNoteIds:b,cursorX:C}}=(0,g.g)(),S=(0,c.cY)(),R=(0,c.Sf)(),A=(0,o.u)(),T=(0,a.useMemo)((()=>j.filter(x.Fb).map((e=>{const{x:t}=s.getRect(e),o=e.velocity/127*n;return{id:e.id,x:t,y:n-o,width:5,height:o,isSelected:b.includes(e.id),hitArea:{x:t,y:0,width:5,height:n}}}))),[j,n,s,b]),E=(0,a.useCallback)((e=>{const t=e.nativeEvent,o={x:t.offsetX+l,y:t.offsetY};let r=(i=o,T.filter((e=>u.r.containsPoint(e.hitArea,i))));var i;b.length>0&&(r=r.filter((e=>e.isSelected)));const a=t.clientY-t.offsetY,c=e=>{const t=e.clientY-a;return Math.max(1,Math.round(127*Math.max(0,Math.min(1,1-t/n))))};0===r.length?function(){let e=s.getTick(o.x),n=c(t);(0,m.R)(t,{onMouseMove:(t,r)=>{const i=d.b.add(o,r),l=s.getTick(i.x),a=c(t);S(e,n,l,a),e=l,n=a}})}():function(){const e=r.map((e=>e.id));R(e,c(t)),(0,m.b)({onMouseMove:t=>R(e,c(t))})}()}),[n,T,b,l,S,R]),I=(0,a.useMemo)((()=>(0,p.L)(-l,0)),[l]),D=i()(A.themeColor),M=(0,h.B)((0,h.N)(D,A.isLightContent,.3)),O=(0,a.useMemo)((()=>(0,h.B)(D)),[A]),P=(0,a.useMemo)((()=>(0,h.B)(D.lighten(.7))),[A]);return(0,y.jsx)(r.om,{width:t,height:n,style:{backgroundColor:A.editorBackgroundColor},onMouseDown:E,children:(0,y.jsxs)(r.dL,{matrix:I,children:[(0,y.jsx)(v.y,{rects:T,strokeColor:M,activeColor:O,selectedColor:P,zIndex:1}),(0,y.jsx)(w.g,{height:n,beats:k,zIndex:2}),(0,y.jsx)(f.b,{x:C,height:n,zIndex:4})]})})}))},85562:(e,t,n)=>{n.d(t,{y:()=>i});var o=n(47547),r=n(20665),s=n(62540);const i=e=>{let{rects:t,strokeColor:n,activeColor:i,selectedColor:l,zIndex:a}=e;const c=(0,o.I1)();return(0,s.jsx)(o.oW,{createShader:r.t,createBuffer:e=>new r.E(e),uniforms:{projectionMatrix:c,strokeColor:n,activeColor:i,selectedColor:l},buffer:t,zIndex:a})}},20665:(e,t,n)=>{n.d(t,{E:()=>r,t:()=>s});var o=n(47547);class r{_instanceCount=0;boundsBuffer=(()=>new Float32Array(0))();stateBuffer=(()=>new Float32Array(0))();constructor(e){this.vertexArray=e,this.vertexArray.updateBuffer("position",new Float32Array((0,o.pl)({x:0,y:0,width:1,height:1})))}update(e){(this.boundsBuffer.length<4*e.length||this.stateBuffer.length<2*e.length)&&(this.boundsBuffer=new Float32Array(4*e.length),this.stateBuffer=new Float32Array(2*e.length));for(let t=0;t<e.length;t++){const n=e[t];this.boundsBuffer[4*t+0]=n.x,this.boundsBuffer[4*t+1]=n.y,this.boundsBuffer[4*t+2]=n.width,this.boundsBuffer[4*t+3]=n.height,this.stateBuffer[2*t+0]=n.isSelected?1:0}this.vertexArray.updateBuffer("bounds",this.boundsBuffer.subarray(0,4*e.length)),this.vertexArray.updateBuffer("state",this.stateBuffer.subarray(0,2*e.length)),this._instanceCount=e.length}get vertexCount(){return 6}get instanceCount(){return this._instanceCount}}const s=e=>new o.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n\n      in vec4 position;\n      in vec4 bounds;  // [x, y, width, height]\n      in vec2 state; // [isSelected, <not used>]\n\n      out vec4 vBounds;\n      out vec2 vPosition;\n      out vec2 vState;\n\n      void main() {\n        vec4 transformedPosition = vec4((position.xy * bounds.zw + bounds.xy), position.zw);\n        gl_Position = projectionMatrix * transformedPosition;\n        vBounds = bounds;\n        vPosition = transformedPosition.xy;\n        vState = state;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 strokeColor;\n      uniform vec4 selectedColor;\n      uniform vec4 activeColor;\n\n      in vec4 vBounds;\n      in vec2 vPosition;\n      in vec2 vState;\n\n      out vec4 outColor;\n\n      void main() {\n        float border = 1.0;\n        float localX = vPosition.x - vBounds.x;\n        float localY = vPosition.y - vBounds.y;\n\n        float outlineTop = step(border, localY);\n        float outlineBottom = step(localY, vBounds.w - border);\n        float outlineLeft = step(border, localX);\n        float outlineRight = step(localX, vBounds.z - border);\n        \n        float isOutline = outlineTop * outlineBottom * outlineLeft * outlineRight;\n    \n        if (isOutline < 1.0) {\n          // draw outline\n          outColor = strokeColor;\n        } else {\n          // if selected, draw selected color\n          outColor = mix(activeColor, selectedColor, vState.x);\n        }\n      }\n    ",{position:{size:2,type:e.FLOAT},bounds:{size:4,type:e.FLOAT,divisor:1},state:{size:2,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,o.z$)(),strokeColor:(0,o.fz)(),activeColor:(0,o.fz)(),selectedColor:(0,o.fz)()})},94025:(e,t,n)=>{n.d(t,{K:()=>R});var o=n(46287),r=n(68775),s=n(17243),i=n(57631),l=n.n(i),a=n(65272),c=n.n(a),d=n(69229),u=n(63696),h=n(59061),p=n(97233),m=n(60790),g=n(9414),x=n(66459),w=n(5513),f=n(71527),v=n(62540);const y=[{type:"velocity"},{type:"pitchBend"}],j=(0,o.A)("div",{target:"eu8b6d34"})("padding:0.5rem 1rem;background:",(e=>{let{theme:t,isSelected:n}=e;return n?t.themeColor:"transparent"}),";white-space:nowrap;"),k=(0,o.A)("div",{target:"eu8b6d33"})({name:"1l29xw",styles:"max-height:30rem;display:flex"}),b=(0,o.A)("div",{target:"eu8b6d32"})("flex-grow:1;flex-basis:0;overflow:auto;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";"),C=(0,o.A)("div",{target:"eu8b6d31"})({name:"h06y6y",styles:"display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1rem"}),S=(0,o.A)(w.$,{target:"eu8b6d30"})("background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";display:flex;align-items:center;margin-bottom:1rem;min-width:7rem;justify-content:center;"),R=(0,d.PA)((()=>{const{rootViewStore:e,controlStore:t}=(0,h.g)(),{openControlSettingDialog:n}=e,[o,i]=(0,u.useState)(null),[a,d]=(0,u.useState)(null),R=t.controlModes,A=y.concat((0,s.range)(0,128).map((e=>({type:"controller",controllerType:e})))).filter((e=>!t.controlModes.some((t=>(0,m.Tk)(t,e))))),T=R.map((e=>({mode:e,isSelected:null!==o&&(0,m.Tk)(e,o)}))),E=A.map((e=>({mode:e,isSelected:null!==a&&(0,m.Tk)(e,a)}))),I=(0,u.useCallback)((()=>e.openControlSettingDialog=!1),[e]);return(0,v.jsxs)(x.lG,{open:n,onOpenChange:I,style:{maxWidth:"40rem"},children:[(0,v.jsx)(x.L3,{children:(0,v.jsx)(p.Oj,{name:"control-settings"})}),(0,v.jsx)(x.Cf,{children:(0,v.jsxs)(k,{children:[(0,v.jsx)(b,{children:(0,v.jsx)(f.q,{items:T,getItemId:e=>(0,m.qw)(e.mode),onItemMoved:(e,n)=>{const o=T.findIndex((t=>(0,m.qw)(t.mode)===e)),s=T.findIndex((e=>(0,m.qw)(e.mode)===n));-1!==o&&-1!==s&&(t.controlModes=(0,r.be)(t.controlModes,o,s))},render:e=>(0,v.jsx)(j,{isSelected:e.isSelected,onClick:()=>{i(e.mode),d(null)},children:(0,v.jsx)(g.N,{mode:e.mode})},(0,m.qw)(e.mode))})}),(0,v.jsxs)(C,{children:[(0,v.jsxs)(S,{onClick:()=>{a&&(t.controlModes.push(a),d(null))},children:[(0,v.jsx)(l(),{style:{width:"1.25rem"}})," Add"]}),(0,v.jsxs)(S,{onClick:()=>{o&&(t.controlModes=t.controlModes.filter((e=>!(0,m.Tk)(e,o))),i(null))},children:["Remove ",(0,v.jsx)(c(),{style:{width:"1.25rem"}})]})]}),(0,v.jsx)(b,{children:E.map((e=>(0,v.jsx)(j,{isSelected:e.isSelected,onClick:()=>{i(null),d(e.mode)},children:(0,v.jsx)(g.N,{mode:e.mode})},(0,m.qw)(e.mode))))})]})}),(0,v.jsxs)(x.ii,{children:[(0,v.jsx)(w.$,{onClick:()=>{t.controlModes=m.jL},children:(0,v.jsx)(p.Oj,{name:"restore-defaults"})}),(0,v.jsx)("div",{style:{flex:1}}),(0,v.jsx)(w.$,{onClick:I,children:(0,v.jsx)(p.Oj,{name:"close"})})]})]})}))},71527:(e,t,n)=>{n.d(t,{q:()=>c});var o=n(93275),r=n(87211),s=n(68775),i=n(39391),l=n(62540);const a=e=>{const{attributes:t,listeners:n,setNodeRef:o,transform:r,transition:a}=(0,s.gl)({id:e.id}),c={transform:i.Ks.Transform.toString(r),transition:a};return(0,l.jsx)("div",{ref:o,style:c,...t,...n,tabIndex:-1,children:e.children})},c=e=>{let{items:t,render:n,getItemId:i,onItemMoved:c}=e;const d=t.map((e=>({id:i(e),item:e}))),u=(0,o.FR)((0,o.MS)(o.AN,{activationConstraint:{distance:5}}),(0,o.MS)(o.uN,{coordinateGetter:s.JR}));return(0,l.jsx)(o.Mp,{sensors:u,collisionDetection:o.fp,onDragEnd:e=>{const{active:t,over:n}=e;null!==n&&t.id!==n.id&&c(t.id,n.id)},modifiers:[r.FN],children:(0,l.jsx)(s.gB,{items:d,strategy:s._G,children:d.map((e=>(0,l.jsx)(a,{id:e.id,children:n(e.item)},e.id)))})})}},87393:(e,t,n)=>{n.d(t,{n:()=>a});var o=n(20994),r=n(63696),s=n(5513),i=n(66459),l=n(62540);const a=e=>{const{setDialog:t}=(0,r.useContext)(o.MV),n=n=>{e.callback(n),t(null)};return(0,l.jsxs)(i.lG,{open:!0,onOpenChange:()=>n(null),style:{minWidth:"20rem"},children:[(0,l.jsx)(i.L3,{children:e.title}),e.message&&(0,l.jsx)(i.Cf,{children:e.message}),(0,l.jsx)(i.ii,{children:e.actions.map((e=>(0,l.jsx)(s.$,{onClick:()=>n(e.key),children:e.title},e.key)))})]})}},66459:(e,t,n)=>{n.d(t,{Cf:()=>p,L3:()=>h,ii:()=>m,lG:()=>u});var o=n(46287),r=n(91785),s=n(13600),i=n(62540);const l=r.i7`
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
`,a=r.i7`
  from {
    opacity: 0;
    transform: translate(-50%, -48%) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
`,c=(0,o.A)(s.hJ,{target:"e1t9d94t4"})("background-color:rgba(0, 0, 0, 0.3);position:fixed;inset:0;animation:",l," 150ms cubic-bezier(0.16, 1, 0.3, 1);"),d=(0,o.A)(s.UC,{target:"e1t9d94t3"})("background-color:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border-radius:0.5rem;box-shadow:0 0.5rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);margin-bottom:1rem;max-width:30rem;max-height:85vh;padding:1rem;animation:",a," 150ms cubic-bezier(0.16, 1, 0.3, 1);display:flex;flex-direction:column;pointer-events:auto;overflow:hidden;&:focus{outline:none;}"),u=e=>{let{children:t,style:n,...o}=e;return(0,i.jsx)(s.bL,{...o,children:(0,i.jsxs)(s.ZL,{children:[(0,i.jsx)(c,{}),(0,i.jsx)(d,{style:n,children:t})]})})},h=(0,o.A)("div",{target:"e1t9d94t2"})("font-size:1.25rem;color:",(e=>{let{theme:t}=e;return t.textColor}),";margin-bottom:1.5rem;"),p=(0,o.A)("div",{target:"e1t9d94t1"})({name:"4v81tc",styles:"overflow-x:hidden;overflow-y:auto;margin-bottom:1rem"}),m=(0,o.A)("div",{target:"e1t9d94t0"})({name:"1mcgwxs",styles:"display:flex;justify-content:flex-end;&>*:not(:last-child){margin-right:1rem;}"})},47759:(e,t,n)=>{n.d(t,{T:()=>a});var o=n(46287),r=n(571),s=n(66459),i=n(62540);const l=(0,o.A)("div",{target:"e1o8lja0"})("color:",(e=>{let{theme:t}=e;return t.textColor}),";margin-left:1rem;display:flex;align-items:center;font-size:0.8rem;"),a=e=>{let{open:t,children:n}=e;return(0,i.jsx)(s.lG,{open:t,style:{minWidth:"20rem"},children:(0,i.jsxs)(s.Cf,{style:{display:"flex",marginBottom:"0"},children:[(0,i.jsx)(r.P,{}),(0,i.jsx)(l,{children:n})]})})}},13546:(e,t,n)=>{n.d(t,{k:()=>s});var o=n(47759),r=n(62540);const s=e=>{let{open:t,message:n}=e;return(0,r.jsx)(o.T,{open:t,children:n})}},73061:(e,t,n)=>{n.d(t,{X:()=>c});var o=n(20994),r=n(63696),s=n(66459),i=n(5513),l=n(4830),a=n(62540);const c=e=>{const[t,n]=(0,r.useState)(e.initialText),{setPrompt:c}=(0,r.useContext)(o.QI),d=()=>{c(null)},u=()=>{e.callback(null),d()},h=()=>{e.callback(t??null),d()};return(0,a.jsxs)(s.lG,{open:!0,onOpenChange:u,style:{width:"20rem"},children:[(0,a.jsx)(s.L3,{children:e.title}),(0,a.jsx)(s.Cf,{children:(0,a.jsx)(l.A,{type:"text",value:t,onChange:e=>n(e.target.value),autoFocus:!0,onKeyPress:e=>{"Enter"===e.key&&h()},style:{width:"100%"}})}),(0,a.jsxs)(s.ii,{children:[(0,a.jsx)(i.$,{onClick:h,children:e.okText??"OK"}),(0,a.jsx)(i.$,{onClick:u,children:e.cancelText??"Cancel"})]})]})}},61508:(e,t,n)=>{n.d(t,{A:()=>i});var o=n(17243),r=n(63696),s=n(62540);class i extends r.Component{canvas;ctx;componentDidMount(){const e=this.canvas?.getContext("2d");if(null===e)throw new Error("failed to getContext 2d");this.ctx=e,this.drawCanvas()}componentDidUpdate(){this.drawCanvas()}drawCanvas(){this.props.draw&&this.ctx&&(this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.props.draw(this.ctx),this.ctx.restore())}render(){const{width:e,height:t,draw:n,style:r,...i}=this.props;return(0,s.jsx)("canvas",{ref:e=>e&&(this.canvas=e),...i,width:(0,o.isNumber)(e)?e*window.devicePixelRatio:void 0,height:(0,o.isNumber)(t)?t*window.devicePixelRatio:void 0,style:{...r,width:e,height:t}})}}},77582:(e,t,n)=>{n.d(t,{T:()=>i});var o=n(17243),r=n(26556),s=n(44569);function i(e){switch(e.type){case"channel":switch(e.subtype){case"controller":return{name:(0,s.mi)(e.controllerType)??`CC${e.controllerType}`,value:{type:"number",value:e.value.toFixed(0),update:d(0,127,(e=>({value:e})))}};case"note":return{name:"Note",value:{type:"number",value:e.velocity.toFixed(0),update:d(1,127,(e=>({velocity:e})))},gate:{type:"number",value:e.duration.toFixed(0),update:d(0,1/0,(e=>({duration:e})))}};case"programChange":return{name:"Program Change",value:{type:"number",value:e.value.toFixed(0),update:d(0,127,(e=>({value:e})))}};case"pitchBend":return{name:"Pitch Bend",value:{type:"number",value:e.value.toFixed(0),update:d(0,16384,(e=>({value:e})))}};default:return{name:e.subtype}}case"meta":switch(e.subtype){case"trackName":return{name:"Track Name",value:{type:"text",value:e.text,update:e=>({text:e})}};case"midiChannelPrefix":return{name:"MIDI Channel Prefix",value:{type:"number",value:e.value.toFixed(0),update:d(0,127,(e=>({channel:e})))}};case"setTempo":return{name:"Tempo",value:{type:"number",value:(0,r.M)(e.microsecondsPerBeat).toFixed(3),update:(0,o.flow)(parseInt,a(1,512),r.w4,Math.floor,l,c((e=>({microsecondsPerBeat:e}))))}};default:return{name:e.subtype}}case"dividedSysEx":case"sysEx":return{name:e.type}}}const l=e=>Number.isNaN(e)?null:e,a=(e,t)=>n=>(0,o.clamp)(n,e,t),c=e=>t=>null===t?null:e(t),d=(e,t,n)=>(0,o.flow)(parseInt,a(e,t),l,c(n))},55782:(e,t,n)=>{n.d(t,{Ay:()=>y,fI:()=>x,fh:()=>w});var o=n(46287),r=n(96604),s=n.n(r),i=n(69229),l=n(63696),a=n(97329),c=n(92770),d=n(59061),u=n(97233),h=n(59255),p=n(62540);const m=(0,o.A)("div",{target:"e12qnnra3"})({name:"w1atjl",styles:"width:100%;height:100%"}),g=(0,o.A)("div",{target:"e12qnnra2"})("height:",c.PE.rulerHeight,";border-bottom:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";padding-right:14px;"),x=(0,o.A)("div",{target:"e12qnnra1"})("display:grid;outline:none;grid-template-columns:5em 1fr 5em 5em;&:focus{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),w=(0,o.A)("div",{target:"e12qnnra0"})("padding:0.5rem;&:focus-within{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),f=(0,i.PA)((()=>{const{pianoRollStore:{selectedTrack:e,selectedNoteIds:t=[]}}=(0,d.g)(),n=(0,l.useMemo)((()=>{const{events:n=[]}=e||{};return t.length>0?n.filter((e=>t.indexOf(e.id)>=0)):n}),[e?.events,t]),o=(0,l.useRef)(null),r=s()(o);return(0,p.jsxs)(m,{ref:o,children:[(0,p.jsx)(g,{children:(0,p.jsxs)(x,{children:[(0,p.jsx)(w,{children:(0,p.jsx)(u.Oj,{name:"tick"})}),(0,p.jsx)(w,{children:(0,p.jsx)(u.Oj,{name:"event"})}),(0,p.jsx)(w,{children:(0,p.jsx)(u.Oj,{name:"duration"})}),(0,p.jsx)(w,{children:(0,p.jsx)(u.Oj,{name:"value"})})]})}),(0,p.jsx)(a.Y1,{height:r.height-c.PE.rulerHeight,itemCount:n.length,itemSize:35,width:r.width,itemData:{events:n},itemKey:e=>n[e].id,children:v})]})})),v=e=>{let{index:t,style:n,data:o}=e;const{events:r,setSelectedEventIds:s}=o,i=r[t],a=(0,l.useCallback)(((e,t)=>{e.ctrlKey||e.metaKey?s?.((e=>[...e,t.id])):s?.([t.id])}),[]);return(0,p.jsx)(h.E,{style:n,item:i,onClick:a},i.id)},y=f},73152:(e,t,n)=>{n.d(t,{R:()=>l});var o=n(46287),r=n(63696),s=n(62540);const i=(0,o.A)("input",{target:"eef2gy00"})("width:100%;display:block;background:transparent;border:none;color:inherit;-webkit-appearance:none;font-size:inherit;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";outline:none;-moz-appearance:textfield;&::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}"),l=e=>{let{value:t,type:n,onChange:o}=e;const[l,a]=(0,r.useState)(!1),[c,d]=(0,r.useState)(""),u=(0,r.useCallback)((()=>{o(c)}),[c]),h=(0,r.useCallback)((e=>{if("Enter"===e.key){const t=Array.from(e.currentTarget?.parentElement?.parentElement?.parentElement?.querySelectorAll("input")??[]).filter((e=>!e.disabled)),n=t.indexOf(e.currentTarget),o=t[n+1];o?.focus(),o?.select(),e.preventDefault()}"Escape"===e.key&&e.currentTarget.blur(),"Enter"!==e.key&&"Tab"!==e.key||u()}),[u,t]);return(0,s.jsx)(i,{type:n,value:l?c:t,onFocus:(0,r.useCallback)((()=>{a(!0),d(t)}),[t]),onBlur:(0,r.useCallback)((()=>{a(!1),u()}),[u]),onChange:(0,r.useCallback)((e=>{l&&d(e.target.value)}),[l]),disabled:null===t,onKeyDown:h})}},59255:(e,t,n)=>{n.d(t,{E:()=>h});var o=n(18264),r=n.n(o),s=n(63696),i=n(59061),l=n(77582),a=n(55782),c=n(73152),d=n(62540);const u=(e,t)=>r()(e.item,t.item)&&r()(e.style,t.style)&&e.onClick===t.onClick,h=s.memo((e=>{let{item:t,style:n,onClick:o}=e;const{pianoRollStore:{selectedTrack:r}}=(0,i.g)(),u=(0,l.T)(t),h=(0,s.useCallback)((e=>{r?.removeEvent(e.id)}),[r]),p=(0,s.useCallback)((e=>{const n=parseInt(e);isNaN(n)||r?.updateEvent(t.id,{tick:Math.max(0,n)})}),[r,t]),m=(0,s.useCallback)((e=>{if(void 0===u.gate)return;const n=u.gate.update(e);null!==n&&r?.updateEvent(t.id,n)}),[u,r,t]),g=(0,s.useCallback)((e=>{if(void 0===u.value)return;const n=u.value.update(e);null!==n&&r?.updateEvent(t.id,n)}),[u,r,t]);return(0,d.jsxs)(a.fI,{style:n,onClick:(0,s.useCallback)((e=>o(e,t)),[t]),onKeyDown:(0,s.useCallback)((e=>{e.target!==e.currentTarget||"Delete"!==e.key&&"Backspace"!==e.key||(h(t),e.stopPropagation())}),[t]),tabIndex:-1,children:[(0,d.jsx)(a.fh,{children:(0,d.jsx)(c.R,{value:t.tick.toFixed(0),type:"number",onChange:p})}),(0,d.jsx)(a.fh,{style:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:u.name}),(0,d.jsx)(a.fh,{children:void 0!==u.gate&&(0,d.jsx)(c.R,{...u.gate,onChange:m})}),(0,d.jsx)(a.fh,{children:void 0!==u.value&&(0,d.jsx)(c.R,{...u.value,onChange:g})})]})}),u)},74390:(e,t,n)=>{n.d(t,{u:()=>h});var o=n(69229),r=n(63696),s=n(50119),i=n(59061),l=n(97233),a=n(66459),c=n(5513),d=n(24343),u=n(62540);const h=(0,o.PA)((()=>{const{exportStore:e}=(0,i.g)(),t=(0,s.Id)(),{openExportProgressDialog:n,progress:o}=e,h=(0,r.useCallback)((()=>{e.openExportProgressDialog=!1,t()}),[e,t]);return(0,u.jsxs)(a.lG,{open:n,style:{minWidth:"20rem"},children:[(0,u.jsx)(a.L3,{children:(0,u.jsx)(l.Oj,{name:"exporting-audio"})}),(0,u.jsx)(a.Cf,{children:(0,u.jsx)(d.h,{value:o,max:1})}),(0,u.jsx)(a.ii,{children:(0,u.jsx)(c.$,{onClick:h,children:(0,u.jsx)(l.Oj,{name:"cancel"})})})]})}))},51618:(e,t,n)=>{n.d(t,{g:()=>u});var o=n(83785),r=n(44308),s=n.n(r),i=n(17243),l=n(63696),a=n(72343),c=n(8178),d=n(62540);const u=e=>{let{height:t,beats:n,zIndex:r}=e;const u=(0,o.u)(),[h,p]=(0,i.partition)(n,(e=>0===e.beat)),m=p.map((e=>e.x)),g=h.map((e=>e.x)),x=(0,l.useMemo)((()=>(0,a.B)(s()(u.editorSecondaryGridColor))),[u]),w=(0,l.useMemo)((()=>(0,a.B)(s()(u.editorGridColor))),[u]);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(c.a,{xArray:m,color:x,height:t,lineWidth:1,zIndex:r}),(0,d.jsx)(c.a,{xArray:g,color:w,height:t,lineWidth:1,zIndex:r+.1})]})}},98423:(e,t,n)=>{n.d(t,{b:()=>i});var o=n(47547),r=n(51080),s=n(62540);const i=e=>{let{x:t,height:n,zIndex:i}=e;const l=r.fA(1,0,0,1);return(0,s.jsx)(o.FX,{rects:[{x:t,y:0,width:1,height:n}],color:l,zIndex:i})}},31563:(e,t,n)=>{n.d(t,{L:()=>d});var o=n(83785),r=n(47547),s=n(44308),i=n.n(s),l=n(51080),a=n(72343),c=n(62540);const d=e=>{let{rect:t,zIndex:n}=e;const s=(0,o.u)();return null===t?(0,c.jsx)(c.Fragment,{}):(0,c.jsx)(r.QB,{rects:[t],fillColor:l.vt(),strokeColor:(0,a.B)(i()(s.themeColor)),zIndex:n})}},8178:(e,t,n)=>{n.d(t,{a:()=>i});var o=n(47547),r=n(68971),s=n(62540);const i=e=>{let{xArray:t,color:n,height:i,lineWidth:l,zIndex:a}=e;const c=(0,o.I1)();return(0,s.jsx)(o.oW,{createShader:r.R,createBuffer:e=>new r.K(e),uniforms:{projectionMatrix:c,color:n,height:i,lineWidth:l},buffer:t,zIndex:a})}},68971:(e,t,n)=>{n.d(t,{K:()=>r,R:()=>s});var o=n(47547);class r{_instanceCount=0;constructor(e){this.vertexArray=e,this.vertexArray.updateBuffer("position",new Float32Array((0,o.pl)({x:0,y:0,width:1,height:1})))}update(e){this.vertexArray.updateBuffer("x",new Float32Array(e)),this._instanceCount=e.length}get vertexCount(){return 6}get instanceCount(){return this._instanceCount}}const s=e=>new o.Mt(e,"#version 300 es\n    precision lowp float;\n    layout (location = 0) in vec4 position;\n    layout (location = 1) in float x;\n    uniform mat4 projectionMatrix;\n    uniform float height;\n    uniform float lineWidth;\n\n    void main() {\n      vec4 screenPosition = vec4(position.xy * vec2(lineWidth, height) + vec2(x, 0.0), position.zw);\n      gl_Position = projectionMatrix * screenPosition;\n    }\n    ","#version 300 es\n    precision lowp float;\n    uniform vec4 color;\n    out vec4 outColor;\n\n    void main() {\n      outColor = color;\n    }\n    ",{position:{size:2,type:e.FLOAT},x:{size:1,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,o.z$)(),color:(0,o.fz)(),height:(0,o.Z7)(),lineWidth:(0,o.Z7)()})},35679:(e,t,n)=>{n.d(t,{p:()=>l});var o=n(69229),r=n(98914),s=n(59061),i=n(62540);const l=(0,o.PA)((()=>{const{song:e}=(0,s.g)();return(0,i.jsx)(r.mg,{children:(0,i.jsxs)("title",{children:[a(e),e.isSaved?"":" *"," - signal"]})})}));function a(e){return e.filepath.length>0?e.filepath:e.name.length>0?e.name:"New song"}},10713:(e,t,n)=>{n.d(t,{Q:()=>g});var o=n(46287),r=n(69229),s=n(59061),i=n(69673),l=n(97233),a=n(66459),c=n(5513),d=n(62540);const u=(0,o.A)("div",{target:"e166zqyl2"})({name:"1ny64b3",styles:"display:flex;align-items:center;margin-bottom:0.5rem;span{margin:0 0.3em;}"}),h=(0,o.A)("div",{target:"e166zqyl1"})("display:inline-block;border:1px solid white;border-radius:4px;padding:0.1em 0.5em 0.2em 0.5em;background:",(e=>{let{theme:t}=e;return t.textColor}),";color:",(e=>{let{theme:t}=e;return t.backgroundColor}),";box-shadow:inset 0 -2px 0 0px #0000006b;"),p=(0,o.A)("div",{target:"e166zqyl0"})({name:"1mwkkc",styles:"margin-left:1em"}),m=e=>{let{hotKeys:t,text:n}=e;return(0,d.jsxs)(u,{children:[t.map(((e,t)=>e.map(((e,n)=>(0,d.jsx)(h,{children:e},1e4*t+n))).reduce(((e,t)=>[e,(0,d.jsx)("span",{children:"+"},"plus"),t])))).reduce(((e,t)=>[e,(0,d.jsx)("span",{children:"/"},"slash"),t])),(0,d.jsx)(p,{children:n})]})},g=(0,r.PA)((()=>{const{rootViewStore:e}=(0,s.g)(),t=e.openHelp,n=()=>e.openHelp=!1;return(0,d.jsxs)(a.lG,{open:t,onOpenChange:n,children:[(0,d.jsx)(a.L3,{children:(0,d.jsx)(l.Oj,{name:"help"})}),(0,d.jsxs)(a.Cf,{children:[(0,d.jsx)("h3",{children:(0,d.jsx)(l.Oj,{name:"keyboard-shortcut"})}),(0,d.jsx)(m,{hotKeys:[[i.t.altOrOption,"N"]],text:(0,d.jsx)(l.Oj,{name:"new-song"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"O"]],text:(0,d.jsx)(l.Oj,{name:"open-song"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"S"]],text:(0,d.jsx)(l.Oj,{name:"save-song"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"Shift","S"]],text:(0,d.jsx)(l.Oj,{name:"save-as"})}),(0,d.jsx)(m,{hotKeys:[["Space"]],text:(0,d.jsx)(l.Oj,{name:"play-pause"})}),(0,d.jsx)(m,{hotKeys:[["Enter"]],text:(0,d.jsx)(l.Oj,{name:"stop"})}),(0,d.jsx)(m,{hotKeys:[["A"],["D"]],text:(0,d.jsx)(l.Oj,{name:"forward-rewind"})}),(0,d.jsx)(m,{hotKeys:[["R"]],text:(0,d.jsx)(l.Oj,{name:"start-stop-recording"})}),(0,d.jsx)(m,{hotKeys:[["S"],["W"]],text:(0,d.jsx)(l.Oj,{name:"next-previous-track"})}),(0,d.jsx)(m,{hotKeys:[["N"],["M"],[","]],text:(0,d.jsx)(l.Oj,{name:"solo-mute-ghost"})}),(0,d.jsx)(m,{hotKeys:[["T"]],text:(0,d.jsx)(l.Oj,{name:"transpose"})}),(0,d.jsx)(m,{hotKeys:[["1"]],text:(0,d.jsx)(l.Oj,{name:"pencil-tool"})}),(0,d.jsx)(m,{hotKeys:[["2"]],text:(0,d.jsx)(l.Oj,{name:"selection-tool"})}),(0,d.jsx)(m,{hotKeys:[[""],[""]],text:(0,d.jsx)(l.Oj,{name:"move-selection"})}),(0,d.jsx)(m,{hotKeys:[[""],[""]],text:(0,d.jsx)(l.Oj,{name:"select-note"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"1"],[i.t.cmdOrCtrl,"2"],[i.t.cmdOrCtrl,"3"]],text:(0,d.jsx)(l.Oj,{name:"switch-tab"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,""],[i.t.cmdOrCtrl,""]],text:(0,d.jsx)(l.Oj,{name:"scroll-vertically"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,""],[i.t.cmdOrCtrl,""]],text:(0,d.jsx)(l.Oj,{name:"scroll-horizontally"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"Z"]],text:(0,d.jsx)(l.Oj,{name:"undo"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"Y"],[i.t.cmdOrCtrl,"Shift","Z"]],text:(0,d.jsx)(l.Oj,{name:"redo"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"C"]],text:(0,d.jsx)(l.Oj,{name:"copy-selection"})}),(0,d.jsx)(m,{hotKeys:[["Delete"],["Backspace"]],text:(0,d.jsx)(l.Oj,{name:"delete-selection"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"X"]],text:(0,d.jsx)(l.Oj,{name:"cut-selection"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"V"]],text:(0,d.jsx)(l.Oj,{name:"paste-selection"})}),(0,d.jsx)(m,{hotKeys:[[i.t.cmdOrCtrl,"A"]],text:(0,d.jsx)(l.Oj,{name:"select-all"})}),(0,d.jsx)(m,{hotKeys:[["?"]],text:(0,d.jsx)(l.Oj,{name:"open-help"})})]}),(0,d.jsx)(a.ii,{children:(0,d.jsx)(c.$,{onClick:n,children:(0,d.jsx)(l.Oj,{name:"close"})})})]})}))},90829:(e,t,n)=>{n.d(t,{A:()=>I});var o=n(46287),r=n(17243),s=n(15841),i=n.n(s),l=n(53649),a=n.n(l),c=n(69229),d=n(63696),u=n(50119),h=n(20604),p=n(59061),m=n(97233),g=n(16053),x=n(6358),w=n(66459),f=n(41479),v=n(6980),y=n(5513),j=n(16066),k=n(15467),b=n(57459),C=n(62540);const S=(0,o.A)("div",{target:"eka714a3"})({name:"lcj4t6",styles:"display:flex;&.disabled{opacity:0.5;pointer-events:none;}"}),R=(0,o.A)("div",{target:"eka714a2"})({name:"jy2zty",styles:"width:15rem;display:flex;flex-direction:column"}),A=(0,o.A)("div",{target:"eka714a1"})({name:"155188o",styles:"width:21rem;display:flex;flex-direction:column;overflow:hidden"}),T=(0,o.A)("div",{target:"eka714a0"})({name:"akdqam",styles:"margin-top:1rem"}),E=e=>{let{onClickCancel:t,onClickOK:n,isOpen:o,presetCategories:r,onChange:s,setting:{programNumber:i,isRhythmTrack:l}}=e;const a=(0,g.h)(i),c=r.length>a?r[a].presets:[],d=r.map(((e,t)=>({value:t,label:(0,C.jsx)(f.F,{programNumber:e.presets[0].programNumber})}))),u=c.map((e=>({value:e.programNumber,label:(0,C.jsx)(v.Z,{programNumber:e.programNumber})})));return(0,C.jsxs)(w.lG,{open:o,onOpenChange:t,children:[(0,C.jsxs)(w.Cf,{className:"InstrumentBrowser",children:[(0,C.jsxs)(S,{className:l?"disabled":"",children:[(0,C.jsxs)(R,{children:[(0,C.jsx)(k.J,{style:{marginBottom:"0.5rem"},children:(0,C.jsx)(m.Oj,{name:"categories"})}),(0,C.jsx)(b.a,{items:d,selectedValue:a,onChange:e=>s({programNumber:8*e,isRhythmTrack:l})})]}),(0,C.jsxs)(A,{children:[(0,C.jsx)(k.J,{style:{marginBottom:"0.5rem"},children:(0,C.jsx)(m.Oj,{name:"instruments"})}),(0,C.jsx)(b.a,{items:u,selectedValue:i,onChange:e=>s({programNumber:e,isRhythmTrack:l})})]})]}),(0,C.jsx)(T,{children:(0,C.jsx)(j.S,{checked:l,onCheckedChange:e=>{s({programNumber:i,isRhythmTrack:!0===e})},label:(0,C.jsx)(m.Oj,{name:"rhythm-track"})})})]}),(0,C.jsxs)(w.ii,{children:[(0,C.jsx)(y.$,{onClick:t,children:(0,C.jsx)(m.Oj,{name:"cancel"})}),(0,C.jsx)(y.j,{onClick:n,children:(0,C.jsx)(m.Oj,{name:"ok"})})]})]})},I=(0,c.PA)((()=>{const{pianoRollStore:{selectedTrack:e,instrumentBrowserSetting:t,openInstrumentBrowser:n},pianoRollStore:o,player:s,song:l}=(0,p.g)(),c=(0,u.mG)(),m=(0,u.Yr)(),w=(0,u.mv)(),[f,y]=(0,d.useState)(null);if(void 0===e)return(0,C.jsx)(C.Fragment,{});const j=()=>o.openInstrumentBrowser=!1,k=t=>w(e.id,t),b=a()(0,128).map((e=>({programNumber:e,name:(0,C.jsx)(v.Z,{programNumber:e})}))),S=(0,r.map)((0,r.groupBy)(b,(e=>(0,g.h)(e.programNumber))),(e=>({presets:e})));return(0,C.jsx)(E,{isOpen:n,setting:t,onChange:t=>{const n=e.channel;if(void 0!==n){if(s.sendEvent((0,x.Ch)(0,n,t.programNumber)),!s.isPlaying){const e=64;null!==f&&(clearTimeout(f),m({noteNumber:e,channel:n})),c({noteNumber:e,velocity:100,channel:n});const t=setTimeout((()=>{m({noteNumber:e,channel:n}),y(null)}),500);y(t)}o.instrumentBrowserSetting=t}},onClickCancel:()=>{j()},onClickOK:()=>{if(t.isRhythmTrack)e.channel=9,k(0);else{if(e.isRhythmTrack){const t=a()(16),n=l.tracks.filter((t=>t!==e)).map((e=>e.channel)),o=Math.min(...i()(t,n).filter(h.EA))||0;e.channel=o}k(t.programNumber)}j()},presetCategories:S})}))},57459:(e,t,n)=>{n.d(t,{a:()=>a});var o=n(46287),r=n(62540);const s=(0,o.A)("div",{target:"e1vpk4yn1"})("overflow:auto;background-color:",(e=>{let{theme:t}=e;return t.darkBackgroundColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";max-height:22rem;flex-grow:1;display:flex;flex-direction:column;&:focus{outline:",(e=>{let{theme:t}=e;return t.themeColor})," 1px solid;}"),i=(0,o.A)("div",{target:"e1vpk4yn0"})("padding:0.5em 1em;flex-shrink:0;font-size:0.9rem;height:2rem;box-sizing:border-box;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;user-select:none;&.checked{background:",(e=>{let{theme:t}=e;return t.themeColor}),";}"),l=e=>{let{checked:t,onClick:n,children:o}=e;return(0,r.jsx)(i,{className:t?"checked":"",onClick:n,children:o})},a=e=>{let{items:t,selectedValue:n,onChange:o}=e;return(0,r.jsx)(s,{onKeyDown:e=>{const r=t.findIndex((e=>e.value===n));switch(e.key){case"ArrowUp":r>0&&o(t[r-1].value),e.preventDefault(),e.stopPropagation();break;case"ArrowDown":r<t.length-1&&o(t[r+1].value),e.preventDefault(),e.stopPropagation()}},tabIndex:0,children:t.map(((e,t)=>(0,r.jsx)(l,{checked:e.value===n,onClick:()=>o(e.value),children:e.label},t)))})}},95229:(e,t,n)=>{n.d(t,{C:()=>w});var o=n(46287),r=n(69229),s=n(54164),i=n(59061),l=n(97233),a=n(66459),c=n(5513),d=n(15467),u=n(95881),h=n(5723),p=n(62540);const m=Array.from({length:12},((e,t)=>["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t])),g=(0,o.A)("div",{target:"e4i23ze1"})({name:"ho1qnd",styles:"display:flex;flex-direction:row"}),x=(0,o.A)("div",{target:"e4i23ze0"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),w=(0,r.PA)((e=>{let{open:t,onOpenChange:n}=e;const{pianoRollStore:o}=(0,i.g)(),r=()=>n(!1);return(0,p.jsxs)(a.lG,{open:t,onOpenChange:r,style:{minWidth:"20rem"},children:[(0,p.jsx)(a.L3,{children:(0,p.jsx)(l.Oj,{name:"scale"})}),(0,p.jsx)(a.Cf,{children:(0,p.jsxs)(g,{style:{gap:"1rem"},children:[(0,p.jsxs)(x,{style:{gap:"0.5rem",minWidth:"5rem"},children:[(0,p.jsx)(d.J,{children:(0,p.jsx)(l.Oj,{name:"key"})}),(0,p.jsx)(u.l,{value:o.keySignature?.key,onChange:e=>{const t=parseInt(e.target.value);o.keySignature={scale:o.keySignature?.scale??"major",key:t}},children:m.map(((e,t)=>(0,p.jsx)("option",{value:t,children:e},t)))})]}),(0,p.jsxs)(x,{style:{gap:"0.5rem",minWidth:"5rem"},children:[(0,p.jsx)(d.J,{children:(0,p.jsx)(l.Oj,{name:"scale"})}),(0,p.jsx)(u.l,{value:o.keySignature?.scale,onChange:e=>{const t=e.target.value;o.keySignature={key:o.keySignature?.key??0,scale:t}},children:s.F.values.map(((e,t)=>(0,p.jsx)("option",{value:e,children:(0,p.jsx)(h.g,{scale:e})},t)))})]})]})}),(0,p.jsx)(a.ii,{children:(0,p.jsx)(c.$,{onClick:r,children:(0,p.jsx)(l.Oj,{name:"close"})})})]})}))},5723:(e,t,n)=>{n.d(t,{g:()=>r});var o=n(97233);const r=e=>{let{scale:t}=e;const n=(0,o.B2)();switch(t){case"major":return n["scale-major"];case"minor":return n["scale-minor"];case"harmonicMinor":return n["scale-harmonic-minor"];case"harmonicMajor":return n["scale-harmonic-major"];case"melodicMinor":return n["scale-melodic-minor"];case"ionian":return n["scale-ionian"];case"dorian":return n["scale-dorian"];case"phrygian":return n["scale-phrygian"];case"lydian":return n["scale-lydian"];case"mixolydian":return n["scale-mixolydian"];case"aeolian":return n["scale-aeolian"];case"locrian":return n["scale-locrian"];case"majorPentatonic":return n["scale-major-pentatonic"];case"minorPentatonic":return n["scale-minor-pentatonic"];case"majorBlues":return n["scale-major-blues"];case"minorBlues":return n["scale-minor-blues"];case"halfWholeDiminished":return n["scale-half-whole-diminished"];case"wholeHalfDiminished":return n["scale-whole-half-diminished"];case"wholeTone":return n["scale-whole-tone"]}}},69552:(e,t,n)=>{n.d(t,{X:()=>a});var o=n(69229),r=n(50119),s=n(59061),i=n(95089),l=n(62540);const a=(0,o.PA)((()=>{const{arrangeViewStore:e}=(0,s.g)(),t=(0,r.DA)(),n=(0,r.hM)(),o=(0,r.Fl)(),a=(0,r.PT)();return(0,l.jsx)(i.S,{actions:[{code:"Escape",run:()=>e.resetSelection()},{code:"Delete",run:()=>t()},{code:"Backspace",run:()=>t()},{code:"ArrowUp",metaKey:!0,run:()=>e.scrollBy(0,24)},{code:"ArrowDown",metaKey:!0,run:()=>e.scrollBy(0,-24)},{code:"KeyT",run:()=>e.openTransposeDialog=!0},{code:"KeyD",metaKey:!0,run:()=>a()}],onCut:()=>{n(),t()},onCopy:()=>n(),onPaste:()=>o()})}))},36020:(e,t,n)=>{n.d(t,{n:()=>g});var o=n(20994),r=n(69229),s=n(63696),i=n(50119),l=n(13917),a=n(72083),c=n(53416),d=n(59061),u=n(97233),h=n(29279),p=n(95089),m=n(62540);const g=(0,r.PA)((()=>{const{rootViewStore:e,router:t,player:n,song:r}=(0,d.g)(),g=(0,i.sQ)(),x=(0,i.m$)(),w=(0,i.qo)(),f=(0,i.Yp)(),v=(0,i.Ut)(),y=(0,i.t3)(),j=(0,i.d0)(),k=(0,i.Fv)(),b=(0,i.bO)(),C=(0,a.Yw)(),S=(0,a.cN)(),R=(0,i.jX)(),{createNewSong:A,openSong:T,saveSong:E,saveAsSong:I,downloadSong:D}=(0,c.P)(),M="LegacyOpenButtonInputFile",O=(0,u.B2)(),P=(0,o.dj)(),B=async()=>{(r.isSaved||confirm(O["confirm-open"]))&&document.getElementById(M)?.click()};return(0,s.useEffect)((()=>{const e=e=>{e.ctrlKey&&e.preventDefault()};document.addEventListener("wheel",e,{passive:!1});const t=e=>{e.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),document.oncontextmenu=e=>e.preventDefault(),()=>{document.removeEventListener("wheel",e),document.removeEventListener("touchmove",t),document.oncontextmenu=null}}),[]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(h.z,{id:M,onChange:async e=>{try{await R(e.currentTarget)}catch(e){P.error(e.message)}},accept:"audio/midi"}),(0,m.jsx)(p.S,{actions:[{code:"Space",run:()=>n.playOrPause()},{code:"KeyZ",metaKey:!0,run:C},{code:"KeyZ",metaKey:!0,shiftKey:!0,run:S},{code:"KeyY",metaKey:!0,run:S},{code:"Slash",shiftKey:!0,run:()=>e.openHelp=!0},{code:"Enter",run:w},{code:"KeyA",run:g},{code:"KeyD",run:x},{code:"KeyS",run:f},{code:"KeyW",run:v},{code:"KeyN",run:y},{code:"KeyM",run:j},{code:"KeyR",run:b},{code:"Comma",run:k},{code:"Digit1",metaKey:!0,run:()=>t.path="/track"},{code:"Digit2",metaKey:!0,run:()=>t.path="/arrange"},{code:"Digit3",metaKey:!0,run:()=>t.path="/tempo"},{code:"KeyS",metaKey:!0,run:l.Ye?E:D},{code:"KeyS",altKey:!0,run:l.Ye?E:D},{code:"KeyS",shiftKey:!0,metaKey:!0,run:l.Ye?I:D},{code:"KeyS",shiftKey:!0,altKey:!0,run:l.Ye?I:D},{code:"KeyO",metaKey:!0,run:l.Ye?T:B},{code:"KeyO",altKey:!0,run:l.Ye?T:B},{code:"KeyN",metaKey:!0,run:A},{code:"KeyN",altKey:!0,run:A}]})]})}))},95089:(e,t,n)=>{n.d(t,{S:()=>i});var o=n(63696),r=n(10322),s=n(62540);const i=e=>{let{actions:t,onCut:n,onCopy:i,onPaste:l}=e;return(0,o.useEffect)((()=>{const e=e=>{if(null!==e.target&&(0,r.t)(e.target))return;const n=t.find((t=>(t.enabled?.()??!0)&&e.code===t.code&&e.altKey===(t.altKey??!1)&&e.shiftKey===(t.shiftKey??!1)&&(e.ctrlKey||e.metaKey)===(t.metaKey??!1)));void 0!==n&&(n.run(e),e.preventDefault(),e.stopPropagation())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[t]),(0,o.useEffect)((()=>(document.oncut=n??null,()=>{document.oncut=null})),[n]),(0,o.useEffect)((()=>(document.oncopy=i??null,()=>{document.oncopy=null})),[i]),(0,o.useEffect)((()=>(document.onpaste=l??null,()=>{document.onpaste=null})),[l]),(0,s.jsx)(s.Fragment,{})}},73853:(e,t,n)=>{n.d(t,{y:()=>m});var o=n(69229),r=n(50119),s=n(68278),i=n(15883),l=n(59061),a=n(15738),c=n(95089),d=n(31937),u=n(10322),h=n(64142),p=n(62540);const m=(0,o.PA)((()=>{const{pianoRollStore:e,controlStore:t}=(0,l.g)(),n=(0,h._)(),o=(0,d.T)(),m=(0,r.Nl)(),g=(0,s.mj)(),x=(0,r.AF)();return(0,p.jsx)(c.S,{actions:[...e.selectedNoteIds.length>0?n():[],...t.selectedEventIds.length>0?o():[],{code:"ArrowUp",metaKey:!0,run:()=>e.scrollBy(0,24)},{code:"ArrowDown",metaKey:!0,run:()=>e.scrollBy(0,-24)},{code:"ArrowRight",metaKey:!0,run:()=>e.scrollBy(-24,0)},{code:"ArrowLeft",metaKey:!0,run:()=>e.scrollBy(24,0)},{code:"Digit1",run:()=>e.mouseMode="pencil"},{code:"Digit2",run:()=>e.mouseMode="selection"},{code:"KeyA",metaKey:!0,run:x}],onPaste:e=>{if(null!==e.target&&(0,u.t)(e.target))return;const t=a.A.readText();if(!t||0===t.length)return;const n=JSON.parse(t);(0,i.dn)(n)?m():(0,i.Np)(n)&&g()}})}))},64741:(e,t,n)=>{n.d(t,{g:()=>u});var o=n(69229),r=n(87188),s=n(15883),i=n(59061),l=n(15738),a=n(95089),c=n(10322),d=n(62540);const u=(0,o.PA)((()=>{const{tempoEditorStore:e}=(0,i.g)(),t=(0,r.Gm)(),n=(0,r._C)(),o=(0,r.av)(),u=(0,r.GZ)(),h=(0,r.e)();return(0,d.jsx)(a.S,{actions:[{code:"Digit1",run:()=>e.mouseMode="pencil"},{code:"Digit2",run:()=>e.mouseMode="selection"},{code:"Escape",run:t},{code:"Backspace",run:n},{code:"Delete",run:n},{code:"KeyC",metaKey:!0,run:()=>o()},{code:"KeyX",metaKey:!0,run:()=>{o(),n()}},{code:"KeyD",metaKey:!0,run:u}],onPaste:e=>{if(null!==e.target&&(0,c.t)(e.target))return;const t=l.A.readText();if(!t||0===t.length)return;const n=JSON.parse(t);(0,s.dQ)(n)&&h()}})}))},31937:(e,t,n)=>{n.d(t,{T:()=>r});var o=n(68278);const r=()=>{const e=(0,o.SR)(),t=(0,o.Ay)(),n=(0,o.yw)(),r=(0,o.AT)();return()=>[{code:"Escape",run:()=>e()},{code:"Backspace",run:()=>t()},{code:"Delete",run:()=>t()},{code:"KeyC",metaKey:!0,run:()=>n()},{code:"KeyX",metaKey:!0,run:()=>{n(),t()}},{code:"KeyD",metaKey:!0,run:()=>r()}]}},10322:(e,t,n)=>{n.d(t,{t:()=>o});const o=e=>e instanceof HTMLAnchorElement||e instanceof HTMLAreaElement||e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement||e instanceof HTMLButtonElement||e instanceof HTMLIFrameElement},64142:(e,t,n)=>{n.d(t,{_:()=>s});var o=n(50119),r=n(59061);const s=()=>{const e=(0,o.LR)(),t=(0,o.z7)(),n=(0,o.ti)(),s=(0,o.Rb)(),i=(0,o.Nl)(),l=(0,o.L$)(),a=(0,o.J1)(),c=(0,o.fm)(),{pianoRollStore:d}=(0,r.g)();return()=>[{code:"KeyC",metaKey:!0,run:n},{code:"KeyX",metaKey:!0,run:()=>{n(),s()}},{code:"KeyV",metaKey:!0,run:i},{code:"KeyD",metaKey:!0,run:l},{code:"KeyQ",run:a},{code:"KeyT",run:()=>d.openTransposeDialog=!0},{code:"Delete",run:s},{code:"Backspace",run:s},{code:"ArrowUp",shiftKey:!0,run:()=>c(12)},{code:"ArrowUp",run:()=>c(1)},{code:"ArrowDown",shiftKey:!0,run:()=>c(-12)},{code:"ArrowDown",run:()=>c(-1)},{code:"ArrowRight",run:e,enabled:()=>"pencil"==d.mouseMode},{code:"ArrowLeft",run:t,enabled:()=>"pencil"==d.mouseMode},{code:"Escape",run:()=>d.resetSelection()}]}},161:(e,t,n)=>{n.d(t,{r:()=>u});var o=n(69229),r=n(13917),s=n(2316),i=n(59061),l=n(97233),a=n(94724),c=n(29279),d=n(62540);const u=(0,o.PA)((e=>{let{close:t}=e;const{song:n}=(0,i.g)(),o=null!==n.cloudSongId,{createNewSong:u,openSong:h,saveSong:p,saveAsSong:m,renameSong:g,importSong:x,importSongLegacy:w,exportSong:f,publishSong:v}=(0,s.R)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await u()},children:(0,d.jsx)(l.Oj,{name:"new-song"})}),(0,d.jsx)(a.Nj,{}),(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await h()},children:(0,d.jsx)(l.Oj,{name:"open-song"})}),(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await p()},disabled:n.isSaved,children:(0,d.jsx)(l.Oj,{name:"save-song"})}),(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await m()},disabled:!o,children:(0,d.jsx)(l.Oj,{name:"save-as"})}),(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await g()},disabled:!o,children:(0,d.jsx)(l.Oj,{name:"rename"})}),(0,d.jsx)(a.Nj,{}),!r.Ye&&(0,d.jsx)(c.z,{onChange:async e=>{t(),await w(e)},children:(0,d.jsx)(a.Dr,{children:(0,d.jsx)(l.Oj,{name:"import-midi"})})}),r.Ye&&(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await x()},children:(0,d.jsx)(l.Oj,{name:"import-midi"})}),(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await f()},children:(0,d.jsx)(l.Oj,{name:"export-midi"})}),(0,d.jsx)(a.Nj,{}),(0,d.jsx)(a.Dr,{onClick:async()=>{t(),await v()},disabled:!o,children:(0,d.jsx)(l.Oj,{name:"publish"})})]})}))},79772:(e,t,n)=>{n.d(t,{i:()=>u});var o=n(69229),r=n(50119),s=n(72083),i=n(59061),l=n(69673),a=n(97233),c=n(94724),d=n(62540);const u=(0,o.PA)((e=>{let{close:t}=e;const{historyStore:n,pianoRollStore:o}=(0,i.g)(),u=(0,s.Yw)(),h=(0,s.cN)(),p=(0,r.ti)(),m=(0,r.Nl)(),g=(0,r.Rb)(),x=(0,r.L$)(),w=(0,r.AF)(),f=(0,r.LR)(),v=(0,r.z7)(),y=(0,r.J1)(),j=(0,r.fm)(),k=o.selectedNoteIds.length>0;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await u()},disabled:!n.hasUndo,children:[(0,d.jsx)(a.Oj,{name:"undo"}),(0,d.jsxs)(c._e,{children:[l.t.cmdOrCtrl,"+Z"]})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await h()},disabled:!n.hasRedo,children:[(0,d.jsx)(a.Oj,{name:"redo"}),(0,d.jsxs)(c._e,{children:[l.t.cmdOrCtrl,"+Shift+Z"]})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await p(),await g()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"cut"}),(0,d.jsxs)(c._e,{children:[l.t.cmdOrCtrl,"+X"]})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await p()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"copy"}),(0,d.jsxs)(c._e,{children:[l.t.cmdOrCtrl,"+C"]})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await m()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"paste"}),(0,d.jsxs)(c._e,{children:[l.t.cmdOrCtrl,"+V"]})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await g()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"delete"}),(0,d.jsx)(c._e,{children:"Delete"})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await x()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"duplicate"}),(0,d.jsxs)(c._e,{children:[l.t.cmdOrCtrl,"+D"]})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await w()},children:[(0,d.jsx)(a.Oj,{name:"select-all"}),(0,d.jsxs)(c._e,{children:[l.t.cmdOrCtrl,"+A"]})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await f()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"select-next"}),(0,d.jsx)(c._e,{children:""})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await v()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"select-previous"}),(0,d.jsx)(c._e,{children:""})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await j(12)},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"one-octave-up"}),(0,d.jsx)(c._e,{children:"Shift+"})]}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await j(-12)},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"one-octave-down"}),(0,d.jsx)(c._e,{children:"Shift+"})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{t(),o.openTransposeDialog=!0},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"transpose"}),(0,d.jsx)(c._e,{children:"T"})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:async()=>{t(),await y()},disabled:!k,children:[(0,d.jsx)(a.Oj,{name:"quantize"}),(0,d.jsx)(c._e,{children:"Q"})]}),(0,d.jsx)(c.Dr,{onClick:()=>{t(),o.openVelocityDialog=!0},disabled:!k,children:(0,d.jsx)(a.Oj,{name:"velocity"})})]})}))},57984:(e,t,n)=>{n.d(t,{a:()=>p});var o=n(48390),r=n.n(o),s=n(69229),i=n(63696),l=n(59061),a=n(97233),c=n(94724),d=n(79772),u=n(77303),h=n(62540);const p=(0,s.PA)((()=>{const{rootViewStore:e}=(0,l.g)(),t=e.openEditDrawer,n=(0,i.useRef)(null);return(0,h.jsx)(c.W1,{open:t,onOpenChange:t=>e.openEditDrawer=t,trigger:(0,h.jsxs)(u.oz,{ref:n,onClick:(0,i.useCallback)((()=>e.openEditDrawer=!0),[]),id:"tab-edit",children:[(0,h.jsx)("span",{style:{marginLeft:"0.25rem"},children:(0,h.jsx)(a.Oj,{name:"edit"})}),(0,h.jsx)(r(),{style:{width:"1rem",marginLeft:"0.25rem"}})]}),children:(0,h.jsx)(d.i,{close:()=>e.openEditDrawer=!1})})}))},52506:(e,t,n)=>{n.d(t,{m:()=>d});var o=n(69229),r=n(53416),s=n(59061),i=n(69673),l=n(97233),a=n(94724),c=n(62540);const d=(0,o.PA)((e=>{let{close:t}=e;const{song:n}=(0,s.g)(),{createNewSong:o,openSong:d,saveSong:u,saveAsSong:h,downloadSong:p}=(0,r.P)();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.Dr,{onClick:async()=>{t(),await o()},children:[(0,c.jsx)(l.Oj,{name:"new-song"}),(0,c.jsxs)(a._e,{children:[i.t.altOrOption,"+N"]})]}),(0,c.jsx)(a.Nj,{}),(0,c.jsxs)(a.Dr,{onClick:async()=>{t(),await d()},children:[(0,c.jsx)(l.Oj,{name:"open-song"}),(0,c.jsxs)(a._e,{children:[i.t.cmdOrCtrl,"+O"]})]}),(0,c.jsxs)(a.Dr,{onClick:async()=>{t(),await u()},disabled:null===n.fileHandle,children:[(0,c.jsx)(l.Oj,{name:"save-song"}),(0,c.jsxs)(a._e,{children:[i.t.cmdOrCtrl,"+S"]})]}),(0,c.jsxs)(a.Dr,{onClick:async()=>{t(),await h()},children:[(0,c.jsx)(l.Oj,{name:"save-as"}),(0,c.jsxs)(a._e,{children:[i.t.cmdOrCtrl,"+Shift+S"]})]}),(0,c.jsx)(a.Dr,{onClick:async()=>{t(),await p()},children:(0,c.jsx)(l.Oj,{name:"download-midi"})})]})}))},15818:(e,t,n)=>{n.d(t,{Q:()=>y});var o=n(83785),r=n(97891),s=n.n(r),i=n(48390),l=n.n(i),a=n(69229),c=n(63696),d=n(50119),u=n(13917),h=n(59061),p=n(97233),m=n(94724),g=n(161),x=n(52506),w=n(29279),f=n(77303),v=n(62540);const y=(0,a.PA)((()=>{const{rootViewStore:e,authStore:{authUser:t}}=(0,h.g)(),n=e.openFileDrawer,r=()=>e.openFileDrawer=!1,i=(0,d.j8)(),a=(0,o.u)(),y=(0,c.useRef)(null);return(0,v.jsxs)(m.W1,{open:n,onOpenChange:t=>e.openFileDrawer=t,trigger:(0,v.jsxs)(f.oz,{ref:y,onClick:(0,c.useCallback)((()=>e.openFileDrawer=!0),[]),id:"tab-file",children:[(0,v.jsx)("span",{style:{marginLeft:"0.25rem"},children:(0,v.jsx)(p.Oj,{name:"file"})}),(0,v.jsx)(l(),{style:{width:"1rem",marginLeft:"0.25rem"}})]}),children:[null===t&&u.Ye&&(0,v.jsx)(x.m,{close:r}),null===t&&!u.Ye&&(0,v.jsx)(w.h,{close:r}),t&&(0,v.jsx)(g.r,{close:r}),(0,v.jsx)(m.Nj,{}),(0,v.jsxs)(m.g8,{trigger:(0,v.jsxs)(m.Dr,{children:[(0,v.jsx)(p.Oj,{name:"export"}),(0,v.jsx)(s(),{style:{marginLeft:"auto",fill:a.tertiaryTextColor}})]}),children:[(0,v.jsx)(m.Dr,{onClick:()=>{r(),i("WAV")},children:"WAV"}),(0,v.jsx)(m.Dr,{onClick:()=>{r(),i("MP3")},children:"MP3"})]})]})}))},29279:(e,t,n)=>{n.d(t,{h:()=>d,z:()=>c});var o=n(69229),r=n(53416),s=n(97233),i=n(94724),l=n(62540);const a="OpenButtonInputFile",c=e=>{let{onChange:t,children:n,accept:o,id:r}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{accept:o,style:{display:"none"},id:r??a,type:"file",onChange:t}),(0,l.jsx)("label",{htmlFor:r??a,children:n})]})},d=(0,o.PA)((e=>{let{close:t}=e;const{createNewSong:n,openSongLegacy:o,downloadSong:a}=(0,r.P)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.Dr,{onClick:async()=>{t(),await n()},children:(0,l.jsx)(s.Oj,{name:"new-song"})}),(0,l.jsx)(i.Nj,{}),(0,l.jsx)(c,{onChange:async e=>{t(),await o(e)},accept:"audio/midi",children:(0,l.jsx)(i.Dr,{children:(0,l.jsx)(s.Oj,{name:"open-song"})})}),(0,l.jsx)(i.Dr,{onClick:async()=>{t(),await a()},children:(0,l.jsx)(s.Oj,{name:"save-song"})})]})}))},77303:(e,t,n)=>{n.d(t,{Vx:()=>R,oz:()=>k});var o=n(46287),r=n(63696),s=n(73303),i=n.n(s),l=n(50813),a=n.n(l),c=n(69229),d=n(92234),u=n(59061),h=n(69673),p=n(97233),m=n(96016),g=n(57984),x=n(15818),w=n(62540),f=function(e){return(0,w.jsx)("svg",{...e,children:(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M32 22.5h64c5.523 0 10 4.477 10 10v64c0 5.523-4.477 10-10 10H32c-5.523 0-10-4.477-10-10v-64c0-5.523 4.477-10 10-10Zm-16 10c0-8.837 7.163-16 16-16h64c8.837 0 16 7.163 16 16v64c0 8.837-7.163 16-16 16H32c-8.837 0-16-7.163-16-16v-64Zm57.694 28H54.306v8h19.388v-8ZM64 40.5h32v8H64v-8Zm0 40H32v8h32v-8Z"})})};f.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};var v=function(e){return(0,w.jsx)("svg",{...e,children:(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M72 22H56v50h-4v34h26V72h-6V22Zm12 50v34h12c5.523 0 10-4.477 10-10V32c0-5.523-4.477-10-10-10h-8v50h-4Zm0 40H32c-8.837 0-16-7.163-16-16V32c0-8.837 7.163-16 16-16h64c8.837 0 16 7.163 16 16v64c0 8.837-7.163 16-16 16H84ZM40 72h6v34H32c-5.523 0-10-4.477-10-10V32c0-5.523 4.477-10 10-10h8v50Z"})})};v.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};var y=function(e){return(0,w.jsx)("svg",{...e,children:(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M106 64c0 23.196-18.804 42-42 42S22 87.196 22 64s18.804-42 42-42 42 18.804 42 42Zm6 0c0 26.51-21.49 48-48 48S16 90.51 16 64s21.49-48 48-48 48 21.49 48 48ZM67 40a3 3 0 1 0-6 0v25.243L77.879 82.12a3 3 0 1 0 4.242-4.242L67 62.757V40Z"})})};y.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};const j=(0,o.A)("div",{target:"e1bvc78p3"})("display:flex;flex-direction:row;background:",(e=>{let{theme:t}=e;return t.darkBackgroundColor}),";height:3rem;flex-shrink:0;-webkit-app-region:drag;padding:",(()=>{if((0,d.r)())switch((0,d.u)()){case"Windows":return"0 0 0 0";case"macOS":return"0 0 0 76px"}}),";"),k=(0,o.A)("div",{target:"e1bvc78p2"})("display:flex;flex-direction:row;align-items:center;padding:0.5rem 1rem;font-size:0.75rem;border-top:solid 0.1rem transparent;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";cursor:pointer;-webkit-app-region:none;&.active{color:",(e=>{let{theme:t}=e;return t.textColor}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border-top-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}a{color:inherit;text-decoration:none;}"),b=(0,o.A)("span",{target:"e1bvc78p1"})({name:"11304en",styles:"margin-left:0.5rem;@media (max-width: 850px){display:none;}"}),C=(0,o.A)("div",{target:"e1bvc78p0"})({name:"1ff36h2",styles:"flex-grow:1"}),S={width:"1.3rem",height:"1.3rem",fill:"currentColor"},R=(0,c.PA)((()=>{const{rootViewStore:e,router:t}=(0,u.g)(),n=(0,r.useCallback)((()=>{t.path="/track"}),[t]),o=(0,r.useCallback)((()=>{t.path="/arrange"}),[t]),s=(0,r.useCallback)((()=>{t.path="/tempo"}),[t]),l=(0,r.useCallback)((()=>{e.openSettingDialog=!0}),[e]),c=(0,r.useCallback)((()=>{e.openHelp=!0}),[e]);return(0,w.jsxs)(j,{children:[!(0,d.r)()&&(0,w.jsx)(x.Q,{}),!(0,d.r)()&&(0,w.jsx)(g.a,{}),(0,w.jsx)(m.m,{title:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Oj,{name:"switch-tab"})," [",h.t.cmdOrCtrl,"+1]"]}),delayDuration:500,children:(0,w.jsxs)(k,{className:"/track"===t.path?"active":void 0,onMouseDown:n,children:[(0,w.jsx)(v,{style:S,viewBox:"0 0 128 128"}),(0,w.jsx)(b,{children:(0,w.jsx)(p.Oj,{name:"piano-roll"})})]})}),(0,w.jsx)(m.m,{title:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Oj,{name:"switch-tab"})," [",h.t.cmdOrCtrl,"+2]"]}),delayDuration:500,children:(0,w.jsxs)(k,{className:"/arrange"===t.path?"active":void 0,onMouseDown:o,children:[(0,w.jsx)(f,{style:S,viewBox:"0 0 128 128"}),(0,w.jsx)(b,{children:(0,w.jsx)(p.Oj,{name:"arrange"})})]})}),(0,w.jsx)(m.m,{title:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Oj,{name:"switch-tab"})," [",h.t.cmdOrCtrl,"+3]"]}),delayDuration:500,children:(0,w.jsxs)(k,{className:"/tempo"===t.path?"active":void 0,onMouseDown:s,children:[(0,w.jsx)(y,{style:S,viewBox:"0 0 128 128"}),(0,w.jsx)(b,{children:(0,w.jsx)(p.Oj,{name:"tempo"})})]})}),(0,w.jsx)(C,{}),!(0,d.r)()&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(k,{onClick:l,children:[(0,w.jsx)(a(),{style:S}),(0,w.jsx)(b,{children:(0,w.jsx)(p.Oj,{name:"settings"})})]}),(0,w.jsxs)(k,{onClick:c,children:[(0,w.jsx)(i(),{style:S}),(0,w.jsx)(b,{children:(0,w.jsx)(p.Oj,{name:"help"})})]})]})]})}))},14461:(e,t,n)=>{n.d(t,{I:()=>c});var o=n(69229),r=n(63696),s=n(92234),i=n(59061),l=n(97233),a=n(62540);const c=(0,o.PA)((()=>{const{songStore:e}=(0,i.g)(),t=(0,l.B2)();return(0,r.useEffect)((()=>{const n=n=>{if(!e.song.isSaved){const e=t["confirm-close"];(0,s.r)()?(n.returnValue=!1,n.preventDefault(),window.electronAPI.showMessageBox({type:"question",message:e,buttons:[t.close,t.cancel]}).then((e=>{0===e&&window.electronAPI.closeMainWindow()}))):n.returnValue=e}};return window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n)}}),[]),(0,a.jsx)(a.Fragment,{})}))},85654:(e,t,n)=>{n.d(t,{f:()=>l});var o=n(97233),r=n(66459),s=n(5513),i=n(62540);const l=e=>{let{open:t,message:n,onClose:l}=e;return(0,i.jsxs)(r.lG,{open:t,onOpenChange:l,children:[(0,i.jsx)(r.L3,{children:(0,i.jsx)(o.Oj,{name:"initialize-error"})}),(0,i.jsx)(r.Cf,{children:n}),(0,i.jsx)(r.ii,{children:(0,i.jsx)(s.$,{onClick:l,children:(0,i.jsx)(o.Oj,{name:"close"})})})]})}},61229:(e,t,n)=>{n.d(t,{c:()=>m});var o=n(20994),r=n(69229),s=n(63696),i=n(50119),l=n(11735),a=n(13917),c=n(92234),d=n(59061),u=n(97233),h=n(85654),p=n(62540);const m=(0,r.PA)((()=>{const e=(0,d.g)(),t=(0,i.pC)(),n=(0,l.r3)(),[r,m]=(0,s.useState)(!1),[g,x]=(0,s.useState)(""),{show:w}=(0,o.p1)(),f=(0,u.B2)();return(0,s.useEffect)((()=>{(async()=>{await(async()=>{const t=w(f.initializing);try{await e.init()}catch(e){m(!0),x(e.message)}finally{t()}})(),await(async()=>{const e=new URLSearchParams(window.location.search).get("open");if(e){const o=w(f["loading-external-midi"]);try{const o=await n(e);t(o)}catch(e){m(!0),x(e.message)}finally{o()}}})(),await(async()=>{if(!(0,c.r)())return;const e=w(f["loading-file"]);try{const e=await window.electronAPI.getArgument();if(e){const n=await window.electronAPI.readFile(e),o=(0,a.z6)(n,e);t(o)}}catch(e){m(!0),x(e.message)}finally{e()}})()})()}),[]),(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(h.f,{open:r,message:g,onClose:()=>m(!1)})})}))},37676:(e,t,n)=>{n.d(t,{H:()=>h});var o=n(38990),r=n.n(o),s=n(69229),i=n(63696),l=n(59061),a=n(97233),c=n(44541),d=n(96016),u=n(62540);const h=(0,s.PA)((()=>{const{pianoRollStore:e}=(0,l.g)();return(0,u.jsx)(d.m,{title:(0,u.jsx)(a.Oj,{name:"event-list"}),children:(0,u.jsx)(c.I,{selected:e.showEventList,onMouseDown:(0,i.useCallback)((t=>{t.preventDefault(),e.showEventList=!e.showEventList}),[]),children:(0,u.jsx)(r(),{style:{width:"1.2rem",fill:"currentColor"}})})})}))},65977:(e,t,n)=>{n.d(t,{o:()=>d});var o=n(69229),r=n(63696),s=n(59061),i=n(16053),l=n(44541),a=n(6980),c=n(62540);const d=(0,o.PA)((()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t}}=(0,s.g)(),n=(0,r.useCallback)((()=>{const n=t;if(void 0===n)return;const o=n.programNumber;e.instrumentBrowserSetting={isRhythmTrack:n.isRhythmTrack,programNumber:o??0},e.openInstrumentBrowser=!0}),[e,t]);if(void 0===t)return(0,c.jsx)(c.Fragment,{});const{programNumber:o}=t,d=i.g[(0,i.h)(o??0)];return(0,c.jsxs)(l.I,{onMouseDown:e=>{e.preventDefault(),n()},children:[(0,c.jsx)("span",{style:{marginRight:"0.5rem"},children:d}),(0,c.jsx)("span",{children:(0,c.jsx)(a.a,{track:t})})]})}))},39774:(e,t,n)=>{n.d(t,{x:()=>p});var o=n(46287),r=n(69229),s=n(63696),i=n(50119),l=n(59061),a=n(97233),c=n(60962),d=n(62540);const u=(0,o.A)("div",{target:"e11enm5t1"})({name:"qjcow2",styles:"display:flex;flex-grow:1;max-width:8rem;min-width:5rem;margin-left:1rem;margin-right:2rem"}),h=(0,o.A)("div",{target:"e11enm5t0"})("display:flex;align-items:center;margin-right:0.5rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),p=(0,r.PA)((()=>{const{pianoRollStore:{currentPan:e,selectedTrackId:t}}=(0,l.g)(),n=(0,i.ed)(),o=(0,s.useCallback)((e=>n(t,e)),[n,t]),r=e??64;return(0,d.jsxs)(u,{children:[(0,d.jsx)(h,{children:(0,d.jsx)(a.Oj,{name:"pan"})}),(0,d.jsx)(c.A,{value:r,onChange:e=>o(e),onDoubleClick:()=>o(64),min:0,max:127,defaultValue:64,minStepsBetweenThumbs:1,marks:[64]})]})}))},92504:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(69229),r=n(63696),s=n(59061),i=n(76600),l=n(62540);const a=(0,o.PA)((()=>{const{pianoRollStore:e}=(0,s.g)(),{autoScroll:t}=e,n=(0,r.useCallback)((()=>e.autoScroll=!e.autoScroll),[e]);return(0,l.jsx)(i.X,{onClick:n,selected:t})}))},62444:(e,t,n)=>{n.d(t,{l:()=>a});var o=n(69229),r=n(63696),s=n(59061),i=n(16051),l=n(62540);const a=(0,o.PA)((()=>{const{pianoRollStore:e}=(0,s.g)(),{quantize:t,isQuantizeEnabled:n}=e,o=(0,r.useCallback)((t=>{e.quantize=t}),[e]),a=(0,r.useCallback)((()=>{e.isQuantizeEnabled=!e.isQuantizeEnabled}),[e]);return(0,l.jsx)(i.A,{value:t,enabled:n,onSelect:o,onClickSwitch:a})}))},10155:(e,t,n)=>{n.d(t,{C:()=>a});var o=n(69229),r=n(63696),s=n(59061),i=n(16139),l=n(62540);const a=(0,o.PA)((()=>{const{pianoRollStore:e}=(0,s.g)();return(0,l.jsx)(i.y,{mouseMode:e.mouseMode,onSelect:(0,r.useCallback)((t=>e.mouseMode=t),[])})}))},14557:(e,t,n)=>{n.d(t,{c:()=>f});var o=n(46287),r=n(90829),s=n(99677),i=n(81244),l=n(37676),a=n(65977),c=n(39774),d=n(92504),u=n(62444),h=n(10155),p=n(84206),m=n(78155),g=n(62540);const x=(0,o.A)("div",{target:"e4nwxol1"})({name:"1twx5wq",styles:"width:1rem"}),w=(0,o.A)("div",{target:"e4nwxol0"})({name:"1ff36h2",styles:"flex-grow:1"}),f=()=>(0,g.jsxs)(s.M,{children:[(0,g.jsx)(i.D,{}),(0,g.jsx)(p.H,{}),(0,g.jsx)(l.H,{}),(0,g.jsx)(x,{}),(0,g.jsx)(a.o,{}),(0,g.jsx)(r.A,{}),(0,g.jsx)(m.S,{}),(0,g.jsx)(c.x,{}),(0,g.jsx)(w,{}),(0,g.jsx)(h.C,{}),(0,g.jsx)(u.l,{}),(0,g.jsx)(d.D,{})]})},84206:(e,t,n)=>{n.d(t,{H:()=>u});var o=n(46287),r=n(69229),s=n(63696),i=n(59061),l=n(8008),a=n(62540);const c=(0,o.A)("span",{target:"e1x5aaya1"})({name:"adnvm0",styles:"font-weight:bold;margin-right:2em;font-size:1rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:14rem;min-width:3em"}),d=(0,o.A)("input",{target:"e1x5aaya0"})("font-size:inherit;font-family:inherit;border:",(e=>{let{theme:t}=e;return t.dividerColor})," 1px solid;color:inherit;height:2rem;padding:0 0.5rem;box-sizing:border-box;border-radius:4px;margin-right:1em;background:#00000017;outline:none;"),u=(0,r.PA)((()=>{const{pianoRollStore:{selectedTrack:e}}=(0,i.g)(),[t,n]=(0,s.useState)(!1);return void 0===e?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(a.Fragment,{children:t?(0,a.jsx)(d,{defaultValue:e.name??"",ref:e=>e?.focus(),onKeyPress:t=>{"Enter"===t.key&&(e.setName(t.currentTarget.value),n(!1))},onKeyDown:e=>{"Escape"===e.key&&n(!1)},onBlur:()=>n(!1)}):(0,a.jsx)(c,{onDoubleClick:()=>n(!0),children:(0,a.jsx)(l.x,{track:e})})})}))},78155:(e,t,n)=>{n.d(t,{S:()=>m});var o=n(46287),r=n(4126),s=n.n(r),i=n(69229),l=n(63696),a=n(50119),c=n(59061),d=n(60962),u=n(62540);const h=(0,o.A)("div",{target:"eg9rc0n1"})({name:"1vyxjlb",styles:"display:flex;flex-grow:1;max-width:8rem;min-width:5rem;margin-left:1rem;margin-right:1rem;align-items:center"}),p=(0,o.A)(s(),{target:"eg9rc0n0"})("width:1.3rem;height:2rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";margin-right:0.5rem;"),m=(0,i.PA)((()=>{const{pianoRollStore:{currentVolume:e,selectedTrackId:t}}=(0,c.g)(),n=(0,a.J2)(),o=e??100,r=(0,l.useCallback)((e=>n(t,e)),[n,t]);return(0,u.jsxs)(h,{children:[(0,u.jsx)(p,{}),(0,u.jsx)(d.A,{value:o,onChange:e=>r(e),max:127,minStepsBetweenThumbs:1})]})}))},75710:(e,t,n)=>{n.d(t,{A:()=>w});var o=n(83785),r=n(17243),s=n(69229),i=n(63696),l=n(50119),a=n(92770),c=n(78439),d=n(59061),u=n(61508),h=n(24719),p=n(87680),m=n(62540);const g=(0,s.PA)((e=>{let{rulerStore:t,onMouseDown:n,style:s}=e;const{player:g,player:{loop:x}}=(0,d.g)(),w=(0,l.UI)(),f=(0,o.u)(),{onContextMenu:v,menuProps:y}=(0,c.E)(),[j,k]=(0,i.useState)(null),[b,C]=(0,i.useState)(0),S=a.PE.rulerHeight,{canvasWidth:R,transform:A,scrollLeft:T}=t.parent,{beats:E,timeSignatures:I,quantizer:D}=t,M=(0,i.useCallback)((e=>{const n=t.getTick(e.nativeEvent.offsetX),o=D.round(n);e.nativeEvent.ctrlKey?g.setLoopBegin(o):e.nativeEvent.altKey?g.setLoopEnd(o):g.position=o}),[D,g]),O=(0,i.useCallback)((e=>{const o=(e=>{const t=A.getTick(20);return(0,r.findLast)(I,(n=>n.tick<e&&n.tick+t>=e))})(t.getTick(e.nativeEvent.offsetX));void 0!==o?(((e,n)=>{2==n.detail?k(e):(t.selectedTimeSignatureEventIds=[e.id],2===n.button&&(C(t.getQuantizedTick(n.nativeEvent.offsetX)),v(n)))})(o,e),M(e)):2==e.button?(C(t.getQuantizedTick(e.nativeEvent.offsetX)),v(e)):(t.selectedTimeSignatureEventIds=[],M(e)),n?.(e)}),[D,g,T,A,I]),P=(0,i.useCallback)((e=>{e.clearRect(0,0,R,S),e.save(),e.translate(.5-T,0),function(e,t,n,o){e.strokeStyle=o.secondaryTextColor,e.lineWidth=1,e.beginPath();const r=n.length>1&&n[1].x-n[0].x<=5;n.forEach((n=>{let{beat:s,measure:i,x:l}=n;const a=0===s;a?(e.moveTo(l,t/2),e.lineTo(l,t)):r||(e.moveTo(l,.8*t),e.lineTo(l,t)),!a||r&&i%2!=0||(e.textBaseline="top",e.font=`12px ${o.canvasFont}`,e.fillStyle=o.secondaryTextColor,e.fillText(`${i+1}`,l+2,2))})),e.closePath(),e.stroke()}(e,S,E,f),null!==x&&function(e,t,n,o,r){e.lineWidth=1,e.fillStyle=t.enabled?r.themeColor:r.secondaryTextColor,e.strokeStyle=t.enabled?r.themeColor:r.secondaryTextColor,e.beginPath();const s=o.getX(t.begin),i=o.getX(t.end);if(null!==t.begin){const t=s;e.moveTo(t,0),e.lineTo(t,n),e.moveTo(t,0),e.lineTo(t+8,0),e.lineTo(t,8)}if(null!==t.end){const t=i;e.moveTo(t,0),e.lineTo(t,n),e.moveTo(t,0),e.lineTo(t-8,0),e.lineTo(t,8)}e.closePath(),e.fill(),e.stroke()}(e,x,S,A,f),function(e,t,n,o,r){e.textBaseline="bottom",e.font=`11px ${r.canvasFont}`,n.forEach((n=>{const s=o.getX(n.tick),i=`${n.numerator}/${n.denominator}`,l=e.measureText(i),a=l.actualBoundingBoxAscent+l.actualBoundingBoxDescent;e.fillStyle=n.isSelected?r.themeColor:r.secondaryBackgroundColor;const c=a+8;!function(e,t,n,o,r,s){e.beginPath(),e.moveTo(t,n),e.lineTo(t+o+s,n),e.lineTo(t+o,n+r),e.lineTo(t,n+r),e.lineTo(t,n),e.closePath(),e.fill()}(e,s,t-c,l.width+4,c,a),e.fillStyle=n.isSelected?r.onSurfaceColor:r.textColor,e.fillText(i,s+2,t-2)}))}(e,S,I,A,f),e.restore()}),[R,A,T,E,I,x,f]),B=(0,i.useCallback)((()=>{k(null)}),[]),N=(0,i.useCallback)((e=>{let{numerator:n,denominator:o}=e;t.selectedTimeSignatureEventIds.forEach((e=>{w(e,n,o)}))}),[w]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(u.A,{draw:P,width:R,height:S,onMouseDown:O,onContextMenu:e=>e.preventDefault(),style:s}),(0,m.jsx)(h.r,{...y,rulerStore:t,tick:b}),(0,m.jsx)(p.I,{open:null!=j,initialNumerator:j?.numerator,initialDenominator:j?.denominator,onClose:B,onClickOK:N})]})}));function x(e,t){return(0,r.isEqual)(e.style,t.style)}const w=i.memo(g,x)},68044:(e,t,n)=>{n.d(t,{d:()=>r});var o=n(59061);const r=()=>{const{pianoRollStore:e}=(0,o.g)();return{onMouseDown(t,n){e.selectedNoteIds.push(n)}}}},61278:(e,t,n)=>{n.d(t,{j:()=>r});var o=n(59061);const r=()=>{const{pianoRollStore:e}=(0,o.g)();return{onMouseDown(){e.toggleTool(),e.notesCursor="crosshair"}}}},81304:(e,t,n)=>{n.d(t,{P:()=>i});var o=n(2265),r=n(59061),s=n(6017);const i=()=>{const{song:{timebase:e},pianoRollStore:t,pianoRollStore:{transform:n,selectedTrack:i,quantizer:l,newNoteVelocity:a},pushHistory:c}=(0,r.g)(),d=(0,s.Kv)();return{onMouseDown(r){if(r.shiftKey)return;const s=t.getLocal(r),{tick:u,noteNumber:h}=n.getNotePoint(s);if(void 0===i||null==i.channel||!o.i.isValid(h))return;c();const p=i.isRhythmTrack?l.round(u):l.floor(u),m=i.isRhythmTrack?e/8:t.lastNoteDuration??l.unit,g=i.addEvent({type:"channel",subtype:"note",noteNumber:h,tick:p,velocity:a,duration:m});void 0!==g&&d.onMouseDown(r,g.id)}}}},88854:(e,t,n)=>{n.d(t,{r:()=>a});var o=n(50119),r=n(51382),s=n(40540),i=n(54015),l=n(59061);const a=()=>{const{pianoRollStore:e,pianoRollStore:{transform:t,quantizer:n,selectedTrack:a},player:c,controlStore:d}=(0,l.g)();return{onMouseDown(l){if(void 0===a)return;const u=e.getLocal(l),h=t.getNotePointFractional(u),p=u;c.isPlaying||(c.position=n.round(h.tick)),d.selectedEventIds=[],e.selection=s.L.fromPoints(h,h),(0,i.R)(l,{onMouseMove:(o,i)=>{const l=r.b.add(p,i),a=t.getNotePointFractional(l);e.selection=s.L.fromPoints({...h,tick:n.round(h.tick)},{...a,tick:n.round(a.tick)})},onMouseUp:()=>{const{selection:t}=e;null!==t&&(e.selectedNoteIds=(0,o.XA)(a.events,t).map((e=>e.id)))}})}}}},6017:(e,t,n)=>{n.d(t,{H:()=>c,Kv:()=>d,eb:()=>a});var o=n(50119),r=n(59061),s=n(22095),i=n(77024);const l=e=>()=>{const{pianoRollStore:t,pianoRollStore:{selectedTrack:n,selectedNoteIds:l}}=(0,r.g)(),a=(0,o.eE)(),c=(0,o.mG)(),d=(0,o.Yr)(),u=(0,i.H)();return{onMouseDown(o,r){if(void 0===n||void 0===n.channel)return;const i=n.getEventById(r);if(null==i||!(0,s.Fb)(i))return;l.includes(r)||a(r);const h=t.selectedNoteIds,{channel:p}=n;c({...i,channel:p});let m=i.noteNumber;u.onMouseDown(o,{type:"note",position:e,noteId:r},h.filter((e=>e!==r)).map((t=>({type:"note",position:e,noteId:t}))),{onChange(e,o){let{oldPosition:i,newPosition:l}=o;const a=n.getEventById(r);null!=a&&(0,s.Fb)(a)&&(i.tick!==l.tick&&(t.lastNoteDuration=a.duration),i.noteNumber!==l.noteNumber&&a.noteNumber!==m&&(d({noteNumber:m,channel:p}),c({noteNumber:a.noteNumber,channel:p,velocity:a.velocity}),m=a.noteNumber))},onMouseUp(){d({noteNumber:m,channel:p})},onClick(e){e.shiftKey||a(r)}})}}},a=l("left"),c=l("right"),d=l("center")},73041:(e,t,n)=>{n.d(t,{c:()=>s});var o=n(54015),r=n(59061);const s=()=>{const{pianoRollStore:e}=(0,r.g)();return{onMouseDown(){(0,o.b)({onMouseMove:t=>{e.scrollBy(t.movementX,t.movementY),e.autoScroll=!1}})}}}},40432:(e,t,n)=>{n.d(t,{D:()=>r});var o=n(77024);const r=()=>{const e=(0,o.H)();return{onMouseDown(t,n){e.onMouseDown(t,{type:"selection",position:"left"},n.map((e=>({type:"note",position:"left",noteId:e}))))}}}},31945:(e,t,n)=>{n.d(t,{g:()=>r});var o=n(77024);const r=()=>{const e=(0,o.H)();return{onMouseDown(t,n){e.onMouseDown(t,{type:"selection",position:"right"},n.map((e=>({type:"note",position:"right",noteId:e}))))}}}},77024:(e,t,n)=>{n.d(t,{H:()=>d});var o=n(51382),r=n(71229),s=n(3354),i=n(54015),l=n(59061),a=n(52013);const c=(e,t)=>({tick:void 0!==t.tickRange?r.Q.clamp(t.tickRange,e.tick):e.tick,noteNumber:void 0!==t.noteNumberRange?r.Q.clamp(t.noteNumberRange,e.noteNumber):e.noteNumber}),d=()=>{const{pianoRollStore:e,pianoRollStore:{isQuantizeEnabled:t,transform:n,quantizer:r},pushHistory:d}=(0,l.g)();return{onMouseDown(l,u){let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const m=e.getDraggablePosition(u);if(null===m)return;let g=!1;const x=e.getLocal(l),w=n.getNotePoint(x),f=s.T.sub(m,w),v=h.map((t=>e.getDraggablePosition(t)));(0,i.R)(l,{onMouseMove:(i,l)=>{const w=!i.shiftKey&&t,y=w?r.unit:a.G,j=e.getDraggableArea(u,y);if(null===j)return;const k=e.getDraggablePosition(u);if(null===k)return;const b=(()=>{const e=o.b.add(x,l),t=s.T.add(n.getNotePoint(e),f),i=w?{tick:r.round(t.tick),noteNumber:t.noteNumber}:t;return c(i,j)})();if(s.T.equals(b,k))return;const C=s.T.sub(b,m),S=h.map(((t,n)=>{const o=v[n];if(null===o)return null;const r=e.getDraggableArea(t,y);if(null===r)return null;const i=s.T.add(o,C);return c(i,r)}));g||(g=!0,d()),e.updateDraggable(u,b),h.forEach(((t,n)=>{const o=S[n];null!==o&&null!==o&&e.updateDraggable(t,o)})),p?.onChange?.(i,{oldPosition:k,newPosition:b})},onMouseUp:e=>{p?.onMouseUp?.(e)},onClick:e=>{p?.onClick?.(e)}})}}}},91375:(e,t,n)=>{n.d(t,{C:()=>s});var o=n(50119),r=n(77024);const s=()=>{const e=(0,r.H)(),t=(0,o.R8)();return{onMouseDown:(n,o)=>(n.metaKey&&t(),e.onMouseDown(n,{type:"selection",position:"center"},o.map((e=>({type:"note",position:"center",noteId:e})))))}}},26254:(e,t,n)=>{n.d(t,{J:()=>r});var o=n(59061);const r=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t,selectedNoteIds:n}}=(0,o.g)();return{onMouseDown(o,r){void 0!==t&&0!==n.length&&(e.selectedNoteIds=n.filter((e=>e!==r)))}}}},74168:(e,t,n)=>{n.d(t,{p:()=>i});var o=n(51382),r=n(54015),s=n(59061);const i=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t},pushHistory:n}=(0,s.g)(),i=o=>{void 0!==t&&(n(),t.removeEvent(o),e.selectedNoteIds=e.selectedNoteIds.filter((e=>e!==o)))};return{onMouseDown(t){const n=e.getLocal(t),s=e.getNotes(n);s.length>0&&i(s[0].id),(0,r.R)(t,{onMouseMove:(t,r)=>{const s=o.b.add(n,r),l=e.getNotes(s);l.length>0&&i(l[0].id)}})}}}},63988:(e,t,n)=>{n.d(t,{p:()=>a});var o=n(50119),r=n(51382),s=n(40540),i=n(54015),l=n(59061);const a=()=>{const{pianoRollStore:e,pianoRollStore:{transform:t,quantizer:n},player:a,controlStore:c}=(0,l.g)();return{onMouseDown(l){const d=e.getLocal(l),u=t.getNotePoint(d),h=d;a.isPlaying||(a.position=n.round(u.tick)),c.selectedEventIds=[],e.selection=s.L.fromPoints(u,u),(0,i.R)(l,{onMouseMove:(n,o)=>{const i=r.b.add(h,o),l=t.getNotePoint(i);e.selection=s.L.fromPoints(u,l)},onMouseUp:()=>{const{selection:t,selectedTrack:n}=e;null!==t&&void 0!==n&&(e.selectedNoteIds=(0,o.XA)(n.events,t).map((e=>e.id)),e.selection=null)}})}}}},84038:(e,t,n)=>{n.d(t,{m:()=>c});var o=n(63696),r=n(59061),s=n(61278),i=n(73041),l=n(14206),a=n(52013);const c=()=>{const{pianoRollStore:e,pianoRollStore:{mouseMode:t}}=(0,r.g)(),[n,c]=(0,o.useState)(!1),d=(0,l._)(),u=(0,a.n)(),h=(()=>{switch(t){case"pencil":return d;case"selection":return u}})(),p=(0,i.c)(),m=(0,s.j)();return{onMouseDown(e){const t=e.nativeEvent;c(!0),function(e){return 1===e.button?p:2===e.button&&e.detail%2==0?m:h}(t).onMouseDown(t)},onMouseMove(t){const o=t.nativeEvent;if(!n){const t=h.getCursor(o);e.notesCursor=t}},onMouseUp(){c(!1)}}}},14206:(e,t,n)=>{n.d(t,{_:()=>d});var o=n(59061),r=n(68044),s=n(81304),i=n(6017),l=n(26254),a=n(74168),c=n(63988);const d=()=>{const{pianoRollStore:e}=(0,o.g)(),t=(0,a.p)(),n=(0,s.P)(),d=(0,c.p)(),p=(0,i.Kv)(),m=(0,i.eb)(),g=(0,i.H)(),x=(0,l.J)(),w=(0,r.d)();return{onMouseDown(o){const r=e.getLocal(o),s=e.getNotes(r),i=e.selectedTrack?.isRhythmTrack??!1;switch(o.button){case 0:if(!(s.length>0))return o.shiftKey||o.metaKey?d.onMouseDown(o):n.onMouseDown(o);{if(o.detail%2==0)return t.onMouseDown(o);const e=s[0];if(o.shiftKey)e.isSelected?x.onMouseDown(o,e.id):w.onMouseDown(o,e.id);else switch(h(r,e,i)){case"center":return p.onMouseDown(o,e.id);case"left":return m.onMouseDown(o,e.id);case"right":return g.onMouseDown(o,e.id)}}break;case 2:return t.onMouseDown(o);default:return null}},getCursor(t){const n=e.getLocal(t),o=e.getNotes(n),r=e.selectedTrack?.isRhythmTrack??!1;if(o.length>0){const e=h(n,o[0],r);return u(e)}return"auto"}}},u=e=>{switch(e){case"center":return"move";case"left":return"w-resize";case"right":return"e-resize"}},h=(e,t,n)=>{if(null===t)return console.warn("no item"),"center";const o=e.x-t.x;if(n)return"center";const r=Math.min(t.width/3,8);return o<=r?"left":t.width-o<=r?"right":"center"}},52013:(e,t,n)=>{n.d(t,{G:()=>a,n:()=>c});var o=n(59061),r=n(88854),s=n(40432),i=n(31945),l=n(91375);const a=10,c=()=>{const{pianoRollStore:e,pianoRollStore:{selectionBounds:t,selectedNoteIds:n}}=(0,o.g)(),a=(0,l.C)(),c=(0,s.D)(),u=(0,i.g)(),h=(0,r.r)();return{onMouseDown(o){if(o.relatedTarget)return null;const r=e.getLocal(o);if(0===o.button){if(null===t)return h.onMouseDown(o);switch(d(t,r)){case"center":return a.onMouseDown(o,n);case"right":return u.onMouseDown(o,n);case"left":return c.onMouseDown(o,n);case"outside":return h.onMouseDown(o)}}return null},getCursor(n){const o=e.getLocal(n);switch(null===t?"outside":d(t,o)){case"center":return"move";case"left":return"w-resize";case"right":return"e-resize";case"outside":return"crosshair"}}}};function d(e,t){const n=e;if(!(n.x<=t.x&&n.x+n.width>=t.x&&n.y<=t.y&&n.y+n.height>=t.y))return"outside";const o=t.x-n.x,r=Math.min(n.width/3,8);return o<=r?"left":n.width-o<=r?"right":"center"}},57112:(e,t,n)=>{n.d(t,{y:()=>C});var o=n(83785),r=n(44308),s=n.n(r),i=n(69229),l=n(63696),a=n(92770),c=n(51382),d=n(64659),u=n(44569),h=n(54015),p=n(78439),m=n(59061),g=n(6358),x=n(61508),w=n(75442),f=n(62540);const v=[0,1,0,1,0,0,1,0,1,0,1,0];function y(e,t,n){e.lineWidth=1,e.strokeStyle=n,e.beginPath(),e.moveTo(0,0),e.lineTo(t,0),e.closePath(),e.stroke()}function j(e,t,n,o,r,s,i){r&&(e.fillStyle=o.themeColor,e.fillRect(0,.5,t,n)),s&&(e.fillStyle=o.themeColor,e.fillRect(t-4,.5,4,n)),i&&y(e,t,o.dividerColor)}function k(e,t,n,o,r,s,i,l){const a=Math.round(o/2);e.fillStyle=i,e.fillRect(0,.5,t,o),s&&(e.fillStyle=r.themeColor,e.fillRect(t-4,.5,4,o)),e.lineWidth=1,e.strokeStyle=l,e.beginPath(),e.moveTo(t,a),e.lineTo(n,a),e.closePath(),e.stroke()}function b(e,t,n,o,r,s){const i=t-5;e.textAlign="right",e.textBaseline="middle",e.font=`12px ${r}`,e.fillStyle=s,e.fillText((0,u.bF)(o),i,n/2)}const C=(0,i.PA)((()=>{const e=(0,o.u)(),{pianoRollStore:t,pianoRollStore:{keySignature:n,transform:{numberOfKeys:r,pixelsPerKey:i},previewingNoteNumbers:u},player:C}=(0,m.g)(),S=a.PE.keyWidth,R=a.PE.keyWidth*a.PE.blackKeyWidthRatio,[A,T]=(0,l.useState)(new Set),{onContextMenu:E,menuProps:I}=(0,p.E)(),D=new Set([...A,...u]),M=(0,l.useCallback)((t=>{const o=null!==n?d.u.getIntervals(n):[];!function(e,t,n,o,r,i,l,a){e.save(),e.translate(0,.5),e.fillStyle=i.pianoKeyWhite,e.fillRect(0,0,n,o*r);const c=[...Array(r).keys()],d=c.filter((e=>0===v[e%v.length])),u=c.filter((e=>1===v[e%v.length])),h=c.filter((e=>e%12==0));y(e,n,i.dividerColor);for(const t of d){let s=(r-t-1)*o;const c=l.has(t),d=a.includes(t%12),u=t%12==4||t%12==11;let h=o;1===v[(t-1)%v.length]&&(h+=.5*o),1===v[(t+1)%v.length]&&(s-=.5*o,h+=.5*o),e.save(),e.translate(0,s),j(e,n,h,i,c,d,u),e.restore()}const p=function(e,t){const n=e.createLinearGradient(0,0,t,0);return n.addColorStop(0,"rgba(33, 33, 33, 1.000)"),n.addColorStop(.895,"rgba(96, 93, 93, 1.000)"),n.addColorStop(.924,"rgba(48, 48, 48, 1.000)"),n.addColorStop(1,"rgba(0, 0, 0, 1.000)"),n}(e,t),m=s()(i.dividerColor).alpha(.3).string();for(const s of u){const c=(r-s-1)*o,d=l.has(s),u=a.includes(s%12);e.save(),e.translate(0,c),k(e,t,n,o,i,u,d?i.themeColor:p,m),e.restore()}for(const t of h){const s=(r-t-1)*o;e.save(),e.translate(0,s),b(e,n,o,t,i.canvasFont,i.secondaryTextColor),e.restore()}e.restore()}(t,R,S,i,r,e,D,o)}),[r,e,D,n,i,R]),O=(0,l.useCallback)((e=>{if(0!==e.button)return;function n(e,t){const n=r-t/i,o=Math.floor(n);return e>R&&0!==v[o%v.length]?Math.round(n)-Math.floor(n)?o+1:o-1:o}const o={x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY},{selectedTrack:s}=t,l=s?.channel??0;let a=n(o.x,o.y);C.sendEvent((0,g.d1)(0,l,a,127)),T(new Set([a])),(0,h.R)(e.nativeEvent,{onMouseMove(e,t){const r=c.b.add(o,t),s=n(r.x,r.y);s!==a&&(C.sendEvent((0,g.dG)(0,l,a,0)),C.sendEvent((0,g.d1)(0,l,s,127)),a=s,T(new Set([s])))},onMouseUp(){C.sendEvent((0,g.dG)(0,l,a,0)),T(new Set)}})}),[r,i]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(x.A,{draw:M,width:S,height:i*r,onMouseDown:O,onContextMenu:E}),(0,f.jsx)(w.a,{...I})]})}))},75442:(e,t,n)=>{n.d(t,{a:()=>u});var o=n(69229),r=n(63696),s=n(59061),i=n(97233),l=n(5909),a=n(95229),c=n(94724),d=n(62540);const u=(0,o.PA)((e=>{const{handleClose:t}=e,{pianoRollStore:n}=(0,s.g)(),[o,u]=(0,r.useState)(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(l.t,{...e,children:[(0,d.jsx)(c.Dr,{onClick:()=>{null===n.keySignature&&(n.keySignature={scale:"major",key:0}),u(!0),t()},children:(0,d.jsx)(i.Oj,{name:"show-scale"})}),(0,d.jsx)(c.Dr,{onClick:()=>{n.keySignature=null,t()},disabled:null===n.keySignature,children:(0,d.jsx)(i.Oj,{name:"hide-scale"})})]}),(0,d.jsx)(a.C,{open:o,onOpenChange:u})]})}))},72993:(e,t,n)=>{n.d(t,{A:()=>y});var o=n(46287),r=n(96604),s=n.n(r),i=n(17243),l=n(69229),a=n(63696),c=n(92770),d=n(25649),u=n(59061),h=n(54773),p=n(49422),m=n(4487),g=n(29966),x=n(62540);const w=(0,o.A)("div",{target:"e1p0ipbr2"})("flex-grow:1;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";position:relative;"),f=(0,o.A)("div",{target:"e1p0ipbr1"})({name:"1fjjas",styles:"flex-grow:1;position:relative;.alphaContent{position:absolute;top:0;left:0;}"}),v=(0,o.A)("div",{target:"e1p0ipbr0"})("border-top:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";height:calc(100% - 17px);"),y=(0,l.PA)((()=>{const{pianoRollStore:e,pianoRollStore:{scaleX:t,scaleY:n,scrollLeft:o,scrollTop:r,transform:l,contentWidth:y,contentHeight:j}}=(0,u.g)(),k=(0,a.useRef)(null),b=s()(k),C=(0,a.useRef)(null),{height:S=0}=s()(C),R=(0,a.useCallback)((()=>e.scaleAroundPointX(.2,c.PE.keyWidth)),[t,e]),A=(0,a.useCallback)((()=>e.scaleAroundPointX(-.2,c.PE.keyWidth)),[t,e]),T=(0,a.useCallback)((()=>e.scaleX=1),[e]),E=(0,a.useCallback)((()=>e.scaleAroundPointY(.2,0)),[n,e]),I=(0,a.useCallback)((()=>e.scaleAroundPointY(-.2,0)),[n,e]),D=(0,a.useCallback)((()=>e.scaleY=1),[e]),M=(0,a.useCallback)((t=>{if(t.shiftKey&&(t.altKey||t.ctrlKey)){let n=(0,d.T)(t.nativeEvent)?.02*t.deltaY:.01*t.deltaX;n=(0,i.clamp)(n,-.15,.15),e.scaleAroundPointY(n,t.nativeEvent.offsetY)}else if(t.altKey||t.ctrlKey){const n=(0,d.T)(t.nativeEvent)?.01:-.01,o=(0,i.clamp)(t.deltaY*n,-.15,.15);e.scaleAroundPointX(o,t.nativeEvent.offsetX)}else{const n=(0,d.T)(t.nativeEvent)?1:l.pixelsPerKey*c.De,o=t.deltaY*n;e.scrollBy(-t.deltaX,-o)}}),[e,l]),O=(0,a.useCallback)((()=>{e.setScrollTopInPixels(e.scrollTop)}),[e]);return(0,x.jsxs)(w,{ref:k,children:[(0,x.jsxs)(g.W,{split:"horizontal",minSize:50,defaultSize:"60%",onChange:O,children:[(0,x.jsxs)(f,{onWheel:M,ref:C,children:[(0,x.jsx)(m.d,{width:b.width,height:S}),(0,x.jsx)(p.J,{scrollOffset:r,contentLength:j,onScroll:(0,a.useCallback)((t=>e.setScrollTopInPixels(t)),[e]),onClickScaleUp:E,onClickScaleDown:I,onClickScaleReset:D})]}),(0,x.jsx)(v,{children:(0,x.jsx)(h.A,{})})]}),(0,x.jsx)(p.j,{scrollOffset:o,contentLength:y,onScroll:(0,a.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[e]),onClickScaleUp:R,onClickScaleDown:A,onClickScaleReset:T})]})}))},93790:(e,t,n)=>{n.d(t,{l:()=>y});var o=n(83785),r=n(44308),s=n.n(r),i=n(51080),l=n(69229),a=n(63696),c=n(38038),d=n(86738),u=n(71229),h=n(72343),p=n(51046),m=n(59061),g=n(22095),x=n(30453),w=n(94995),f=n(69120),v=n(62540);const y=(0,l.PA)((e=>{let{zIndex:t,trackId:n}=e;const{song:r,pianoRollStore:{transform:l,scrollLeft:y,canvasWidth:j}}=(0,m.g)(),k=(0,o.u)(),b=r.getTrack(n);if(void 0===b)return(0,v.jsx)(v.Fragment,{});const C=(0,a.useMemo)((()=>b.events.filter(g.Fb).filter((0,p.L)(u.Q.fromLength(l.getTick(y),l.getTick(j))))),[y,j,l.horizontalId,b.events]),S=(0,a.useMemo)((()=>C.map((e=>{const t=b.isRhythmTrack?l.getDrumRect(e):l.getRect(e),n={push:1,pull:2,both:3,undefined:0}[(0,d.lU)(c.IN.midiToNoteName(e.noteNumber))||"undefined"];return{...t,id:e.id,velocity:126,isSelected:!1,colorId:n}}))),[C,l,b.isRhythmTrack]),R=(0,h.B)(s()(k.ghostNoteColor)),A=i.v_(i.vt()),T=void 0!==b.color?(0,x.I)(b.color):null,E=null!==T?i.Cc(i.vt(),T,R,.7):R;return b.isRhythmTrack?(0,v.jsx)(w.G,{strokeColor:A,rects:S,inactiveColor:A,activeColor:E,selectedColor:E,zIndex:t}):(0,v.jsx)(f.D,{rects:S,strokeColor:A,inactiveColor:A,activeColor:E,selectedColor:E,zIndex:t+.1})}))},30362:(e,t,n)=>{n.d(t,{v:()=>i});var o=n(47547),r=n(46128),s=n(62540);const i=e=>{let{rect:t,color:n,highlightedColor:i,laneColors:l,height:a,zIndex:c}=e;const d=(0,o.I1)();return(0,s.jsx)(o.oW,{createShader:r.e,createBuffer:e=>new r.L(e),uniforms:{projectionMatrix:d,color:n,highlightedColor:i,laneColors:l,height:a},buffer:t,zIndex:c})}},5277:(e,t,n)=>{n.d(t,{q:()=>m});var o=n(83785),r=n(44308),s=n.n(r),i=n(69229),l=n(63696),a=n(92770),c=n(64659),d=n(72343),u=n(59061),h=n(30362),p=n(62540);const m=(0,i.PA)((e=>{let{zIndex:t}=e;const n=(0,o.u)(),{pianoRollStore:{scrollTop:r,canvasWidth:i,canvasHeight:m,scaleY:g,keySignature:x}}=(0,u.g)(),w=(0,l.useMemo)((()=>{const e=(0,d.B)(s()(n.pianoWhiteKeyLaneColor)),t=(0,d.B)(s()(n.pianoBlackKeyLaneColor));if(null===x)return Float32Array.from(Array(12).fill(0).map(((n,o)=>c.u.getIntervals({scale:"major",key:0}).includes(o)?e:t)).flat());const o=function(e){const t=c.u.getIntervals(e);return new Array(12).fill(!1).map(((e,n)=>t.includes(n%12)))}(x),r=(0,d.B)(s()(n.pianoHighlightedLaneColor)),i=o.map((t=>t?r:e));return Float32Array.from(i.flat())}),[n,x]),f=(0,l.useMemo)((()=>(0,d.B)(s()(n.pianoLaneEdgeColor))),[n]),v=(0,l.useMemo)((()=>(0,d.B)(s()(n.editorGridColor))),[n]);return(0,p.jsx)(h.v,{rect:{x:0,y:r,width:i,height:m},color:f,highlightedColor:v,laneColors:w,height:g*a.PE.keyHeight,zIndex:t})}))},94995:(e,t,n)=>{n.d(t,{G:()=>l});var o=n(47547),r=n(97468),s=n(89436),i=n(62540);const l=e=>{let{rects:t,strokeColor:n,selectedColor:l,inactiveColor:a,activeColor:c,zIndex:d}=e;const u=(0,o.I1)();return(0,i.jsx)(o.oW,{createShader:r.G,createBuffer:e=>new s.r(e),uniforms:{projectionMatrix:u,strokeColor:n,selectedColor:l,inactiveColor:a,activeColor:c},buffer:t,zIndex:d})}},69120:(e,t,n)=>{n.d(t,{D:()=>i});var o=n(47547),r=n(89436),s=n(62540);const i=e=>{let{rects:t,strokeColor:n,inactiveColor:i,activeColor:l,selectedColor:a,zIndex:c}=e;const d=(0,o.I1)();return(0,s.jsx)(o.oW,{createShader:r.K,createBuffer:e=>new r.r(e),uniforms:{projectionMatrix:d,strokeColor:n,selectedColor:a,inactiveColor:i,activeColor:l},buffer:t,zIndex:c})}},74411:(e,t,n)=>{n.d(t,{u:()=>m});var o=n(83785),r=n(44308),s=n.n(r),i=n(69229),l=n(38038),a=n(86738),c=n(72343),d=n(59061),u=n(94995),h=n(69120),p=n(62540);const m=(0,i.PA)((e=>{let{zIndex:t}=e;const{pianoRollStore:{notes:n,selectedTrack:r}}=(0,d.g)(),i=(0,o.u)();if(void 0===r)return(0,p.jsx)(p.Fragment,{});const m=s()("yellow"),g=(0,c.B)(s()("#292B32")),x=(0,c.B)(m.lighten(.7)),w=(0,c.B)(s()(i.backgroundColor)),f=(0,c.B)(m),v=n.map((e=>r?.getEventById(e.id))),y=n.map(((e,t)=>({...e,colorId:{push:1,pull:2,both:3,undefined:0}[(0,a.lU)(l.IN.midiToNoteName(v[t].noteNumber))||"undefined"]})));return(0,p.jsxs)(p.Fragment,{children:[r.isRhythmTrack&&(0,p.jsx)(u.G,{strokeColor:g,rects:y,inactiveColor:w,activeColor:f,selectedColor:x,zIndex:t}),!r.isRhythmTrack&&(0,p.jsx)(h.D,{strokeColor:g,inactiveColor:w,activeColor:f,selectedColor:x,rects:y,zIndex:t+.1})]})}))},55930:(e,t,n)=>{n.d(t,{F:()=>v});var o=n(83785),r=n(47547),s=n(69229),i=n(63696),l=n(28632),a=n(78439),c=n(59061),d=n(51618),u=n(98423),h=n(31563),p=n(84038),m=n(86653),g=n(93790),x=n(5277),w=n(74411),f=n(62540);const v=(0,s.PA)((e=>{let{width:t,height:n}=e;const{pianoRollStore:s,pianoRollStore:{notesCursor:v,scrollLeft:y,scrollTop:j,rulerStore:{beats:k},cursorX:b,selectionBounds:C,ghostTrackIds:S}}=(0,c.g)(),R=(0,p.m)(),{onContextMenu:A,menuProps:T}=(0,a.E)(),E=(0,o.u)(),I=(0,i.useCallback)((e=>{if("selection"===s.mouseMode)return e.stopPropagation(),void A(e)}),[]);(0,i.useEffect)((()=>{s.canvasWidth=t}),[t]),(0,i.useEffect)((()=>{s.canvasHeight=n}),[n]);const D=(0,i.useMemo)((()=>(0,l.L)(-y,0)),[y]),M=(0,i.useMemo)((()=>(0,l.L)(0,-j)),[y,j]),O=(0,i.useMemo)((()=>(0,l.L)(-y,-j)),[y,j]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(r.om,{width:t,height:n,style:{cursor:v,background:E.pianoWhiteKeyLaneColor},onContextMenu:I,onMouseDown:R.onMouseDown,onMouseMove:R.onMouseMove,onMouseUp:R.onMouseUp,children:[(0,f.jsx)(r.dL,{matrix:M,children:(0,f.jsx)(x.q,{zIndex:0})}),(0,f.jsxs)(r.dL,{matrix:D,children:[(0,f.jsx)(d.g,{height:n,beats:k,zIndex:1}),(0,f.jsx)(u.b,{x:b,height:n,zIndex:5})]}),(0,f.jsxs)(r.dL,{matrix:O,children:[S.map((e=>(0,f.jsx)(g.l,{trackId:e,zIndex:2},e))),(0,f.jsx)(w.u,{zIndex:3}),(0,f.jsx)(h.L,{rect:C,zIndex:4})]})]}),(0,f.jsx)(m.E,{...T})]})}))},97468:(e,t,n)=>{n.d(t,{G:()=>r});var o=n(47547);const r=e=>new o.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n\n      in vec4 position;\n      in vec4 bounds;  // [x, y, width, height]\n      in vec2 state; // [velocity, isSelected]\n\n      out vec4 vBounds;\n      out vec2 vPosition;\n      out vec2 vState;\n\n      void main() {\n        vec4 transformedPosition = vec4((position.xy * bounds.zw + bounds.xy), position.zw);\n        gl_Position = projectionMatrix * transformedPosition;\n        vBounds = bounds;\n        vPosition = transformedPosition.xy;\n        vState = state;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 strokeColor;\n      uniform vec4 selectedColor;\n      uniform vec4 inactiveColor;\n      uniform vec4 activeColor;\n\n      in vec4 vBounds;\n      in vec2 vPosition;\n      in vec2 vState;\n\n      out vec4 outColor;\n\n      void main() {\n        float border = 1.0;\n        \n        float r = vBounds.w / 2.0;\n        vec2 center = vBounds.xy + vBounds.zw / 2.0;\n        float len = length(vPosition - center);\n\n        if (len < r - border) {\n          // if selected, draw selected color\n          // otherwise, draw color based on velocity by mixing active and inactive color\n          outColor = mix(mix(inactiveColor, activeColor, vState.x), selectedColor, vState.y);\n        } else if (len < r) {\n          outColor = strokeColor;\n        }\n      }\n    ",{position:{size:2,type:e.FLOAT},bounds:{size:4,type:e.FLOAT,divisor:1},state:{size:2,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,o.z$)(),strokeColor:(0,o.fz)(),inactiveColor:(0,o.fz)(),activeColor:(0,o.fz)(),selectedColor:(0,o.fz)()})},46128:(e,t,n)=>{n.d(t,{L:()=>i,e:()=>l});var o=n(47547),r=n(18264),s=n.n(r);class i{constructor(e){this.vertexArray=e}update(e){const t=(0,o.pl)(e);this.vertexArray.updateBuffer("position",new Float32Array(t))}get vertexCount(){return 6}}const l=e=>new o.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n      in vec4 position;\n      out vec4 vPosition;\n\n      void main() {\n        gl_Position = projectionMatrix * position;\n        vPosition = position;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 color;\n      uniform vec4 highlightedColor;\n      uniform vec4 laneColors[12];\n      uniform float height;\n      \n      in vec4 vPosition;\n\n      out vec4 outColor;\n      \n      void main() {\n        float screenHeight = height * 128.0;\n        float modY = mod(screenHeight - vPosition.y, height * 12.0);\n        float lineWidth = 1.0;\n\n        if (modY < height - lineWidth) {\n          outColor = laneColors[0];\n        } else if (modY < height) {\n          outColor = color;\n        } else if (modY < height * 2.0 - lineWidth) {\n          outColor = laneColors[1];\n        } else if (modY < height * 2.0) {\n          outColor = color;\n        } else if (modY < height * 3.0 - lineWidth) {\n          outColor = laneColors[2];\n        } else if (modY < height * 3.0) {\n          outColor = color;\n        } else if (modY < height * 4.0 - lineWidth) {\n          outColor = laneColors[3];\n        } else if (modY < height * 4.0) {\n          outColor = color;\n        } else if (modY < height * 5.0 - lineWidth) {\n          outColor = laneColors[4];\n        } else if (modY < height * 5.0) {\n          outColor = color;\n        } else if (modY < height * 6.0 - lineWidth) {\n          outColor = laneColors[5];\n        } else if (modY < height * 6.0) {\n          outColor = color;\n        } else if (modY < height * 7.0 - lineWidth) {\n          outColor = laneColors[6];\n        } else if (modY < height * 7.0) {\n          outColor = color;\n        } else if (modY < height * 8.0 - lineWidth) {\n          outColor = laneColors[7];\n        } else if (modY < height * 8.0) {\n          outColor = color;\n        } else if (modY < height * 9.0 - lineWidth) {\n          outColor = laneColors[8];\n        } else if (modY < height * 9.0) {\n          outColor = color;\n        } else if (modY < height * 10.0 - lineWidth) {\n          outColor = laneColors[9];\n        } else if (modY < height * 10.0) {\n          outColor = color;\n        } else if (modY < height * 11.0 - lineWidth) {\n          outColor = laneColors[10];\n        } else if (modY < height * 11.0) {\n          outColor = color;\n        } else if (modY < height * 12.0 - lineWidth) {\n          outColor = laneColors[11];\n        } else if (modY < height * 12.0) {\n          outColor = highlightedColor;\n        }\n      }\n    ",{position:{size:2,type:e.FLOAT}},{projectionMatrix:(0,o.z$)(),color:(0,o.fz)(),highlightedColor:(0,o.fz)(),laneColors:{initialValue:new Float32Array(48),isEqual:s(),upload:(e,t,n)=>e.uniform4fv(t,n,0,48)},height:(0,o.Z7)()})},89436:(e,t,n)=>{n.d(t,{K:()=>s,r:()=>r});var o=n(47547);class r{_instanceCount=0;boundsBuffer=(()=>new Float32Array(0))();stateBuffer=(()=>new Float32Array(0))();constructor(e){this.vertexArray=e,this.vertexArray.updateBuffer("position",new Float32Array((0,o.pl)({x:0,y:0,width:1,height:1})))}update(e){(this.boundsBuffer.length<4*e.length||this.stateBuffer.length<3*e.length)&&(this.boundsBuffer=new Float32Array(4*e.length),this.stateBuffer=new Float32Array(3*e.length));for(let t=0;t<e.length;t++){const n=e[t];this.boundsBuffer[4*t+0]=n.x,this.boundsBuffer[4*t+1]=n.y,this.boundsBuffer[4*t+2]=n.width,this.boundsBuffer[4*t+3]=n.height,this.stateBuffer[3*t+0]=126===n.velocity?.99:n.velocity/127,this.stateBuffer[3*t+1]=n.isSelected?1:0,this.stateBuffer[3*t+2]=n.colorId}this.vertexArray.updateBuffer("bounds",this.boundsBuffer.subarray(0,4*e.length)),this.vertexArray.updateBuffer("state",this.stateBuffer.subarray(0,3*e.length)),this._instanceCount=e.length}get vertexCount(){return 6}get instanceCount(){return this._instanceCount}}const s=e=>new o.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n\n      in vec4 position;\n      in vec4 bounds;  // [x, y, width, height]\n      in vec3 state; // [velocity, isSelected, colorId]\n\n      out vec4 vBounds;\n      out vec2 vPosition;\n      out vec3 vState;\n\n      void main() {\n        vec4 transformedPosition = vec4((position.xy * bounds.zw + bounds.xy), position.zw);\n        gl_Position = projectionMatrix * transformedPosition;\n        vBounds = bounds;\n        vPosition = transformedPosition.xy;\n        vState = state;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 strokeColor;\n      uniform vec4 selectedColor;\n      uniform vec4 inactiveColor;\n      uniform vec4 activeColor;\n\n      in vec4 vBounds;\n      in vec2 vPosition;\n      in vec3 vState;\n\n      out vec4 outColor;\n\n      void main() {\n        float border = 1.0;\n        float localX = vPosition.x - vBounds.x;\n        float localY = vPosition.y - vBounds.y;\n\n        float outlineTop = step(border, localY);\n        float outlineBottom = step(localY, vBounds.w - border);\n        float outlineLeft = step(border, localX);\n        float outlineRight = step(localX, vBounds.z - border);\n        \n        float isOutline = outlineTop * outlineBottom * outlineLeft * outlineRight;\n\n        vec4 myColor = activeColor;\n\n        if (vState.z >= 1.0) {\n          myColor = vec4(1.0, 0.0, 0.0, 1.0);\n        }\n          \n        if (vState.z >= 2.0) {\n          myColor = vec4(0.0, 0.0, 1.0, 1.0);\n        } \n          \n        if (vState.z >= 3.0) {\n          myColor = vec4(0.5, 0.0, 0.5, 1.0);\n        }\n        \n        outColor = strokeColor;\n        outColor = selectedColor;\n        \n        if (isOutline < 1.0) {\n          // draw outline\n          outColor = myColor;\n        } else {\n          // if selected, draw selected color\n          // otherwise, draw color based on velocity by mixing active and inactive color\n          outColor = mix(inactiveColor, myColor, vState.x);\n        }\n\n\n        if (vState.x == 0.99) {\n          outColor = vec4(0.3, 0.2, 0.2, 0.5);\n          //stripes\n          if (int(vPosition.x) % 4 == 0) {\n            outColor = mix(outColor, vec4(1.0, 1.0, 1.0, 1.0), 0.1);\n          }\n\n        }\n\n        if (isOutline < 1.0) {\n          outColor = myColor;\n        }\n\n        if (isOutline < 1.0 && vState.y >= 1.0) {\n         outColor = vec4(1.0, 1.0, 1.0, 1.0);\n        }\n\n\n\n\n      }\n    ",{position:{size:2,type:e.FLOAT},bounds:{size:4,type:e.FLOAT,divisor:1},state:{size:3,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,o.z$)(),strokeColor:(0,o.fz)(),inactiveColor:(0,o.fz)(),activeColor:(0,o.fz)(),selectedColor:(0,o.fz)()})},84574:(e,t,n)=>{n.d(t,{m:()=>w});var o=n(46287),r=n(69229),s=n(59061),i=n(55782),l=n(73853),a=n(14557),c=n(19069),d=n(7101),u=n(47953),h=n(72993),p=n(29966),m=n(62540);const g=(0,o.A)("div",{target:"ez7p9kn0"})({name:"z5atxi",styles:"display:flex;flex-direction:column;flex-grow:1"}),x=e=>{let{isShow:t,pane:n,children:o,...r}=e;return t?(0,m.jsxs)(p.W,{...r,children:[n,o]}):(0,m.jsx)(m.Fragment,{children:o})},w=(0,r.PA)((()=>{const{pianoRollStore:e}=(0,s.g)(),{showTrackList:t,showEventList:n}=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(g,{children:[(0,m.jsx)(l.y,{}),(0,m.jsx)(a.c,{}),(0,m.jsx)("div",{style:{display:"flex",flexGrow:1,position:"relative"},children:(0,m.jsx)(x,{split:"vertical",minSize:280,pane1Style:{display:"flex"},pane2Style:{display:"flex"},isShow:t,pane:(0,m.jsx)(c.S,{}),children:(0,m.jsx)(x,{split:"vertical",minSize:240,pane1Style:{display:"flex"},pane2Style:{display:"flex"},isShow:n,pane:(0,m.jsx)(i.Ay,{}),children:(0,m.jsx)(h.A,{})})})})]}),(0,m.jsx)(d.w,{}),(0,m.jsx)(u.G,{})]})}))},4487:(e,t,n)=>{n.d(t,{d:()=>x});var o=n(46287),r=n(83785),s=n(69229),i=n(92770),l=n(59061),a=n(75710),c=n(57112),d=n(55930),u=n(62540);const h=(0,o.A)("div",{target:"eozgfpb3"})(""),p=(0,o.A)("div",{target:"eozgfpb2"})("position:absolute;left:",i.PE.keyWidth,"px;"),m=(0,o.A)("div",{target:"eozgfpb1"})("position:absolute;top:0;left:0;padding-left:",i.PE.keyWidth,"px;height:",i.PE.rulerHeight,"px;"),g=(0,o.A)("div",{target:"eozgfpb0"})({name:"1m19vma",styles:"position:absolute;left:0;top:0"}),x=(0,s.PA)((e=>{let{width:t,height:n}=e;const{pianoRollStore:o}=(0,l.g)(),{scrollTop:s}=o,x=(0,r.u)();return(0,u.jsxs)(h,{children:[(0,u.jsx)(p,{style:{top:i.PE.rulerHeight},children:(0,u.jsx)(d.F,{width:t,height:n-i.PE.rulerHeight})}),(0,u.jsx)(g,{style:{top:-s+i.PE.rulerHeight},children:(0,u.jsx)(c.y,{})}),(0,u.jsx)(m,{style:{background:x.backgroundColor,borderBottom:`1px solid ${x.dividerColor}`},children:(0,u.jsx)(a.A,{rulerStore:o.rulerStore})})]})}))},86653:(e,t,n)=>{n.d(t,{E:()=>u});var o=n(63696),r=n(50119),s=n(59061),i=n(69673),l=n(97233),a=n(5909),c=n(94724),d=n(62540);const u=o.memo((e=>{const{handleClose:t}=e,{pianoRollStore:n}=(0,s.g)(),o=n.selectedNoteIds.length>0,u=(0,r.ti)(),h=(0,r.Rb)(),p=(0,r.Nl)(),m=(0,r.L$)(),g=(0,r.J1)(),x=(0,r.fm)();return(0,d.jsxs)(a.t,{...e,children:[(0,d.jsxs)(c.Dr,{onClick:()=>{u(),h(),t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"cut"}),(0,d.jsxs)(a.Z,{children:[i.t.cmdOrCtrl,"+X"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{u(),t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"copy"}),(0,d.jsxs)(a.Z,{children:[i.t.cmdOrCtrl,"+C"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{p(),t()},children:[(0,d.jsx)(l.Oj,{name:"paste"}),(0,d.jsxs)(a.Z,{children:[i.t.cmdOrCtrl,"+V"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{m(),t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"duplicate"}),(0,d.jsxs)(a.Z,{children:[i.t.cmdOrCtrl,"+D"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{h(),t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"delete"}),(0,d.jsx)(a.Z,{children:"Del"})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:()=>{x(12),t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"one-octave-up"}),(0,d.jsx)(a.Z,{children:"Shift+"})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{x(-12),t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"one-octave-down"}),(0,d.jsx)(a.Z,{children:"Shift+"})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{n.openTransposeDialog=!0,t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"transpose"}),(0,d.jsx)(a.Z,{children:"T"})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:()=>{g(),t()},disabled:!o,children:[(0,d.jsx)(l.Oj,{name:"quantize"}),(0,d.jsx)(a.Z,{children:"Q"})]}),(0,d.jsx)(c.Dr,{onClick:()=>{n.openVelocityDialog=!0,t()},disabled:!o,children:(0,d.jsx)(l.Oj,{name:"velocity"})})]})}))},24719:(e,t,n)=>{n.d(t,{r:()=>p});var o=n(69229),r=n(63696),s=n(50119),i=n(59061),l=n(69673),a=n(97233),c=n(5909),d=n(94724),u=n(87680),h=n(62540);const p=(0,o.PA)((e=>{let{rulerStore:t,tick:n,...o}=e;const{handleClose:p}=o,{song:m,player:g}=(0,i.g)(),x=(0,s.C4)(),[w,f]=(0,r.useState)(!1),v=t.selectedTimeSignatureEventIds.length>0,y=(0,r.useCallback)((()=>{f(!0),p()}),[]),j=(0,r.useCallback)((()=>{m.conductorTrack?.removeEvents(t.selectedTimeSignatureEventIds),p()}),[m]),k=(0,r.useCallback)((()=>{g.setLoopBegin(n),p()}),[n,g]),b=(0,r.useCallback)((()=>{g.setLoopEnd(n),p()}),[n,g]),C=(0,r.useCallback)((()=>{f(!1)}),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(c.t,{...o,children:[(0,h.jsxs)(d.Dr,{onClick:k,children:[(0,h.jsx)(a.Oj,{name:"set-loop-start"}),(0,h.jsxs)(c.Z,{children:[l.t.cmdOrCtrl,"+Click"]})]}),(0,h.jsxs)(d.Dr,{onClick:b,children:[(0,h.jsx)(a.Oj,{name:"set-loop-end"}),(0,h.jsx)(c.Z,{children:"Alt+Click"})]}),(0,h.jsx)(d.Dr,{onClick:y,children:(0,h.jsx)(a.Oj,{name:"add-time-signature"})}),(0,h.jsx)(d.Dr,{onClick:j,disabled:!v,children:(0,h.jsx)(a.Oj,{name:"remove-time-signature"})})]}),(0,h.jsx)(u.I,{open:w,onClose:C,onClickOK:e=>{let{numerator:t,denominator:o}=e;x(n,t,o)}})]})}))},29966:(e,t,n)=>{n.d(t,{W:()=>s});var o=n(46287),r=n(28465);const s=(0,o.A)(r.A,{target:"eig1oxs0"})({name:"1q9pimx",styles:".Resizer{background:#000;opacity:0.2;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-moz-background-clip:padding;-webkit-background-clip:padding;background-clip:padding-box;}.Resizer:hover{transition:all 0.2s ease;}.Resizer.horizontal{height:11px;margin:-5px 0;border-top:5px solid rgba(255, 255, 255, 0);border-bottom:5px solid rgba(255, 255, 255, 0);cursor:row-resize;width:100%;}.Resizer.horizontal:hover{border-top:5px solid rgba(255, 255, 255, 0.5);border-bottom:5px solid rgba(255, 255, 255, 0.5);}.Resizer.vertical{width:11px;margin:0 -5px;border-left:5px solid rgba(255, 255, 255, 0);border-right:5px solid rgba(255, 255, 255, 0);cursor:col-resize;}.Resizer.vertical:hover{border-left:5px solid rgba(255, 255, 255, 0.5);border-right:5px solid rgba(255, 255, 255, 0.5);}.Resizer.disabled{cursor:not-allowed;}.Resizer.disabled:hover{border-color:transparent;}"})},87680:(e,t,n)=>{n.d(t,{I:()=>p});var o=n(46287),r=n(17243),s=n(63696),i=n(97233),l=n(66459),a=n(5513),c=n(95881),d=n(4830),u=n(62540);const h=(0,o.A)(d.A,{target:"e1omeeu90"})({name:"3bjnxn",styles:"width:3em;text-align:center;font-size:1rem;padding:0.2rem 0;&::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}"}),p=e=>{let{initialNumerator:t=4,initialDenominator:n=4,open:o,onClose:d,onClickOK:p}=e;const[m,g]=(0,s.useState)(t),[x,w]=(0,s.useState)(n);return(0,s.useEffect)((()=>{o&&(g(t),w(n))}),[o]),(0,u.jsxs)(l.lG,{open:o,onOpenChange:d,children:[(0,u.jsx)(l.L3,{children:(0,u.jsx)(i.Oj,{name:"time-signature"})}),(0,u.jsx)(l.Cf,{children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"stretch",justifyContent:"center"},children:[(0,u.jsx)(h,{value:m,type:"number",min:1,max:32,onChange:e=>g(parseInt(e.target.value)),onBlur:()=>g(Math.max(1,Math.min(32,m))),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur())}}),(0,u.jsx)("span",{style:{width:"3em",display:"flex",alignItems:"center",justifyContent:"center"},children:"/"}),(0,u.jsx)(c.l,{style:{minWidth:"5em"},value:x.toString(),onChange:e=>w(parseInt(e.target.value)),children:(0,r.range)(0,6).map((e=>Math.pow(2,e))).map((e=>(0,u.jsx)("option",{value:e.toString(),children:e},e)))})]})}),(0,u.jsxs)(l.ii,{children:[(0,u.jsx)(a.$,{autoFocus:!0,onClick:d,children:(0,u.jsx)(i.Oj,{name:"cancel"})}),(0,u.jsx)(a.j,{onClick:()=>{p({numerator:m,denominator:x}),d()},disabled:isNaN(m)&&m<=32&&m>0,children:(0,u.jsx)(i.Oj,{name:"ok"})})]})]})}},29869:(e,t,n)=>{n.d(t,{m:()=>f});var o=n(46287),r=n(83785),s=n(20994),i=n(22399),l=n.n(i),a=n(69229),c=n(63696),d=n(11735),u=n(59061),h=n(97233),p=n(66459),m=n(55747),g=n(5513),x=n(87944),w=n(62540);const f=(0,a.PA)((()=>{const{songStore:e,rootViewStore:t,cloudSongRepository:n,userRepository:o}=(0,u.g)(),{song:i}=e,a=(0,d.GB)(),f=(0,d.JN)(),{openPublishDialog:k}=t,[b,C]=(0,c.useState)("notPublishable"),[S,R]=(0,c.useState)(!0),A=(0,s.dj)(),T=(0,r.u)(),E=(0,h.B2)();(0,c.useEffect)((()=>{(async()=>{if(k){R(!0);const t=e.song.cloudSongId;if(null===t)return C("notPublishable"),void R(!1);const o=await n.get(t);C(o?.isPublic?"published":"publishable"),R(!1)}})()}),[k]);const I=(0,c.useCallback)((()=>t.openPublishDialog=!1),[t]);return(0,w.jsxs)(p.lG,{open:k,onOpenChange:I,style:{minWidth:"20rem"},children:[(0,w.jsx)(p.L3,{children:(0,w.jsx)(h.Oj,{name:"publish-song"})}),(0,w.jsxs)(p.Cf,{children:["publishable"===b&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:{marginBottom:"1rem"},children:(0,w.jsx)(h.Oj,{name:"publish-notice"})}),(0,w.jsx)(m.F,{severity:"warning",children:(0,w.jsx)(h.Oj,{name:"publish-rules"})})]}),"published"===b&&null!==i.cloudSongId&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(v,{href:j(i.cloudSongId),target:"_blank",children:[(0,w.jsx)(h.Oj,{name:"published-notice"}),(0,w.jsx)(l(),{color:T.secondaryTextColor,size:"1rem"})]}),(0,w.jsx)(x.C,{url:j(i.cloudSongId),text:E["share-my-song-text"]}),(0,w.jsx)(y,{})]})]}),(0,w.jsxs)(p.ii,{children:[(0,w.jsx)(g.$,{onClick:I,children:(0,w.jsx)(h.Oj,{name:"close"})}),"publishable"===b&&(0,w.jsx)(g.j,{onClick:async()=>{const{song:t}=e;try{R(!0);const e=await o.getCurrentUser();if(null===e)throw new Error("Failed to get current user, please re-sign in");await a(t,e),C("published"),A.success(E["song-published"])}catch(e){A.error(e.message)}finally{R(!1)}},disabled:S,children:(0,w.jsx)(h.Oj,{name:"publish"})}),"published"===b&&(0,w.jsx)(g.j,{onClick:async()=>{const{song:t}=e;try{R(!0),await f(t),C("publishable"),A.success(E["song-unpublished"])}catch(e){A.error(e.message)}finally{R(!1)}},disabled:S,children:(0,w.jsx)(h.Oj,{name:"unpublish"})})]})]})})),v=(0,o.A)("a",{target:"eqqftdk1"})("display:flex;align-items:center;color:",(e=>{let{theme:t}=e;return t.textColor}),";text-decoration:none;margin-bottom:1rem;&:hover{opacity:0.8;}"),y=(0,o.A)("div",{target:"eqqftdk0"})("margin:1rem 0 0 0;height:1px;background:",(e=>{let{theme:t}=e;return t.dividerColor}),";"),j=e=>`${window.location.origin}/songs/${e}`},93731:(e,t,n)=>{n.d(t,{w:()=>h});var o=n(46287),r=n(69229),s=n(63696),i=n(50119),l=n(13917),a=n(59061),c=n(97233),d=n(62540);const u=(0,o.A)("div",{target:"e1gahe2s0"})({name:"vhyimk",styles:"height:100%;display:flex;flex-direction:column;flex-grow:1;overflow:hidden"}),h=(0,r.PA)((e=>{let{children:t}=e;const{song:n}=(0,a.g)(),o=(0,c.B2)(),r=(0,i.pC)(),h=(0,s.useCallback)((e=>{e.preventDefault()}),[]),p=(0,s.useCallback)((async e=>{e.preventDefault();const t=e.dataTransfer.files[0];if(("audio/midi"===t.type||"audio/mid"===t.type)&&(n.isSaved||confirm(o["confirm-open"]))){const e=await(0,l.mZ)(t);r(e)}}),[n,r]);return(0,d.jsx)(u,{onDrop:p,onDragOver:h,children:t})}))},59797:(e,t,n)=>{n.d(t,{K:()=>E});var o=n(46287),r=n(69229),s=n(59061),i=n(22573),l=n(18976),a=n(73245),c=n(94025),d=n(74390),u=n(35679),h=n(10713),p=n(77303),m=n(14461),g=n(61229),x=n(84574),w=n(29869),f=n(43017),v=n(12163),y=n(48930),j=n(82733),k=n(36079),b=n(71323),C=n(93731),S=n(62540);const R=(0,o.A)("div",{target:"e15sz86a1"})({name:"vhyimk",styles:"height:100%;display:flex;flex-direction:column;flex-grow:1;overflow:hidden"}),A=(0,o.A)("div",{target:"e15sz86a0"})({name:"1mxf4fi",styles:"height:100%;display:flex;flex-grow:1;flex-direction:column"}),T=(0,r.PA)((()=>{const{router:e}=(0,s.g)(),t=e.path;return(0,S.jsxs)(S.Fragment,{children:["/track"===t&&(0,S.jsx)(x.m,{}),"/tempo"===t&&(0,S.jsx)(y.t,{}),"/arrange"===t&&(0,S.jsx)(i.y,{})]})})),E=()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(C.w,{children:(0,S.jsxs)(A,{children:[(0,S.jsx)(p.Vx,{}),(0,S.jsxs)(R,{children:[(0,S.jsx)(T,{}),(0,S.jsx)(j.Cg,{}),(0,S.jsx)(l.j,{})]})]})}),(0,S.jsx)(h.Q,{}),(0,S.jsx)(d.u,{}),(0,S.jsx)(u.p,{}),(0,S.jsx)(v.L,{}),(0,S.jsx)(a.Y,{}),(0,S.jsx)(f.F,{}),(0,S.jsx)(c.K,{}),(0,S.jsx)(g.c,{}),(0,S.jsx)(m.I,{}),(0,S.jsx)(w.m,{}),(0,S.jsx)(b.D,{}),(0,S.jsx)(k.r,{})]})},22333:(e,t,n)=>{n.d(t,{z:()=>x});var o=n(46287),r=n(69229),s=n(59061),i=n(97233),l=n(56416),a=n(11051),c=n(66459),d=n(15467),u=n(95881),h=n(62540);const p=(0,r.PA)((()=>{const{settingStore:e}=(0,s.g)(),t=(0,i.f4)();return(0,h.jsxs)(d.J,{children:[(0,h.jsx)(i.Oj,{name:"language"}),(0,h.jsx)(u.l,{value:e.language??t,onChange:t=>e.language=t.target.value,style:{marginTop:"0.5rem"},children:[{label:"English",language:"en"},{label:"French",language:"fr"},{label:"Japanese",language:"ja"},{label:"Chinese (Simplified)",language:"zh-Hans"},{label:"Chinese (Traditional)",language:"zh-Hant"}].map((e=>(0,h.jsx)("option",{value:e.language,children:e.label},e.language)))})]})})),m=(0,r.PA)((()=>{const{themeStore:e}=(0,s.g)(),{themeType:t}=e;return(0,h.jsxs)(d.J,{children:[(0,h.jsx)(i.Oj,{name:"theme"}),(0,h.jsx)(u.l,{value:t,onChange:t=>e.themeType=t.target.value,style:{marginTop:"0.5rem"},children:Object.keys(l.Z).map((e=>(0,h.jsx)("option",{value:e,children:(0,h.jsx)(a.V,{themeType:e})},e)))})]})})),g=(0,o.A)("div",{target:"e1ngx2at0"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"}),x=(0,r.PA)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.L3,{children:(0,h.jsx)(i.Oj,{name:"general"})}),(0,h.jsx)(c.Cf,{children:(0,h.jsxs)(g,{children:[(0,h.jsx)(p,{}),(0,h.jsx)(m,{})]})})]})))},95090:(e,t,n)=>{n.d(t,{h:()=>f});var o=n(46287),r=n(69229),s=n(59061),i=n(97233),l=n(66459),a=n(55747),c=n(16066),d=n(571),u=n(15467),h=n(62540);const p=e=>{let{device:t,isSelected:n,onCheck:o}=e;return(0,h.jsx)(u.J,{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:(0,h.jsx)(c.S,{checked:n,onCheckedChange:e=>o(!0===e),style:{marginRight:"0.5rem"},label:(0,h.jsxs)(h.Fragment,{children:[t.name,!t.isConnected&&" (disconnected)"]})})})},m=(0,o.A)("div",{target:"e1a3jnrs3"})(""),g=(0,o.A)("div",{target:"e1a3jnrs2"})("color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),x=(0,o.A)("div",{target:"e1a3jnrs1"})({name:"hw7i2k",styles:"height:2rem"}),w=(0,o.A)("div",{target:"e1a3jnrs0"})({name:"1w6g3jg",styles:"font-weight:bold;margin:1rem 0"}),f=(0,r.PA)((()=>{const{midiDeviceStore:e}=(0,s.g)(),{inputs:t,outputs:n,isLoading:o,requestError:r,enabledInputs:c,enabledOutputs:u,isFactorySoundEnabled:f}=e,v=e=>(e?.name??"")+((e.manufacturer?.length??0)>0?`(${e.manufacturer})`:""),y=e=>({id:e.id,name:v(e),isConnected:"connected"===e.state}),j=t.map((e=>({device:y(e),isSelected:c[e.id]}))),k=n.map((e=>({device:y(e),isSelected:u[e.id]})));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(l.L3,{children:(0,h.jsx)(i.Oj,{name:"midi-settings"})}),(0,h.jsxs)(l.Cf,{children:[o&&(0,h.jsx)(d.P,{}),r&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(a.F,{severity:"warning",children:r.message}),(0,h.jsx)(x,{})]}),!o&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(w,{children:(0,h.jsx)(i.Oj,{name:"inputs"})}),(0,h.jsxs)(m,{children:[0===j.length&&(0,h.jsx)(g,{children:(0,h.jsx)(i.Oj,{name:"no-inputs"})}),j.map((t=>{let{device:n,isSelected:o}=t;return(0,h.jsx)(p,{device:n,isSelected:o,onCheck:t=>e.setInputEnable(n.id,t)},n.id)}))]}),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x,{}),(0,h.jsx)(w,{children:(0,h.jsx)(i.Oj,{name:"outputs"})}),(0,h.jsxs)(m,{children:[(0,h.jsx)(p,{device:{id:"signal-midi-app",name:"Signal Factory Sound",isConnected:!0},isSelected:f,onCheck:t=>e.isFactorySoundEnabled=t}),k.map((t=>{let{device:n,isSelected:o}=t;return(0,h.jsx)(p,{device:n,isSelected:o,onCheck:t=>e.setOutputEnable(n.id,t)},n.id)}))]})]})]})]})]})}))},43017:(e,t,n)=>{n.d(t,{F:()=>w});var o=n(46287),r=n(69229),s=n(63696),i=n(59061),l=n(97233),a=n(66459),c=n(5513),d=n(22333),u=n(95090),h=n(85539),p=n(156),m=n(62540);const g=e=>{let{route:t}=e;switch(t){case"general":return(0,m.jsx)(d.z,{});case"midi":return(0,m.jsx)(u.h,{});case"soundfont":return(0,m.jsx)(p.H,{})}},x=(0,o.A)("div",{target:"e2pvsme0"})({name:"1bed697",styles:"flex-grow:1;min-height:24rem"}),w=(0,r.PA)((()=>{const{rootViewStore:e}=(0,i.g)(),{openSettingDialog:t}=e,[n,o]=(0,s.useState)("general"),r=(0,s.useCallback)((()=>e.openSettingDialog=!1),[e]);return(0,m.jsxs)(a.lG,{open:t,onOpenChange:r,style:{minWidth:"32rem"},children:[(0,m.jsx)(a.L3,{children:(0,m.jsx)(l.Oj,{name:"settings"})}),(0,m.jsxs)(a.Cf,{style:{display:"flex",flexDirection:"row"},children:[(0,m.jsx)(h.V,{route:n,onChange:o}),(0,m.jsx)(x,{children:(0,m.jsx)(g,{route:n})})]}),(0,m.jsx)(a.ii,{children:(0,m.jsx)(c.$,{onClick:r,children:(0,m.jsx)(l.Oj,{name:"close"})})})]})}))},85539:(e,t,n)=>{n.d(t,{V:()=>u});var o=n(46287),r=n(97233),s=n(5513),i=n(62540);const l=["general","midi","soundfont"],a=(0,o.A)(s.$,{target:"e1c2xddn1"})("display:flex;font-size:0.875rem;align-items:center;margin-bottom:0.5rem;background:",(e=>{let{theme:t,selected:n}=e;return n?t.highlightColor:"inherit"}),";"),c=(0,o.A)("div",{target:"e1c2xddn0"})({name:"e3t188",styles:"display:flex;flex-direction:column;min-width:12em;margin-right:2rem"}),d=e=>{let{route:t}=e;switch(t){case"general":return(0,i.jsx)(r.Oj,{name:"general"});case"midi":return(0,i.jsx)(r.Oj,{name:"midi"});case"soundfont":return(0,i.jsx)(r.Oj,{name:"soundfont"})}},u=e=>{let{route:t,onChange:n}=e;return(0,i.jsx)(c,{children:l.map((e=>(0,i.jsx)(a,{selected:t===e,onClick:()=>n(e),children:(0,i.jsx)(d,{route:e},e)},e)))})}},63667:(e,t,n)=>{n.d(t,{F:()=>f});var o=n(46287),r=n(44308),s=n.n(r),i=n(20994),l=n(40756),a=n.n(l),c=n(69229),d=n(63696),u=n(59061),h=n(5513),p=n(571),m=n(70612),g=n(62540);const x=(0,o.A)("div",{target:"e16rc1t13"})({name:"1c1nme9",styles:"display:flex;flex-direction:column;margin-bottom:1rem;overflow-y:auto"}),w=(0,o.A)("div",{target:"e16rc1t12"})("position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0;background-color:",(e=>{let{theme:t}=e;return s()(t.backgroundColor).alpha(.5).toString()}),";color:",(e=>{let{theme:t}=e;return t.textColor}),";width:100%;height:100%;z-index:1;"),f=(0,c.PA)((()=>{const{soundFontStore:e}=(0,u.g)(),{files:t,selectedSoundFontId:n}=e,[o,r]=(0,d.useState)(!1),s=(0,i.dj)();return(0,g.jsxs)(x,{children:[t.map((t=>(0,g.jsx)(j,{isSelected:t.id===n,item:t,onClick:async()=>{r(!0);try{await e.load(t.id)}catch(e){s.error(e.message)}finally{r(!1)}},onClickDelete:async()=>{await e.removeSoundFont(t.id)}},t.id))),o&&(0,g.jsx)(w,{children:(0,g.jsx)(p.P,{})})]})})),v=(0,o.A)(a(),{target:"e16rc1t11"})("width:1rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),y=(0,o.A)("div",{target:"e16rc1t10"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),j=e=>{let{item:t,isSelected:n,onClick:o,onClickDelete:r}=e;return(0,g.jsxs)(y,{children:[(0,g.jsx)(m.a,{label:t.name,isSelected:n,onClick:o}),t.id>=0&&(0,g.jsx)(h.$,{style:{marginLeft:"auto",display:"flex",alignItems:"center"},onClick:r,children:(0,g.jsx)(v,{})})]})}},61613:(e,t,n)=>{n.d(t,{r:()=>h});var o=n(46287),r=n(40756),s=n.n(r),i=n(69229),l=n(59061),a=n(97233),c=n(5513),d=n(62540);const u=(0,o.A)("div",{target:"e1vg3g243"})({name:"g78t84",styles:"display:flex;justify-content:flex-end;margin-top:1rem"}),h=(0,i.PA)((()=>{const{soundFontStore:e}=(0,l.g)(),{scanPaths:t}=e;return(0,d.jsxs)(d.Fragment,{children:[0===t.length&&(0,d.jsx)("p",{children:(0,d.jsx)("i",{children:"No scan paths"})}),t.map((t=>(0,d.jsx)(x,{path:t,onClickDelete:()=>(async t=>{await e.removeScanPath(t)})(t)},t))),(0,d.jsxs)(u,{children:[(0,d.jsx)(c.$,{onClick:async()=>{const t=await window.electronAPI.showOpenDirectoryDialog();t&&e.addScanPath(t)},children:(0,d.jsx)(a.Oj,{name:"add"})}),(0,d.jsx)(c.$,{onClick:()=>{e.scanSoundFonts()},children:(0,d.jsx)(a.Oj,{name:"scan"})})]})]})})),p=(0,o.A)("span",{target:"e1vg3g242"})("font-size:0.8rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),m=(0,o.A)(s(),{target:"e1vg3g241"})("width:1rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),g=(0,o.A)("div",{target:"e1vg3g240"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),x=e=>{let{path:t,onClickDelete:n}=e;return(0,d.jsxs)(g,{children:[(0,d.jsx)(p,{children:t}),(0,d.jsx)(c.$,{style:{marginLeft:"auto",display:"flex",alignItems:"center"},onClick:n,children:(0,d.jsx)(m,{})})]})}},156:(e,t,n)=>{n.d(t,{H:()=>w});var o=n(46287),r=n(69229),s=n(92234),i=n(59061),l=n(97233),a=n(66459),c=n(29279),d=n(55747),u=n(5513),h=n(63667),p=n(61613),m=n(62540);const g=(0,o.A)(u.$,{target:"e10018hp1"})({name:"8irbms",styles:"display:inline-flex;align-items:center"}),x=(0,o.A)("div",{target:"e10018hp0"})({name:"1w6g3jg",styles:"font-weight:bold;margin:1rem 0"}),w=(0,r.PA)((()=>{const{soundFontStore:e}=(0,i.g)();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.L3,{children:(0,m.jsx)(l.Oj,{name:"soundfont"})}),(0,m.jsxs)(a.Cf,{children:[(0,m.jsx)(h.F,{}),!(0,s.r)()&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.z,{onChange:async t=>{t.preventDefault();const n=t.currentTarget.files?.item(0);if(n){const t=await n.arrayBuffer();e.addSoundFont({type:"local",data:t},{name:n.name})}},accept:".sf2",children:(0,m.jsx)(g,{as:"div",children:(0,m.jsx)(l.Oj,{name:"add"})})}),(0,m.jsx)(d.F,{severity:"info",style:{marginTop:"1rem"},children:(0,m.jsx)(l.Oj,{name:"soundfont-save-notice"})})]}),(0,s.r)()&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(x,{children:(0,m.jsx)(l.Oj,{name:"soundfont-location"})}),(0,m.jsx)(p.r,{})]})]})]})}))},12163:(e,t,n)=>{n.d(t,{L:()=>d});var o=n(20994),r=n(69229),s=n(63696),i=n(59061),l=n(97233),a=n(51348),c=n(62540);const d=(0,r.PA)((()=>{const{rootViewStore:e,rootViewStore:{openSignInDialog:t}}=(0,i.g)(),n=(0,o.dj)(),r=(0,l.B2)(),d=(0,s.useCallback)((()=>e.openSignInDialog=!1),[e]);return(0,c.jsx)(a.w,{open:t,onClose:d,onSuccess:async()=>{e.openSignInDialog=!1,n.success(r["success-sign-in"])},onFailure:e=>{console.warn(e)}})}))},51348:(e,t,n)=>{n.d(t,{w:()=>m});var o=n(46287),r=n(73016),s=n(66459),i=n(17354),l=n(52932),a=n(97233),c=n(55747),d=n(5513),u=n(62540);const h=(0,o.A)("span",{target:"e1p5rn1h1"})("border:1px solid currentColor;font-size:0.8rem;padding:0.1rem 0.4rem;margin-left:1em;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),p=(0,o.A)("div",{target:"e1p5rn1h0"})({name:"1jfrm3v",styles:"margin:1rem 0 2rem 0;line-height:1.5"}),m=e=>{let{open:t,onClose:n,onSuccess:o,onFailure:m}=e;return(0,u.jsxs)(s.lG,{open:t,onOpenChange:n,style:{minWidth:"20rem"},children:[(0,u.jsxs)(s.L3,{children:[(0,u.jsx)(a.Oj,{name:"sign-in"}),(0,u.jsx)(h,{children:"Beta"})]}),(0,u.jsxs)(s.Cf,{children:[(0,u.jsx)(c.F,{severity:"info",children:(0,u.jsx)(a.Oj,{name:"cloud-beta-warning"})}),(0,u.jsx)(p,{children:(0,u.jsx)(a.Oj,{name:"cloud-description"})}),(0,u.jsx)(r.l,{uiConfig:{signInOptions:[i.HF.PROVIDER_ID,i.Dt.PROVIDER_ID,"apple.com"],callbacks:{signInSuccessWithAuthResult:()=>(o(),!1),signInFailure:m},signInFlow:"popup"},firebaseAuth:l.j2})]}),(0,u.jsx)(s.ii,{children:(0,u.jsx)(d.$,{onClick:n,children:(0,u.jsx)(a.Oj,{name:"close"})})})]})}},29340:(e,t,n)=>{n.d(t,{m:()=>l});var o=n(69229),r=n(59061),s=n(76600),i=n(62540);const l=(0,o.PA)((()=>{const{tempoEditorStore:e}=(0,r.g)(),{autoScroll:t}=e;return(0,i.jsx)(s.X,{onClick:()=>e.autoScroll=!t,selected:t})}))},6368:(e,t,n)=>{n.d(t,{o:()=>a});var o=n(69229),r=n(63696),s=n(59061),i=n(16051),l=n(62540);const a=(0,o.PA)((()=>{const{tempoEditorStore:e}=(0,s.g)(),{quantize:t,isQuantizeEnabled:n}=e,o=(0,r.useCallback)((t=>e.quantize=t),[e]),a=(0,r.useCallback)((()=>{e.isQuantizeEnabled=!e.isQuantizeEnabled}),[e]);return(0,l.jsx)(i.A,{value:t,enabled:n,onSelect:o,onClickSwitch:a})}))},91711:(e,t,n)=>{n.d(t,{f:()=>a});var o=n(69229),r=n(63696),s=n(59061),i=n(16139),l=n(62540);const a=(0,o.PA)((()=>{const{tempoEditorStore:e}=(0,s.g)(),{mouseMode:t}=e;return(0,l.jsx)(i.y,{mouseMode:t,onSelect:(0,r.useCallback)((t=>e.mouseMode=t),[])})}))},87553:(e,t,n)=>{n.d(t,{D:()=>h});var o=n(46287),r=n(97233),s=n(99677),i=n(29340),l=n(6368),a=n(91711),c=n(62540);const d=(0,o.A)("span",{target:"e1npb7n01"})({name:"6egrdb",styles:"font-weight:bold;margin-right:2em;font-size:1rem;margin-left:0.5rem"}),u=(0,o.A)("div",{target:"e1npb7n00"})({name:"1ff36h2",styles:"flex-grow:1"}),h=()=>(0,c.jsxs)(s.M,{children:[(0,c.jsx)(d,{children:(0,c.jsx)(r.Oj,{name:"tempo"})}),(0,c.jsx)(u,{}),(0,c.jsx)(a.f,{}),(0,c.jsx)(l.o,{}),(0,c.jsx)(i.m,{})]})},12066:(e,t,n)=>{n.d(t,{r:()=>d});var o=n(51382),r=n(71229),s=n(51046),i=n(12968),l=n(54015),a=n(59061),c=n(22095);const d=()=>{const{song:{conductorTrack:e},tempoEditorStore:t}=(0,a.g)();return{onMouseDown(n,a,d){if(void 0===e)return;const u=d.fromPosition(a),h=(0,i.i)(n);t.selectedEventIds=[],t.selection={fromTick:u.tick,toTick:u.tick},(0,l.b)({onMouseMove:e=>{const n=(0,i.i)(e),r=o.b.sub(n,h),s=o.b.add(a,r),l=d.fromPosition(s);t.selection={fromTick:Math.min(u.tick,l.tick),toTick:Math.max(u.tick,l.tick)}},onMouseUp:()=>{const{selection:n}=t;null!==n&&(t.selectedEventIds=e.events.filter(c.u3).filter((0,s.F)(r.Q.create(n.fromTick,n.toTick))).map((e=>e.id)),t.selection=null)}})}}}},38604:(e,t,n)=>{n.d(t,{d:()=>d});var o=n(17243),r=n(51382),s=n(20604),i=n(26556),l=n(12968),a=n(54015),c=n(59061);const d=()=>{const{song:{conductorTrack:e},tempoEditorStore:t,tempoEditorStore:{quantizer:n},pushHistory:d}=(0,c.g)();return{onMouseDown(c,u,h,p){if(void 0===e)return;d(),t.selectedEventIds.includes(u)||(t.selectedEventIds=[u]);const m=t.selectedEventIds.map((t=>e.getEventById(t))).filter(s.EA).map((e=>({...e}))),g=m.find((e=>e.id===u));if(void 0===g)return;const x=p.fromPosition(h),w=(0,l.i)(c);(0,a.b)({onMouseMove:t=>{const s=(0,l.i)(t),a=r.b.sub(s,w),c=r.b.add(h,a),d=p.fromPosition(c),u=d.tick-x.tick,f=u-(g.tick+u-n.round(g.tick+u)),v=d.bpm-x.bpm;e.updateEvents(m.map((e=>({id:e.id,tick:Math.max(0,Math.floor(e.tick+f)),microsecondsPerBeat:Math.floor((0,i.w4)((0,o.clamp)((0,i.M)(e.microsecondsPerBeat)+v,0,p.maxBPM)))}))))}})}}}},96911:(e,t,n)=>{n.d(t,{_:()=>u});var o=n(50119),r=n(51382),s=n(26556),i=n(12968),l=n(54015),a=n(59061),c=n(6358),d=n(22095);const u=()=>{const{song:e,tempoEditorStore:{quantizer:t},pushHistory:n}=(0,a.g)();return{onMouseDown(a,u,h){const p=e.conductorTrack;if(void 0===p)return;n();const m=(0,i.i)(a),g=h.fromPosition(u),x=(0,s.w4)(g.bpm),w={...(0,c.F8)(0,Math.round(x)),tick:t.round(g.tick)};p.createOrUpdate(w);let f=g.tick,v=g.bpm;(0,l.b)({onMouseMove:e=>{const n=(0,i.i)(e),l=r.b.sub(n,m),a=r.b.add(u,l),g=Math.max(0,Math.min(h.maxBPM,h.fromPosition(a).bpm)),x=h.getTick(a.x);(0,o.rm)(p,t,d.u3,(e=>(0,c.F8)(0,(0,s.w4)(e))))(v,g,f,x),f=x,v=g}})}}}},48930:(e,t,n)=>{n.d(t,{t:()=>c});var o=n(46287),r=n(64741),s=n(87553),i=n(86589),l=n(62540);const a=(0,o.A)("div",{target:"e1llbi9p0"})({name:"1i1zgvg",styles:"display:flex;flex-direction:column;flex-grow:1;overflow:hidden"}),c=()=>(0,l.jsxs)(a,{children:[(0,l.jsx)(r.g,{}),(0,l.jsx)(s.D,{}),(0,l.jsx)(i._,{})]})},86589:(e,t,n)=>{n.d(t,{_:()=>w});var o=n(46287),r=n(83785),s=n(96604),i=n.n(s),l=n(69229),a=n(63696),c=n(92770),d=n(59061),u=n(75710),h=n(20038),p=n(85766),m=n(41749),g=n(62540);const x=(0,o.A)("div",{target:"e1mroqxo0"})("position:relative;flex-grow:1;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),w=(0,l.PA)((()=>{const{tempoEditorStore:e,tempoEditorStore:{transform:t,scrollLeft:n,contentWidth:o}}=(0,d.g)(),s=(0,a.useRef)(null),l=i()(s),w=(0,a.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[]),f=(0,r.u)(),v=Math.floor(n),y=l.width,j=l.height-c.PE.rulerHeight-h.ZW;return(0,a.useEffect)((()=>{e.canvasWidth=y,e.canvasHeight=j}),[y,j]),(0,g.jsxs)(x,{ref:s,children:[(0,g.jsx)(u.A,{rulerStore:e.rulerStore,style:{background:f.backgroundColor,borderBottom:`1px solid ${f.dividerColor}`,boxSizing:"border-box",position:"absolute",left:c.PE.keyWidth}}),(0,g.jsx)(m.W,{width:y,height:j,style:{position:"absolute",top:c.PE.rulerHeight,left:c.PE.keyWidth,backgroundColor:f.editorBackgroundColor}}),(0,g.jsx)(p.B,{width:c.PE.keyWidth,offset:c.PE.rulerHeight,transform:t}),(0,g.jsx)(h.fJ,{scrollOffset:v,contentLength:o,onScroll:w})]})}))},85766:(e,t,n)=>{n.d(t,{B:()=>c});var o=n(46287),r=n(53649),s=n.n(r),i=n(62540);const l=(0,o.A)("div",{target:"e87wik11"})("position:absolute;left:0;height:100%;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";pointer-events:none;border-right:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";box-shadow:0px 0px 5px 0 rgba(0, 0, 0, 0.1);"),a=(0,o.A)("div",{target:"e87wik10"})({name:"uumi4b",styles:"position:relative;&>div{position:absolute;text-align:right;width:100%;padding-right:1em;box-sizing:border-box;font-size:90%;margin-top:-0.5em;}"}),c=e=>{let{width:t,transform:n,offset:o}=e;return(0,i.jsx)(l,{style:{width:t,top:o},children:(0,i.jsx)(a,{children:s()(30,n.maxBPM,30).map((e=>{const t=Math.round(n.getY(e));return(0,i.jsx)("div",{style:{top:t},children:e},e)}))})})}},46185:(e,t,n)=>{n.d(t,{q:()=>h});var o=n(83785),r=n(47547),s=n(44308),i=n.n(s),l=n(17243),a=n(69229),c=n(72343),d=n(59061),u=n(62540);const h=(0,a.PA)((e=>{let{width:t,zIndex:n}=e;const{tempoEditorStore:{transform:s}}=(0,d.g)(),a=(0,o.u)(),h=(0,l.range)(30,s.maxBPM,30).map((e=>s.getY(e))).map((e=>({x:0,y:e,width:t,height:1}))),p=(0,c.B)(i()(a.dividerColor));return(0,u.jsx)(r.FX,{rects:h,color:p,zIndex:n})}))},41749:(e,t,n)=>{n.d(t,{W:()=>v});var o=n(47547),r=n(69229),s=n(63696),i=n(50119),l=n(26556),a=n(28632),c=n(59061),d=n(51618),u=n(98423),h=n(31563),p=n(12066),m=n(38604),g=n(96911),x=n(46185),w=n(13077),f=n(62540);const v=(0,r.PA)((e=>{let{width:t,height:n,style:r}=e;const{tempoEditorStore:v,tempoEditorStore:{items:y,transform:j,scrollLeft:k,mouseMode:b,rulerStore:{beats:C},cursorX:S,selectionRect:R}}=(0,c.g)(),A=(0,i.Te)(),T=(0,g._)(),E=(0,p.r)(),I=(0,m.d)(),D=Math.floor(k),M=(0,s.useCallback)((e=>({x:e.offsetX+D,y:e.offsetY})),[D]),O=(0,s.useCallback)((e=>y.find((t=>e.x>=t.bounds.x&&e.x<t.bounds.x+t.bounds.width))),[y]),P=(0,s.useCallback)((e=>{0===e.button&&T.onMouseDown(e.nativeEvent,M(e.nativeEvent),j)}),[T,j,D,b]),B=(0,s.useCallback)((e=>{if(0!==e.button)return;const t=M(e.nativeEvent),n=v.hitTest(t);void 0!==n?I.onMouseDown(e.nativeEvent,n,t,j):E.onMouseDown(e.nativeEvent,t,j)}),[I,E,j,D]),N="pencil"===b?P:B,F=(0,s.useCallback)((e=>{const t=M(e.nativeEvent),n=O(t);if(!n)return;const o=y.filter((e=>e.id===n.id))[0],r=e.nativeEvent.deltaY>0?-1:1,s=(0,l.M)(o.microsecondsPerBeat);A(o.id,Math.floor((0,l.w4)(s+r)))}),[y,D,A]),z=(0,s.useMemo)((()=>(0,a.L)(-D,0)),[D]);return(0,f.jsxs)(o.om,{width:t,height:n,onMouseDown:N,onWheel:F,style:r,children:[(0,f.jsx)(x.q,{width:t,zIndex:0}),(0,f.jsxs)(o.dL,{matrix:z,children:[(0,f.jsx)(d.g,{height:n,beats:C,zIndex:1}),(0,f.jsx)(w.w,{width:t,zIndex:2}),(0,f.jsx)(h.L,{rect:R,zIndex:3}),(0,f.jsx)(u.b,{x:S,height:n,zIndex:4})]})]})}))},13077:(e,t,n)=>{n.d(t,{w:()=>l});var o=n(69229),r=n(59061),s=n(8957),i=n(62540);const l=(0,o.PA)((e=>{let{width:t,zIndex:n}=e;const{tempoEditorStore:{items:o,selectedEventIds:l,controlPoints:a,scrollLeft:c}}=(0,r.g)();return(0,i.jsx)(s.B,{width:t,items:o.map((e=>({...e.bounds,id:e.id}))),selectedEventIds:l,controlPoints:a,scrollLeft:c,lineWidth:2,zIndex:n})}))},61885:(e,t,n)=>{n.d(t,{i:()=>r});var o=n(22095);const r=(e,t,n)=>{const r=e.filter(o.u3).sort(((e,t)=>e.tick-t.tick)).map((e=>{const n=6e7/e.microsecondsPerBeat;return{id:e.id,x:Math.round(t.getX(e.tick)),y:Math.round(t.getY(n)),microsecondsPerBeat:e.microsecondsPerBeat}}));return r.map(((e,o)=>{const s=o+1<r.length?r[o+1].x:n;return{id:e.id,bounds:{x:e.x,y:e.y,width:s-e.x,height:t.height-e.y+1},microsecondsPerBeat:e.microsecondsPerBeat}}))}},76600:(e,t,n)=>{n.d(t,{X:()=>u});var o=n(46287),r=n(11484),s=n.n(r),i=n(97233),l=n(96016),a=n(44541),c=n(62540);const d=(0,o.A)(s(),{target:"ephjsd50"})({name:"pcpglt",styles:"width:1.2rem;fill:currentColor"}),u=e=>{let{onClick:t,selected:n}=e;return(0,c.jsx)(l.m,{title:(0,c.jsx)(i.Oj,{name:"auto-scroll"}),children:(0,c.jsx)(a.I,{onMouseDown:e=>{e.preventDefault(),t()},selected:n,children:(0,c.jsx)(d,{})})})}},99064:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(46287),r=n(48390),s=n.n(r),i=n(98919),l=n.n(i),a=n(62540);const c=(0,o.A)("div",{target:"ee1xvp41"})("font-size:150%;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";width:2em;padding:0.25em;text-align:center;"),d=(0,o.A)("div",{target:"ee1xvp40"})("display:flex;flex-direction:column;align-items:center;svg{color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}svg:hover{color:",(e=>{let{theme:t}=e;return t.textColor}),";}"),u=e=>{let{value:t,prevValue:n,nextValue:o,className:r,onChange:i}=e;return(0,a.jsxs)(d,{className:r,children:[(0,a.jsx)("div",{className:"button-up",onClick:()=>i(o()),children:(0,a.jsx)(l(),{})}),(0,a.jsx)(c,{onWheel:function(e){i(e.deltaY<0?n():o())},children:t}),(0,a.jsx)("div",{className:"button-down",onClick:()=>i(n()),children:(0,a.jsx)(s(),{})})]})}},98376:(e,t,n)=>{n.d(t,{y:()=>u});var o=n(46287),r=n(39397),s=n(97233),i=n(16066),l=n(99064),a=n(62540);const c=(0,o.A)("div",{target:"e1n7tkk51"})("background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.popupBorderColor}),";box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),';padding:0.5rem 1rem;border-radius:0.5rem;display:flex;position:relative;top:1rem;left:0.25rem;&::before{content:"";width:1rem;height:1rem;background:',(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";position:absolute;top:-0.5rem;left:calc(50% - 1rem);transform:rotate(45deg);}.button-up{margin-bottom:-0.4rem;}.button-down{margin-top:-0.1rem;}"),d=(0,o.A)("div",{target:"e1n7tkk50"})({name:"1aa3hlf",styles:"display:flex;flex-direction:column;justify-content:center;margin-left:1rem"});function u(e){let{value:t=8,values:n,triplet:o,dotted:u,onChangeValue:h,onChangeTriplet:p,onChangeDotted:m,trigger:g}=e;return(0,a.jsxs)(r.bL,{children:[(0,a.jsx)(r.l9,{asChild:!0,children:g}),(0,a.jsx)(r.ZL,{children:(0,a.jsx)(r.UC,{children:(0,a.jsxs)(c,{children:[(0,a.jsx)(l.Y,{value:t,prevValue:()=>{const e=Math.max(n.indexOf(t)-1,0);return n[e]},nextValue:()=>{const e=Math.min(n.indexOf(t)+1,n.length-1);return n[e]},onChange:h}),(0,a.jsxs)(d,{children:[(0,a.jsx)(i.S,{onCheckedChange:e=>p(!0===e),checked:o,label:(0,a.jsx)(s.Oj,{name:"triplet"}),style:{marginBottom:"0.5rem"}}),(0,a.jsx)(i.S,{onCheckedChange:e=>m(!0===e),checked:u,label:(0,a.jsx)(s.Oj,{name:"dotted"})})]})]})})})]})}},16051:(e,t,n)=>{n.d(t,{A:()=>b});var o=n(46287),r=n(81381),s=n.n(r),i=n(56279),l=n.n(i),a=n(63696),c=n(97233),d=n(96016),u=n(20928),h=n(98376),p=n(62540);const m=(0,o.A)(u.$,{target:"efynre56"})({name:"nzbbxn",styles:"margin-right:1em;align-items:stretch"}),g=(0,o.A)(u.A,{target:"efynre55"})({name:"1w213f3",styles:"padding:0.4rem"}),x=(0,o.A)(s(),{target:"efynre54"})({name:"v3kinn",styles:"top:-0.5rem;left:0.1rem;position:relative;width:0.5rem;height:0.5rem;margin:0 -0.1rem"}),w=(0,o.A)("span",{target:"efynre53"})("color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:70%;padding:0 0.24em;"),f=(0,o.A)(u.A,{target:"efynre52"})({name:"1hcx8jb",styles:"padding:0"}),v=(0,o.A)("div",{target:"efynre51"})("min-width:3em;pointer-events:none;font-size:0.9rem;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";"),y=(0,o.A)(l(),{target:"efynre50"})({name:"1u2l1m9",styles:"width:1.1rem"});function j(e,t,n){let o=e;return t&&(o/=1.5),n&&(o*=1.5),o}function k(e){let{value:t,enabled:n,onSelect:o,onClickSwitch:r}=e;const s=t%1!=0&&1.5*t%1==0,i=t/1.5%1==0,l=j(t,i,s),a=[1,2,4,8,16,32,64,128];return(0,p.jsxs)(m,{children:[(0,p.jsx)(d.m,{title:(0,p.jsx)(c.Oj,{name:"snap-to-grid"}),children:(0,p.jsx)(g,{selected:n,onMouseDown:r,children:(0,p.jsx)(y,{})})}),(0,p.jsx)(h.y,{value:l,values:a,dotted:s,triplet:i,onChangeValue:e=>o(j(e,s,i)),onChangeDotted:e=>o(j(l,e,!1)),onChangeTriplet:e=>o(j(l,!1,e)),trigger:(0,p.jsx)(f,{onWheel:e=>{const t=a.indexOf(l),n=e.deltaY<0?1:-1,r=Math.min(a.length-1,Math.max(0,t+n));o(j(a[r],s,i))},children:(0,p.jsxs)(v,{children:[(0,p.jsx)("span",{className:"denominator",children:l}),i&&(0,p.jsx)(w,{children:"3"}),s&&(0,p.jsx)(x,{})]})})})]})}const b=a.memo(k)},16139:(e,t,n)=>{n.d(t,{y:()=>p});var o=n(46287),r=n(63696),s=n(97233),i=n(96016),l=n(20928),a=n(62540),c=function(e){return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M92.656 25.247c.328-.33 1.39-.625 2.395.387l7.591 7.635c.994 1 .708 2.05.381 2.38l-9.994 10.069-10.385-10.385 10.012-10.086ZM78.417 39.592 33.55 84.793l-3.97 13.979 14.34-3.58 44.882-45.216-10.385-10.384Zm20.89-18.188c-2.875-2.892-7.785-3.532-10.91-.384l-59.65 60.095-.546.55-.211.744-5.598 19.71-1.416 4.985 5.029-1.255 20.182-5.039.812-.203.59-.594 59.692-60.137c3.094-3.116 2.466-7.97-.384-10.837l-7.59-7.635Z"})})};c.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};var d=function(e){return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27 21h-6v6h6v-6Zm10 0h6v6h-6v-6Zm22 0h-6v6h6v-6Zm16 0h-6v6h6v-6Zm16 0h-6v6h6v-6Zm10 0h6v6h-6v-6Zm0 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm74 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm74 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm74 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm42 16h6v6h-6v-6Zm22 0h-6v6h6v-6Zm10 0h6v6h-6v-6Zm-42 0h-6v6h6v-6Zm-22 0h6v6h-6v-6Zm-10 0h-6v6h6v-6Z"})})};d.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};const u=(0,o.A)(l.$,{target:"eiiw2q91"})({name:"13wcnn3",styles:"background-color:transparent;margin-right:1rem"}),h=(0,o.A)("div",{target:"eiiw2q90"})({name:"zjik7",styles:"display:flex"}),p=e=>{let{mouseMode:t,onSelect:n}=e;return(0,a.jsxs)(u,{children:[(0,a.jsx)(l.A,{onMouseDown:(0,r.useCallback)((()=>n("pencil")),[]),selected:"pencil"===t,children:(0,a.jsx)(i.m,{title:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Oj,{name:"pencil-tool"})," [1]"]}),children:(0,a.jsx)(h,{children:(0,a.jsx)(c,{style:{width:"1.3rem",height:"1.3rem",fill:"currentColor"},viewBox:"0 0 128 128"})})})}),(0,a.jsx)(l.A,{onMouseDown:(0,r.useCallback)((()=>n("selection")),[]),selected:"selection"===t,children:(0,a.jsx)(i.m,{title:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Oj,{name:"selection-tool"})," [2]"]}),children:(0,a.jsx)(h,{children:(0,a.jsx)(d,{style:{width:"1.3rem",height:"1.3rem",fill:"currentColor"},viewBox:"0 0 128 128"})})})})]})}},99677:(e,t,n)=>{n.d(t,{M:()=>o});const o=(0,n(46287).A)("div",{target:"ejalp8n0"})("display:flex;align-items:center;padding:0.5rem 1rem;height:3rem;box-sizing:border-box;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";")},44541:(e,t,n)=>{n.d(t,{I:()=>l});var o=n(46287),r=n(63696),s=n(62540);const i=(0,o.A)("button",{target:"efamyr0"})("-webkit-appearance:none;min-width:auto;padding:0 0.8rem;color:",(e=>{let{theme:t,selected:n}=e;return n?t.onSurfaceColor:t.textColor}),";border:none;background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.darkBackgroundColor}),";text-transform:none;height:2rem;overflow:hidden;white-space:nowrap;display:flex;align-items:center;border-radius:999px;cursor:pointer;outline:none;flex-shrink:0;&:hover{background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.highlightColor}),";}"),l=(0,r.forwardRef)(((e,t)=>{let{children:n,onMouseDown:o,...r}=e;return(0,s.jsx)(i,{...r,onMouseDown:e=>{e.preventDefault(),o?.(e)},tabIndex:-1,ref:t,children:n})}))},20928:(e,t,n)=>{n.d(t,{$:()=>i,A:()=>a});var o=n(46287),r=n(63696),s=n(62540);const i=(0,o.A)("div",{target:"e13wm2pd1"})({name:"1ygd1io",styles:"min-width:auto;overflow:hidden;white-space:nowrap;display:flex;align-items:center;cursor:pointer;flex-shrink:0"}),l=(0,o.A)("button",{target:"e13wm2pd0"})("outline:none;-webkit-appearance:none;min-width:auto;padding:0 0.5rem;color:",(e=>{let{theme:t,selected:n}=e;return n?t.onSurfaceColor:t.textColor}),";background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.secondaryBackgroundColor}),";text-transform:none;height:2rem;overflow:hidden;white-space:nowrap;display:flex;align-items:center;cursor:pointer;margin:0;border:none;border-radius:4px;&:first-of-type{border-radius:4px 0 0 4px;}&:last-child{border-radius:0 4px 4px 0;}&:hover{background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.highlightColor}),";}"),a=(0,r.forwardRef)(((e,t)=>{let{children:n,onMouseDown:o,...r}=e;return(0,s.jsx)(l,{...r,onMouseDown:e=>{e.preventDefault(),o?.(e)},tabIndex:-1,ref:t,children:n})}))},89296:(e,t,n)=>{n.d(t,{$:()=>p});var o=n(46287),r=n(39751),s=n.n(r),i=n(69229),l=n(50119),a=n(97233),c=n(62540);const d=(0,o.A)("div",{target:"e1pd9xtb2"})("display:flex;padding:0.5rem 1rem;align-items:center;justify-content:center;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";border-radius:0.5rem;margin:0.5rem;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),u=(0,o.A)(s(),{target:"e1pd9xtb1"})({name:"g41qz1",styles:"min-width:auto;margin-right:0.5em;color:inherit"}),h=(0,o.A)("div",{target:"e1pd9xtb0"})({name:"ol9ofu",styles:"font-size:0.875rem"}),p=(0,i.PA)((()=>{const e=(0,l.gg)();return(0,c.jsxs)(d,{onClick:e,children:[(0,c.jsx)(u,{}),(0,c.jsx)(h,{children:(0,c.jsx)(a.Oj,{name:"add-track"})})]})}))},41479:(e,t,n)=>{n.d(t,{F:()=>l});var o=n(97233),r=n(16053),s=n(62540);const i=e=>{let{programNumber:t}=e;switch((0,r.h)(t)){case 0:return(0,s.jsx)(o.Oj,{name:"Piano"});case 1:return(0,s.jsx)(o.Oj,{name:"Chromatic Percussion"});case 2:return(0,s.jsx)(o.Oj,{name:"Organ"});case 3:return(0,s.jsx)(o.Oj,{name:"Guitar"});case 4:return(0,s.jsx)(o.Oj,{name:"Bass"});case 5:return(0,s.jsx)(o.Oj,{name:"Strings"});case 6:return(0,s.jsx)(o.Oj,{name:"Ensemble"});case 7:return(0,s.jsx)(o.Oj,{name:"Brass"});case 8:return(0,s.jsx)(o.Oj,{name:"Reed"});case 9:return(0,s.jsx)(o.Oj,{name:"Pipe"});case 10:return(0,s.jsx)(o.Oj,{name:"Synth Lead"});case 11:return(0,s.jsx)(o.Oj,{name:"Synth Pad"});case 12:return(0,s.jsx)(o.Oj,{name:"Synth Effects"});case 13:return(0,s.jsx)(o.Oj,{name:"Ethnic"});case 14:return(0,s.jsx)(o.Oj,{name:"Percussive"});case 15:return(0,s.jsx)(o.Oj,{name:"Sound effects"})}return(0,s.jsx)(s.Fragment,{})},l=e=>{let{programNumber:t}=e;const n=r.g[(0,r.h)(t)];return(0,s.jsxs)(s.Fragment,{children:[n," ",(0,s.jsx)(i,{programNumber:t})]})}},6980:(e,t,n)=>{n.d(t,{Z:()=>i,a:()=>l});var o=n(69229),r=n(97233),s=n(62540);const i=e=>{let{programNumber:t}=e;switch(t){case 0:return(0,s.jsx)(r.Oj,{name:"Acoustic Grand Piano"});case 1:return(0,s.jsx)(r.Oj,{name:"Bright Acoustic Piano"});case 2:return(0,s.jsx)(r.Oj,{name:"Electric Grand Piano"});case 3:return(0,s.jsx)(r.Oj,{name:"Honky-tonk Piano"});case 4:return(0,s.jsx)(r.Oj,{name:"Electric Piano 1"});case 5:return(0,s.jsx)(r.Oj,{name:"Electric Piano 2"});case 6:return(0,s.jsx)(r.Oj,{name:"Harpsichord"});case 7:return(0,s.jsx)(r.Oj,{name:"Clavinet"});case 8:return(0,s.jsx)(r.Oj,{name:"Celesta"});case 9:return(0,s.jsx)(r.Oj,{name:"Glockenspiel"});case 10:return(0,s.jsx)(r.Oj,{name:"Music Box"});case 11:return(0,s.jsx)(r.Oj,{name:"Vibraphone"});case 12:return(0,s.jsx)(r.Oj,{name:"Marimba"});case 13:return(0,s.jsx)(r.Oj,{name:"Xylophone"});case 14:return(0,s.jsx)(r.Oj,{name:"Tubular Bells"});case 15:return(0,s.jsx)(r.Oj,{name:"Dulcimer"});case 16:return(0,s.jsx)(r.Oj,{name:"Drawbar Organ"});case 17:return(0,s.jsx)(r.Oj,{name:"Percussive Organ"});case 18:return(0,s.jsx)(r.Oj,{name:"Rock Organ"});case 19:return(0,s.jsx)(r.Oj,{name:"Church Organ"});case 20:return(0,s.jsx)(r.Oj,{name:"Reed Organ"});case 21:return(0,s.jsx)(r.Oj,{name:"Accordion"});case 22:return(0,s.jsx)(r.Oj,{name:"Harmonica"});case 23:return(0,s.jsx)(r.Oj,{name:"Tango Accordion"});case 24:return(0,s.jsx)(r.Oj,{name:"Acoustic Guitar (nylon)"});case 25:return(0,s.jsx)(r.Oj,{name:"Acoustic Guitar (steel)"});case 26:return(0,s.jsx)(r.Oj,{name:"Electric Guitar (jazz)"});case 27:return(0,s.jsx)(r.Oj,{name:"Electric Guitar (clean)"});case 28:return(0,s.jsx)(r.Oj,{name:"Electric Guitar (muted)"});case 29:return(0,s.jsx)(r.Oj,{name:"Overdriven Guitar"});case 30:return(0,s.jsx)(r.Oj,{name:"Distortion Guitar"});case 31:return(0,s.jsx)(r.Oj,{name:"Guitar Harmonics"});case 32:return(0,s.jsx)(r.Oj,{name:"Acoustic Bass"});case 33:return(0,s.jsx)(r.Oj,{name:"Electric Bass (finger)"});case 34:return(0,s.jsx)(r.Oj,{name:"Electric Bass (pick)"});case 35:return(0,s.jsx)(r.Oj,{name:"Fretless Bass"});case 36:return(0,s.jsx)(r.Oj,{name:"Slap Bass 1"});case 37:return(0,s.jsx)(r.Oj,{name:"Slap Bass 2"});case 38:return(0,s.jsx)(r.Oj,{name:"Synth Bass 1"});case 39:return(0,s.jsx)(r.Oj,{name:"Synth Bass 2"});case 40:return(0,s.jsx)(r.Oj,{name:"Violin"});case 41:return(0,s.jsx)(r.Oj,{name:"Viola"});case 42:return(0,s.jsx)(r.Oj,{name:"Cello"});case 43:return(0,s.jsx)(r.Oj,{name:"Contrabass"});case 44:return(0,s.jsx)(r.Oj,{name:"Tremolo Strings"});case 45:return(0,s.jsx)(r.Oj,{name:"Pizzicato Strings"});case 46:return(0,s.jsx)(r.Oj,{name:"Orchestral Harp"});case 47:return(0,s.jsx)(r.Oj,{name:"Timpani"});case 48:return(0,s.jsx)(r.Oj,{name:"String Ensemble 1"});case 49:return(0,s.jsx)(r.Oj,{name:"String Ensemble 2"});case 50:return(0,s.jsx)(r.Oj,{name:"Synth Strings 1"});case 51:return(0,s.jsx)(r.Oj,{name:"Synth Strings 2"});case 52:return(0,s.jsx)(r.Oj,{name:"Choir Aahs"});case 53:return(0,s.jsx)(r.Oj,{name:"Voice Oohs"});case 54:return(0,s.jsx)(r.Oj,{name:"Synth Choir"});case 55:return(0,s.jsx)(r.Oj,{name:"Orchestra Hit"});case 56:return(0,s.jsx)(r.Oj,{name:"Trumpet"});case 57:return(0,s.jsx)(r.Oj,{name:"Trombone"});case 58:return(0,s.jsx)(r.Oj,{name:"Tuba"});case 59:return(0,s.jsx)(r.Oj,{name:"Muted Trumpet"});case 60:return(0,s.jsx)(r.Oj,{name:"French Horn"});case 61:return(0,s.jsx)(r.Oj,{name:"Brass Section"});case 62:return(0,s.jsx)(r.Oj,{name:"Synth Brass 1"});case 63:return(0,s.jsx)(r.Oj,{name:"Synth Brass 2"});case 64:return(0,s.jsx)(r.Oj,{name:"Soprano Sax"});case 65:return(0,s.jsx)(r.Oj,{name:"Alto Sax"});case 66:return(0,s.jsx)(r.Oj,{name:"Tenor Sax"});case 67:return(0,s.jsx)(r.Oj,{name:"Baritone Sax"});case 68:return(0,s.jsx)(r.Oj,{name:"Oboe"});case 69:return(0,s.jsx)(r.Oj,{name:"English Horn"});case 70:return(0,s.jsx)(r.Oj,{name:"Bassoon"});case 71:return(0,s.jsx)(r.Oj,{name:"Clarinet"});case 72:return(0,s.jsx)(r.Oj,{name:"Piccolo"});case 73:return(0,s.jsx)(r.Oj,{name:"Flute"});case 74:return(0,s.jsx)(r.Oj,{name:"Recorder"});case 75:return(0,s.jsx)(r.Oj,{name:"Pan Flute"});case 76:return(0,s.jsx)(r.Oj,{name:"Blown Bottle"});case 77:return(0,s.jsx)(r.Oj,{name:"Shakuhachi"});case 78:return(0,s.jsx)(r.Oj,{name:"Whistle"});case 79:return(0,s.jsx)(r.Oj,{name:"Ocarina"});case 80:return(0,s.jsx)(r.Oj,{name:"Lead 1 (square)"});case 81:return(0,s.jsx)(r.Oj,{name:"Lead 2 (sawtooth)"});case 82:return(0,s.jsx)(r.Oj,{name:"Lead 3 (calliope)"});case 83:return(0,s.jsx)(r.Oj,{name:"Lead 4 (chiff)"});case 84:return(0,s.jsx)(r.Oj,{name:"Lead 5 (charang)"});case 85:return(0,s.jsx)(r.Oj,{name:"Lead 6 (voice)"});case 86:return(0,s.jsx)(r.Oj,{name:"Lead 7 (fifths)"});case 87:return(0,s.jsx)(r.Oj,{name:"Lead 8 (bass + lead)"});case 88:return(0,s.jsx)(r.Oj,{name:"Pad 1 (new age)"});case 89:return(0,s.jsx)(r.Oj,{name:"Pad 2 (warm)"});case 90:return(0,s.jsx)(r.Oj,{name:"Pad 3 (polysynth)"});case 91:return(0,s.jsx)(r.Oj,{name:"Pad 4 (choir)"});case 92:return(0,s.jsx)(r.Oj,{name:"Pad 5 (bowed)"});case 93:return(0,s.jsx)(r.Oj,{name:"Pad 6 (metallic)"});case 94:return(0,s.jsx)(r.Oj,{name:"Pad 7 (halo)"});case 95:return(0,s.jsx)(r.Oj,{name:"Pad 8 (sweep)"});case 96:return(0,s.jsx)(r.Oj,{name:"FX 1 (rain)"});case 97:return(0,s.jsx)(r.Oj,{name:"FX 2 (soundtrack)"});case 98:return(0,s.jsx)(r.Oj,{name:"FX 3 (crystal)"});case 99:return(0,s.jsx)(r.Oj,{name:"FX 4 (atmosphere)"});case 100:return(0,s.jsx)(r.Oj,{name:"FX 5 (brightness)"});case 101:return(0,s.jsx)(r.Oj,{name:"FX 6 (goblins)"});case 102:return(0,s.jsx)(r.Oj,{name:"FX 7 (echoes)"});case 103:return(0,s.jsx)(r.Oj,{name:"FX 8 (sci-fi)"});case 104:return(0,s.jsx)(r.Oj,{name:"Sitar"});case 105:return(0,s.jsx)(r.Oj,{name:"Banjo"});case 106:return(0,s.jsx)(r.Oj,{name:"Shamisen"});case 107:return(0,s.jsx)(r.Oj,{name:"Koto"});case 108:return(0,s.jsx)(r.Oj,{name:"Kalimba"});case 109:return(0,s.jsx)(r.Oj,{name:"Bagpipe"});case 110:return(0,s.jsx)(r.Oj,{name:"Fiddle"});case 111:return(0,s.jsx)(r.Oj,{name:"Shanai"});case 112:return(0,s.jsx)(r.Oj,{name:"Tinkle Bell"});case 113:return(0,s.jsx)(r.Oj,{name:"Agogo"});case 114:return(0,s.jsx)(r.Oj,{name:"Steel Drums"});case 115:return(0,s.jsx)(r.Oj,{name:"Woodblock"});case 116:return(0,s.jsx)(r.Oj,{name:"Taiko Drum"});case 117:return(0,s.jsx)(r.Oj,{name:"Melodic Tom"});case 118:return(0,s.jsx)(r.Oj,{name:"Synth Drum"});case 119:return(0,s.jsx)(r.Oj,{name:"Reverse Cymbal"});case 120:return(0,s.jsx)(r.Oj,{name:"Guitar Fret Noise"});case 121:return(0,s.jsx)(r.Oj,{name:"Breath Noise"});case 122:return(0,s.jsx)(r.Oj,{name:"Seashore"});case 123:return(0,s.jsx)(r.Oj,{name:"Bird Tweet"});case 124:return(0,s.jsx)(r.Oj,{name:"Telephone Ring"});case 125:return(0,s.jsx)(r.Oj,{name:"Helicopter"});case 126:return(0,s.jsx)(r.Oj,{name:"Applause"});case 127:return(0,s.jsx)(r.Oj,{name:"Gunshot"})}return(0,s.jsx)(s.Fragment,{})},l=(0,o.PA)((e=>{let{track:t}=e;return t.isRhythmTrack?(0,s.jsx)(s.Fragment,{children:"Standard Drum Kit"}):(0,s.jsx)(i,{programNumber:t.programNumber})}))},9481:(e,t,n)=>{n.d(t,{y:()=>p});var o=n(17243),r=n(63696),s=n(97233),i=n(66459),l=n(5513),a=n(15467),c=n(95881),d=n(4830),u=n(8008),h=n(62540);const p=e=>{let{track:t,open:n,onClose:p}=e;const[m,g]=(0,r.useState)(t.name),[x,w]=(0,r.useState)(t.channel);return(0,r.useEffect)((()=>{g(t.name),w(t.channel)}),[t]),(0,h.jsxs)(i.lG,{open:n,onOpenChange:p,style:{minWidth:"20rem"},children:[(0,h.jsxs)(i.L3,{children:[(0,h.jsx)(s.Oj,{name:"track"}),": ",(0,h.jsx)(u.x,{track:t})]}),(0,h.jsxs)(i.Cf,{children:[(0,h.jsx)(a.J,{children:(0,h.jsx)(s.Oj,{name:"track-name"})}),(0,h.jsx)(d.A,{type:"text",value:m,onChange:e=>g(e.target.value),style:{width:"100%",marginBottom:"1rem"}}),(0,h.jsx)(a.J,{children:(0,h.jsx)(s.Oj,{name:"channel"})}),(0,h.jsx)(c.l,{value:x,onChange:e=>w(parseInt(e.target.value)),children:(0,o.range)(0,16).map((e=>(0,h.jsxs)("option",{value:e.toString(),children:[e+1,9===e?(0,h.jsxs)(h.Fragment,{children:[" ","(",(0,h.jsx)(s.Oj,{name:"rhythm-track"}),")"]}):""]},e)))})]}),(0,h.jsxs)(i.ii,{children:[(0,h.jsx)(l.$,{autoFocus:!0,onClick:p,children:(0,h.jsx)(s.Oj,{name:"cancel"})}),(0,h.jsx)(l.j,{onClick:()=>{t.channel=x,t.setName(m??""),p()},children:(0,h.jsx)(s.Oj,{name:"ok"})})]})]})}},19069:(e,t,n)=>{n.d(t,{S:()=>u});var o=n(46287),r=n(69229),s=n(59061),i=n(71527),l=n(89296),a=n(8228),c=n(62540);const d=(0,o.A)("div",{target:"e45fs990"})("overflow-y:auto;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";min-width:14rem;flex-grow:1;"),u=(0,r.PA)((()=>{const{song:e}=(0,s.g)();return(0,c.jsxs)(d,{children:[(0,c.jsx)(i.q,{items:e.tracks.filter((e=>!e.isConductorTrack)),getItemId:e=>e.id,onItemMoved:(t,n)=>{const o=e.getTrack(t),r=e.getTrack(n);if(void 0===o||void 0===r)return;const s=e.tracks.indexOf(o),i=e.tracks.indexOf(r);e.moveTrack(s,i)},render:e=>(0,c.jsx)(a.H,{track:e},e.id)}),(0,c.jsx)(l.$,{})]})}))},10781:(e,t,n)=>{n.d(t,{A:()=>m});var o=n(44308),r=n.n(o),s=n(69229),i=n(63696),l=n(50119),a=n(97233),c=n(89017),d=n(5909),u=n(94724),h=n(9481),p=n(62540);const m=(0,s.PA)((e=>{let{track:t,...n}=e;const o=(0,l.gg)(),s=(0,l.Vd)(),{handleClose:m}=n,[g,x]=(0,i.useState)(!1),[w,f]=(0,i.useState)(!1),v=o,y=(0,i.useCallback)((()=>s(t.id)),[t.id,s]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(d.t,{...n,children:[(0,p.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),v(),m()},children:(0,p.jsx)(a.Oj,{name:"add-track"})}),(0,p.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),y(),m()},children:(0,p.jsx)(a.Oj,{name:"delete-track"})}),(0,p.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),x(!0),m()},children:(0,p.jsx)(a.Oj,{name:"property"})}),(0,p.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),f(!0),m()},children:(0,p.jsx)(a.Oj,{name:"change-track-color"})})]}),(0,p.jsx)(h.y,{track:t,open:g,onClose:()=>x(!1)}),(0,p.jsx)(c.s,{open:w,onSelect:e=>{if(null===e)return void t.setColor(null);const n=r()(e);t.setColor({red:Math.floor(n.red()),green:Math.floor(n.green()),blue:Math.floor(n.blue()),alpha:255})},onClose:()=>f(!1)})]})}))},8228:(e,t,n)=>{n.d(t,{H:()=>O});var o=n(46287),r=n(73119),s=n.n(r),i=n(43138),l=n.n(i),a=n(4126),c=n.n(a),d=n(28951),u=n.n(d),h=n(69229),p=n(63696),m=n(50119),g=n(78439),x=n(59061),w=n(16053),f=n(30453),v=n(6980),y=n(9481),j=n(10781),k=n(8008),b=n(62540);const C=(0,o.A)("div",{target:"emvqz9i8"})("background-color:",(e=>{let{theme:t,selected:n}=e;return n?t.highlightColor:"transparent"}),";border:1px solid;border-color:",(e=>{let{theme:t,selected:n}=e;return n?t.dividerColor:"transparent"}),";display:flex;align-items:center;padding:0.5rem 0.5rem;border-radius:0.5rem;margin:0.5rem;outline:none;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),S=(0,o.A)("div",{target:"emvqz9i7"})({name:"12comyy",styles:"display:flex;padding-bottom:0.3em;align-items:baseline"}),R=(0,o.A)("div",{target:"emvqz9i6"})("color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:0.75rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"),A=(0,o.A)("div",{target:"emvqz9i5"})("font-weight:600;color:",(e=>{let{theme:t,selected:n}=e;return n?t.textColor:t.secondaryTextColor}),";padding-right:0.5em;font-size:0.875rem;text-overflow:ellipsis;white-space:nowrap;"),T=(0,o.A)("div",{target:"emvqz9i4"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),E=(0,o.A)("div",{target:"emvqz9i3"})("flex-shrink:0;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:0.625rem;display:flex;align-items:center;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";padding:0 0.25rem;cursor:pointer;height:1.25rem;margin-left:0.25rem;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),I=(0,o.A)("div",{target:"emvqz9i2"})("display:flex;align-items:center;justify-content:center;font-size:1.2rem;width:2.6rem;height:2.6rem;border-radius:1.3rem;margin-right:0.5rem;flex-shrink:0;background:",(e=>{let{theme:t,selected:n}=e;return n?t.backgroundColor:t.secondaryBackgroundColor}),";border:2px solid ",(e=>{let{color:t}=e;return t}),";box-sizing:border-box;"),D=(0,o.A)("div",{target:"emvqz9i1"})("opacity:",(e=>{let{selected:t}=e;return t?1:.5}),";"),M=(0,o.A)("div",{target:"emvqz9i0"})("width:1.9rem;height:1.9rem;margin-right:0.25rem;display:flex;align-items:center;justify-content:center;border-radius:999px;color:",(e=>{let{theme:t,active:n}=e;return n?t.textColor:t.secondaryTextColor}),";cursor:pointer;outline:none;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}svg{width:1.1rem;height:1.1rem;}"),O=(0,h.PA)((e=>{let{track:t}=e;const{pianoRollStore:n,rootViewStore:o,trackMute:r,router:i}=(0,x.g)(),a=(0,m.mg)(),d=(0,m.Ay)(),h=(0,m.W3)(),O=(0,m.i5)(),P=(0,m.bS)(),B=!o.isArrangeViewSelected&&t.id===n.selectedTrackId,N=r.isMuted(t.id),F=r.isSolo(t.id),z=!n.notGhostTrackIds.has(t.id),L=t.channel,{onContextMenu:G,menuProps:H}=(0,g.E)(),[W,_]=(0,p.useState)(!1),K=(0,p.useCallback)((()=>{t.isConductorTrack||(n.openInstrumentBrowser=!0,n.instrumentBrowserSetting={programNumber:t.programNumber??0,isRhythmTrack:t.isRhythmTrack})}),[]),X=(0,p.useCallback)((e=>{e.stopPropagation(),a(t.id)}),[t.id,a]),V=(0,p.useCallback)((e=>{e.stopPropagation(),d(t.id)}),[t.id,d]),Y=(0,p.useCallback)((e=>{e.stopPropagation(),e.nativeEvent.altKey?O():h(t.id)}),[t.id,O,h]),q=(0,p.useCallback)((()=>{i.pushTrack(),P(t.id)}),[t.id,P]),U=(0,p.useCallback)((()=>{_(!0)}),[]),$=t.isRhythmTrack?"":w.g[(0,w.h)(t.programNumber??0)],Z=void 0!==t.color?(0,f.g)(t.color):"transparent";return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(C,{selected:B,onMouseDown:q,onContextMenu:G,tabIndex:-1,children:[(0,b.jsx)(I,{selected:B,color:Z,onDoubleClick:K,children:(0,b.jsx)(D,{selected:B,children:$})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(S,{children:[(0,b.jsx)(A,{selected:B,children:(0,b.jsx)(k.x,{track:t})}),(0,b.jsx)(R,{children:(0,b.jsx)(v.a,{track:t})})]}),(0,b.jsxs)(T,{children:[(0,b.jsx)(M,{active:F,onMouseDown:V,tabIndex:-1,children:(0,b.jsx)(s(),{})}),(0,b.jsx)(M,{active:N,onMouseDown:X,tabIndex:-1,children:N?(0,b.jsx)(u(),{}):(0,b.jsx)(c(),{})}),(0,b.jsx)(M,{active:z,onMouseDown:Y,tabIndex:-1,children:(0,b.jsx)(l(),{})}),void 0!==L&&(0,b.jsxs)(E,{onClick:U,children:["CH ",L+1]})]})]})]}),(0,b.jsx)(j.A,{...H,track:t}),(0,b.jsx)(y.y,{track:t,open:W,onClose:()=>_(!1)})]})}))},81244:(e,t,n)=>{n.d(t,{D:()=>h});var o=n(46287),r=n(52662),s=n.n(r),i=n(69229),l=n(63696),a=n(59061),c=n(62540);const d=(0,o.A)("button",{target:"e7epabs0"})("-webkit-appearance:none;border:none;outline:none;height:2rem;background:none;color:inherit;cursor:pointer;&:hover{background:none;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}"),u=e=>{let{isOpen:t}=e;return(0,c.jsx)(s(),{style:{transition:"transform 0.1s ease",transform:`scale(1.4) rotateZ(${t?"0deg":"-90deg"})`}})},h=(0,i.PA)((()=>{const{pianoRollStore:e}=(0,a.g)(),t=e.showTrackList,n=(0,l.useCallback)((()=>e.showTrackList=!e.showTrackList),[e]),o=(0,l.useRef)(null);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(d,{ref:o,tabIndex:-1,onMouseDown:e=>{e.preventDefault(),n()},children:(0,c.jsx)(u,{isOpen:t})})})}))},8008:(e,t,n)=>{n.d(t,{x:()=>i});var o=n(69229),r=n(97233),s=n(62540);const i=(0,o.PA)((e=>{let{track:t}=e;return t.name&&t.name.length>0?(0,s.jsx)(s.Fragment,{children:t.name}):void 0===t.channel?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(r.Oj,{name:"conductor-track"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.Oj,{name:"track"})," ",t.channel+1]})}))},34542:(e,t,n)=>{n.d(t,{j:()=>o});const o=(0,n(46287).A)("div",{target:"e1wucebe0"})("--webkit-appearance:none;outline:none;border:none;border-radius:100%;margin:0.25rem;padding:0.4rem;color:",(e=>{let{theme:t}=e;return t.textColor}),";display:flex;align-items:center;justify-content:center;cursor:pointer;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}svg{width:1.2rem;height:1.2rem;}")},61436:(e,t,n)=>{n.d(t,{D:()=>p});var o=n(46287),r=n(46834),s=n.n(r),i=n(67235),l=n.n(i),a=n(97233),c=n(96016),d=n(34542),u=n(62540);const h=(0,o.A)(d.j,{target:"e134in680"})("color:",(e=>{let{theme:t}=e;return t.onSurfaceColor}),";background:",(e=>{let{theme:t}=e;return t.themeColor}),";&:hover{background:",(e=>{let{theme:t}=e;return t.themeColor}),";opacity:0.8;}&.active{background:",(e=>{let{theme:t}=e;return t.themeColor}),";}"),p=e=>{let{onMouseDown:t,isPlaying:n}=e;return(0,u.jsx)(c.m,{title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.Oj,{name:"play-pause"})," [space]"]}),side:"top",children:(0,u.jsx)(h,{id:"button-play",onMouseDown:t,className:n?"active":void 0,children:n?(0,u.jsx)(s(),{}):(0,u.jsx)(l(),{})})})}},54699:(e,t,n)=>{n.d(t,{g:()=>u});var o=n(46287),r=n(1902),s=n(69229),i=n(59061),l=n(50029),a=n(62540);const c=(0,o.A)(l.Q,{target:"epow5t61"})("background:transparent;-webkit-appearance:none;border:none;color:inherit;font-size:inherit;font-family:inherit;width:5em;text-align:center;outline:none;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";font-size:1rem;padding:0.3rem 0;&::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}"),d=(0,o.A)("div",{target:"epow5t60"})("display:flex;align-items:center;border:1px solid transparent;padding-left:0.75rem;border-radius:0.25rem;label{font-size:0.6rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}&:focus-within{border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";background:#ffffff14;}"),u=(0,s.PA)((()=>{const{song:e,pianoRollStore:{currentTempo:t},player:n}=(0,i.g)(),o=t??r.gg;return(0,a.jsxs)(d,{children:[(0,a.jsx)("label",{htmlFor:"tempo-input",children:"BPM"}),(0,a.jsx)(c,{id:"tempo-input",min:1,max:512,value:Math.round(100*o)/100,step:1,onChange:t=>{e.conductorTrack?.setTempo(t,n.position),n.currentTempo=t}})]})}))},82733:(e,t,n)=>{n.d(t,{Cg:()=>N});var o=n(46287),r=n(61851),s=n.n(r),i=n(97401),l=n.n(i),a=n(81381),c=n.n(a),d=n(35302),u=n.n(d),h=n(5176),p=n.n(h),m=n(34368),g=n.n(m),x=n(69229),w=n(63696),f=n(50119),v=n(56400),y=n(59061),j=n(97233),k=n(571),b=n(96016),C=n(34542),S=n(61436),R=n(54699),A=n(62540);const T=(0,o.A)("div",{target:"eyixwlw6"})("display:flex;align-items:center;justify-content:center;padding:0.25rem 1rem;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border-top:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";height:3rem;box-sizing:border-box;"),E=(0,o.A)(C.j,{target:"eyixwlw5"})("color:",(e=>{let{theme:t,active:n}=e;return n?t.recordColor:"inherit"}),";"),I=(0,o.A)(C.j,{target:"eyixwlw4"})("color:",(e=>{let{theme:t,active:n}=e;return n?t.themeColor:"inherit"}),";"),D=(0,o.A)(C.j,{target:"eyixwlw3"})("color:",(e=>{let{theme:t,active:n}=e;return n?t.themeColor:t.secondaryTextColor}),";"),M=(0,o.A)("div",{target:"eyixwlw2"})("font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";font-size:0.9rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),O=(0,x.PA)((()=>{const{pianoRollStore:e}=(0,y.g)(),t=e.currentMBTTime;return(0,A.jsx)(M,{children:t})})),P=(0,o.A)("div",{target:"eyixwlw1"})("background:",(e=>{let{theme:t}=e;return t.dividerColor}),";margin:0.4em 1em;width:1px;height:1rem;"),B=(0,o.A)("div",{target:"eyixwlw0"})({name:"1201k1l",styles:"position:absolute;right:1em"}),N=(0,x.PA)((()=>{const{player:e,midiDeviceStore:t,midiRecorder:n,soundFontStore:o,synthGroup:r,synthGroup:{isMetronomeEnabled:i}}=(0,y.g)(),{isPlaying:a,loop:d}=e,h=n.isRecording,m=Object.values(t.enabledInputs).filter((e=>e)).length>0,x=o.isLoading,M=(0,f.qo)(),N=(0,f.sQ)(),F=(0,f.m$)(),z=(0,v.b)(),L=(0,w.useCallback)((()=>{r.isMetronomeEnabled=!r.isMetronomeEnabled}),[e]);return(0,A.jsxs)(T,{children:[(0,A.jsx)(b.m,{title:(0,A.jsx)(j.Oj,{name:"rewind"}),side:"top",children:(0,A.jsx)(C.j,{onMouseDown:N,children:(0,A.jsx)(l(),{})})}),(0,A.jsx)(b.m,{title:(0,A.jsx)(j.Oj,{name:"stop"}),side:"top",children:(0,A.jsx)(C.j,{onMouseDown:M,children:(0,A.jsx)(g(),{})})}),(0,A.jsx)(S.D,{onMouseDown:()=>e.playOrPause(),isPlaying:a}),m&&(0,A.jsx)(b.m,{title:(0,A.jsx)(j.Oj,{name:"record"}),side:"top",children:(0,A.jsx)(E,{onMouseDown:z,active:h,children:(0,A.jsx)(c(),{})})}),(0,A.jsx)(b.m,{title:(0,A.jsx)(j.Oj,{name:"fast-forward"}),side:"top",children:(0,A.jsx)(C.j,{onMouseDown:F,children:(0,A.jsx)(s(),{})})}),d&&(0,A.jsx)(I,{onMouseDown:()=>e.toggleEnableLoop(),active:d.enabled,children:(0,A.jsx)(u(),{})}),(0,A.jsx)(P,{}),(0,A.jsx)(D,{onMouseDown:L,active:i,children:(0,A.jsx)(p(),{})}),(0,A.jsx)(R.g,{}),(0,A.jsx)(P,{}),(0,A.jsx)(O,{}),x&&(0,A.jsx)(B,{children:(0,A.jsx)(k.P,{size:"1rem"})})]})}))},71751:(e,t,n)=>{n.d(t,{C:()=>c});var o=n(69229),r=n(63696),s=n(50119),i=n(59061),l=n(87357),a=n(62540);const c=(0,o.PA)((()=>{const{arrangeViewStore:e}=(0,i.g)(),{openTransposeDialog:t}=e,n=(0,s.vi)(),o=(0,r.useCallback)((()=>e.openTransposeDialog=!1),[e]),c=(0,r.useCallback)((t=>{n(t),e.openTransposeDialog=!1}),[e,n]);return(0,a.jsx)(l.S,{open:t,onClose:o,onClickOK:c})}))},7101:(e,t,n)=>{n.d(t,{w:()=>c});var o=n(69229),r=n(63696),s=n(50119),i=n(59061),l=n(87357),a=n(62540);const c=(0,o.PA)((()=>{const{pianoRollStore:e}=(0,i.g)(),{openTransposeDialog:t}=e,n=(0,s.fm)(),o=(0,r.useCallback)((()=>e.openTransposeDialog=!1),[e]),c=(0,r.useCallback)((t=>{n(t),e.openTransposeDialog=!1}),[e,n]);return(0,a.jsx)(l.S,{open:t,onClose:o,onClickOK:c})}))},87357:(e,t,n)=>{n.d(t,{S:()=>c});var o=n(63696),r=n(97233),s=n(66459),i=n(5513),l=n(4830),a=n(62540);const c=e=>{let{open:t,onClickOK:n,onClose:c}=e;const[d,u]=(0,o.useState)("0");(0,o.useEffect)((()=>{t&&u("")}),[t]);const h=()=>{const e=parseInt(d);n(isNaN(e)?0:e),c()};return(0,a.jsxs)(s.lG,{open:t,onOpenChange:c,children:[(0,a.jsx)(s.L3,{children:(0,a.jsx)(r.Oj,{name:"transpose"})}),(0,a.jsx)(s.Cf,{children:(0,a.jsx)(l.A,{type:"number",value:d,onChange:e=>u(e.target.value),autoFocus:!0,placeholder:"0",onKeyPress:e=>{"Enter"===e.key&&h()}})}),(0,a.jsxs)(s.ii,{children:[(0,a.jsx)(i.$,{onClick:c,children:(0,a.jsx)(r.Oj,{name:"close"})}),(0,a.jsx)(i.j,{onClick:h,children:(0,a.jsx)(r.Oj,{name:"ok"})})]})]})}},36079:(e,t,n)=>{n.d(t,{r:()=>d});var o=n(13600),r=n(69229),s=n(59061),i=n(97233),l=n(66459),a=n(5513),c=n(62540);const d=(0,r.PA)((()=>{const{rootViewStore:e,userRepository:t}=(0,s.g)();return(0,c.jsxs)(l.lG,{open:e.openDeleteAccountDialog,children:[(0,c.jsx)(o.L3,{children:(0,c.jsx)(i.Oj,{name:"delete-account"})}),(0,c.jsx)(l.Cf,{children:(0,c.jsx)(i.Oj,{name:"delete-account-description"})}),(0,c.jsxs)(l.ii,{children:[(0,c.jsx)(a.j,{onClick:async()=>{try{await t.delete(),e.openDeleteAccountDialog=!1}catch(e){alert(`Failed to delete account: ${e}`)}},children:(0,c.jsx)(i.Oj,{name:"delete"})}),(0,c.jsx)(a.$,{onClick:()=>{e.openDeleteAccountDialog=!1},children:(0,c.jsx)(i.Oj,{name:"cancel"})})]})]})}))},71323:(e,t,n)=>{n.d(t,{D:()=>x});var o=n(46287),r=n(13600),s=n(69229),i=n(59061),l=n(97233),a=n(66459),c=n(5513),d=n(62540);const u=(0,o.A)("img",{target:"e17lg3h3"})("width:3rem;height:3rem;border-radius:1.5rem;border:2px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";box-sizing:border-box;"),h=(0,o.A)("div",{target:"e17lg3h2"})({name:"r2g86h",styles:"display:flex;align-items:center;gap:1rem"}),p=(0,s.PA)((()=>{const{authStore:{authUser:e}}=(0,i.g)();return null===e?(0,d.jsx)(d.Fragment,{}):(0,d.jsxs)(h,{children:[(0,d.jsx)(u,{src:e.photoURL??void 0}),(0,d.jsx)("p",{children:e.displayName})]})})),m=(0,o.A)("div",{target:"e17lg3h1"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"}),g=(0,o.A)(c.$,{target:"e17lg3h0"})("color:",(e=>{let{theme:t}=e;return t.redColor}),";"),x=(0,s.PA)((()=>{const{rootViewStore:e,authStore:{authUser:t}}=(0,i.g)();return(0,d.jsxs)(a.lG,{open:e.openUserSettingsDialog,style:{minWidth:"30rem"},children:[(0,d.jsx)(r.L3,{children:(0,d.jsx)(l.Oj,{name:"user-settings"})}),(0,d.jsx)(a.Cf,{children:(0,d.jsxs)(m,{children:[(0,d.jsx)(p,{}),(0,d.jsx)(c.$,{onClick:()=>{null!==t&&window.open(`https://signal.vercel.app/users/${t.uid}`)},children:(0,d.jsx)(l.Oj,{name:"profile"})}),(0,d.jsx)(g,{onClick:async()=>{e.openUserSettingsDialog=!1,e.openDeleteAccountDialog=!0},children:(0,d.jsx)(l.Oj,{name:"delete-account"})})]})}),(0,d.jsx)(a.ii,{children:(0,d.jsx)(c.$,{onClick:()=>{e.openUserSettingsDialog=!1},children:(0,d.jsx)(l.Oj,{name:"cancel"})})})]})}))},8567:(e,t,n)=>{n.d(t,{I:()=>c});var o=n(69229),r=n(63696),s=n(50119),i=n(59061),l=n(83445),a=n(62540);const c=(0,o.PA)((()=>{const{arrangeViewStore:e,pianoRollStore:t}=(0,i.g)(),n=(0,s.s0)(),o=(0,r.useCallback)((()=>e.openVelocityDialog=!1),[e]),c=(0,r.useCallback)(((t,o)=>{n({type:o,value:t}),e.openVelocityDialog=!1}),[e,n]);return(0,a.jsx)(l.y,{open:e.openVelocityDialog,value:t.newNoteVelocity,onClickOK:c,onClose:o})}))},47953:(e,t,n)=>{n.d(t,{G:()=>c});var o=n(69229),r=n(63696),s=n(50119),i=n(59061),l=n(83445),a=n(62540);const c=(0,o.PA)((()=>{const{pianoRollStore:e}=(0,i.g)(),t=(0,s.Qm)(),n=(0,r.useCallback)((()=>e.openVelocityDialog=!1),[e]),o=(0,r.useCallback)(((n,o)=>{t({type:o,value:n}),e.openVelocityDialog=!1}),[e,t]);return(0,a.jsx)(l.y,{open:e.openVelocityDialog,value:e.newNoteVelocity,onClickOK:o,onClose:n})}))},83445:(e,t,n)=>{n.d(t,{y:()=>p});var o=n(46287),r=n(63696),s=n(97233),i=n(66459),l=n(5513),a=n(70612),c=n(57499),d=n(62540);const u=(0,o.A)("div",{target:"e6sxpgh1"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"}),h=(0,o.A)("div",{target:"e6sxpgh0"})({name:"1u1z6e7",styles:"display:flex;gap:2rem"}),p=e=>{let{open:t,value:n,onClickOK:o,onClose:p}=e;const[m,g]=(0,r.useState)("set"),[x,w]=(0,r.useState)(n);(0,r.useEffect)((()=>{t&&w(n)}),[t]);const f=(0,r.useCallback)((()=>{o(x,m),p()}),[x,m]);return(0,d.jsxs)(i.lG,{open:t,style:{minWidth:"20rem"},children:[(0,d.jsx)(i.L3,{children:(0,d.jsx)(s.Oj,{name:"velocity"})}),(0,d.jsx)(i.Cf,{children:(0,d.jsxs)(u,{children:[(0,d.jsx)(c.l,{value:x,onChange:w,style:{flexGrow:1},onEnter:f}),(0,d.jsxs)(h,{children:[(0,d.jsx)(a.a,{label:(0,d.jsx)(s.Oj,{name:"operation-set"}),isSelected:"set"===m,onClick:()=>g("set")}),(0,d.jsx)(a.a,{label:(0,d.jsx)(s.Oj,{name:"operation-add"}),isSelected:"add"===m,onClick:()=>g("add")}),(0,d.jsx)(a.a,{label:(0,d.jsx)(s.Oj,{name:"operation-multiply"}),isSelected:"multiply"===m,onClick:()=>g("multiply")})]})]})}),(0,d.jsxs)(i.ii,{children:[(0,d.jsx)(l.$,{onClick:p,children:(0,d.jsx)(s.Oj,{name:"cancel"})}),(0,d.jsx)(l.$,{onClick:f,children:(0,d.jsx)(s.Oj,{name:"ok"})})]})]})}},50029:(e,t,n)=>{n.d(t,{Q:()=>s});var o=n(63696),r=n(62540);const s=e=>{let{value:t,min:n,max:s,step:i,id:l,onChange:a,onEnter:c,style:d,className:u}=e;const[h,p]=(0,o.useState)(t),m=e=>{p(g(e)),e===t||isNaN(e)||a(e)},g=e=>Math.max(n??Number.NEGATIVE_INFINITY,Math.min(s??Number.POSITIVE_INFINITY,e));return(0,o.useEffect)((()=>{p(t)}),[t]),(0,r.jsx)("input",{type:"number",id:l,min:n,max:s,value:h,step:i,onChange:e=>{m(g(parseFloat(e.target.value)))},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur(),c?.())},onBlur:()=>{isNaN(h)&&m(n??0)},style:d,className:u})}},49422:(e,t,n)=>{n.d(t,{J:()=>y,j:()=>v});var o=n(46287),r=n(96604),s=n.n(r),i=n(39751),l=n.n(i),a=n(81381),c=n.n(a),d=n(56988),u=n.n(d),h=n(63696),p=n(20038),m=n(62540);const g=(0,o.A)("div",{target:"e1pbbrg70"})({name:"6kybrt",styles:"display:flex;align-items:center;justify-content:center;>svg{width:15px;height:15px;transform:scale(0.8);}"}),x=e=>{const t=(0,h.useRef)(null),n=s()(t),o=p.ZW,r=n.width-3*o,i={width:o,height:o};return(0,m.jsxs)(p.$H,{ref:t,isVertical:!1,...e,barLength:r,children:[(0,m.jsx)(g,{style:i,onClick:e.onClickScaleDown,children:(0,m.jsx)(u(),{})}),(0,m.jsx)(g,{style:i,onClick:e.onClickScaleReset,children:(0,m.jsx)(c(),{})}),(0,m.jsx)(g,{style:i,onClick:e.onClickScaleUp,children:(0,m.jsx)(l(),{})})]})},w=e=>{const t=(0,h.useRef)(null),n=s()(t),o=p.ZW,r=n.height-3*o,i={width:o,height:o};return(0,m.jsxs)(p.$H,{ref:t,isVertical:!0,...e,barLength:r,children:[(0,m.jsx)(g,{style:i,onClick:e.onClickScaleUp,children:(0,m.jsx)(l(),{})}),(0,m.jsx)(g,{style:i,onClick:e.onClickScaleReset,children:(0,m.jsx)(c(),{})}),(0,m.jsx)(g,{style:i,onClick:e.onClickScaleDown,children:(0,m.jsx)(u(),{})})]})},f=(e,t)=>e.scrollOffset===t.scrollOffset&&e.contentLength===t.contentLength&&e.onScroll===t.onScroll&&e.onClickScaleDown===t.onClickScaleDown&&e.onClickScaleReset===t.onClickScaleReset&&e.onClickScaleUp===t.onClickScaleUp,v=h.memo(x,f),y=h.memo(w,f)},20038:(e,t,n)=>{n.d(t,{$H:()=>w,ZW:()=>u,fJ:()=>y});var o=n(46287),r=n(96604),s=n.n(r),i=n(19401),l=n.n(i),a=n(63696),c=n(54015),d=n(62540);const u=17,h=u;function p(e){return Math.max(0,Math.min(1,e))}const m=(0,o.A)("div",{target:"eku4sek1"})({name:"1khn195",styles:"box-sizing:border-box"}),g=(0,o.A)("div",{target:"eku4sek0"})("height:100%;width:100%;position:absolute;display:flex;&.vertical{width:",u,"px;height:100%;position:absolute;top:0;right:0;flex-direction:column;.button-backward .triangle{transform:rotate(0deg) scale(1.1);}.button-forward .triangle{transform:rotate(180deg) scale(1.1);}}&.horizontal{width:100%;height:",u,"px;position:absolute;bottom:0;left:0;flex-direction:row;&>div{height:100%;}.button-backward .triangle{transform:rotate(-90deg) scale(1.1);}.button-forward .triangle{transform:rotate(90deg) scale(1.1);}}.triangle{flex-grow:1;pointer-events:none;width:15px;height:15px;}.button-backward,.button-forward{text-align:center;align-content:center;display:flex;}"),x=(e,t)=>{let{isVertical:n,barLength:o,scrollOffset:r=50,contentLength:s=1e3,onScroll:i,children:a}=e;const u=s-o,x=o-30,w=p(o/s),f=Math.max(h,x*w),v=u<=0;let y,j;v?(y=0,j=x):(y=Math.floor((x-f)*p(r/u)),j=Math.floor(x-f-y));const k=n?"vertical":"horizontal",b=n?"height":"width",C=e=>i?.(Math.min(u,Math.max(0,e))),S=e=>t=>{if(t.stopPropagation(),v)return;const n=t.target,o=function(e){return{x:e.pageX,y:e.pageY}}(t);let s=0,i=r;C(i+=e);const l=()=>document.elementFromPoint(o.x,o.y)===n,a=()=>{clearInterval(s),s=0};(e=>{s=window.setInterval((()=>{clearInterval(s),l()&&(C(i+=e),s=window.setInterval((()=>{C(i+=.5*e),l()||a()}),50))}),300)})(e),(0,c.b)({onMouseMove:e=>{n!==e.target&&a()},onMouseUp:()=>{a()}})},R=(0,d.jsx)(l(),{className:"triangle"});return(0,d.jsxs)(g,{ref:t,className:`ScrollBar ${k}`,children:[(0,d.jsx)("div",{className:"button-backward",style:{[b]:15},onMouseDown:S(-20),children:R}),(0,d.jsx)("div",{className:"page-backward",style:{[b]:y},onMouseDown:S(-80)}),!v&&(0,d.jsx)(m,{className:"thumb",style:{[b]:f},onMouseDown:e=>{if(e.stopPropagation(),!v&&e.target.classList.contains("thumb")){const t=r;(0,c.R)(e.nativeEvent,{onMouseMove:(e,o)=>{const r=u/(x-f),s=t+o[n?"y":"x"]*r;C(s)}})}}}),(0,d.jsx)("div",{className:"page-forward",style:{[b]:j},onMouseDown:S(80)}),(0,d.jsx)("div",{className:"button-forward",style:{[b]:15},onMouseDown:S(20),children:R}),a]})},w=a.forwardRef(x),f=e=>{const t=(0,a.useRef)(null),n=s()(t);return(0,d.jsx)(w,{ref:t,isVertical:!1,...e,barLength:n.width})},v=(e,t)=>e.scrollOffset===t.scrollOffset&&e.contentLength===t.contentLength&&e.onScroll===t.onScroll,y=a.memo(f,v)},55747:(e,t,n)=>{n.d(t,{F:()=>h});var o=n(46287),r=n(79478),s=n.n(r),i=n(32354),l=n.n(i),a=n(62540);const c=(0,o.A)("div",{target:"e1rivfrc1"})("background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";display:flex;padding:1rem;border-radius:0.5rem;line-height:1.5;"),d=e=>{let{severity:t,...n}=e;switch(t){case"info":return(0,a.jsx)(l(),{...n});case"warning":return(0,a.jsx)(s(),{...n})}},u=(0,o.A)("div",{target:"e1rivfrc0"})({name:"to3ihi",styles:"flex-grow:1;display:flex;align-items:center"}),h=e=>{let{children:t,severity:n,...o}=e;return(0,a.jsxs)(c,{...o,children:[(0,a.jsx)(d,{severity:n,style:{marginRight:"1rem",flexShrink:"0"}}),(0,a.jsx)(u,{children:t})]})}},5513:(e,t,n)=>{n.d(t,{$:()=>i,j:()=>l});var o=n(46287),r=n(44308),s=n.n(r);const i=(0,o.A)("button",{target:"e12ykc301"})("display:flex;align-items:center;background:transparent;border:none;border-radius:0.2rem;color:",(e=>{let{theme:t}=e;return t.textColor}),";padding:0.5rem 1rem;cursor:pointer;height:2rem;outline:none;font-size:0.8rem;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}&:active{background:",(e=>{let{theme:t}=e;return s()(t.secondaryBackgroundColor).lighten(.1).hex()}),";}"),l=(0,o.A)(i,{target:"e12ykc300"})("background:",(e=>{let{theme:t}=e;return t.themeColor}),";color:",(e=>{let{theme:t}=e;return t.onSurfaceColor}),";&:hover{background:",(e=>{let{theme:t}=e;return s()(t.themeColor).darken(.1).hex()}),";}&:active{background:",(e=>{let{theme:t}=e;return s()(t.themeColor).darken(.2).hex()}),";}")},16066:(e,t,n)=>{n.d(t,{S:()=>p});var o=n(46287),r=n(61209),s=n(95352),i=n.n(s),l=n(15467),a=n(62540);const c=(0,o.A)(r.bL,{target:"e1fjc8rk3"})("border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";background-color:",(e=>{let{theme:t}=e;return t.backgroundColor}),";width:1.5rem;height:1.5rem;border-radius:0.25rem;display:flex;align-items:center;justify-content:center;&:hover{border-color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}"),d=(0,o.A)(r.C1,{target:"e1fjc8rk2"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),u=(0,o.A)(i(),{target:"e1fjc8rk1"})("fill:",(e=>{let{theme:t}=e;return t.textColor}),";width:1rem;height:1rem;"),h=(0,o.A)("span",{target:"e1fjc8rk0"})({name:"uaob3j",styles:"margin-left:0.5rem"}),p=e=>{let{label:t,style:n,...o}=e;return(0,a.jsxs)(l.J,{style:{display:"flex",alignItems:"center",...n},children:[(0,a.jsx)(c,{...o,children:(0,a.jsx)(d,{children:(0,a.jsx)(u,{})})}),(0,a.jsx)(h,{children:t})]})}},571:(e,t,n)=>{n.d(t,{P:()=>i});var o=n(83785),r=n(34446),s=n(62540);const i=e=>{let{size:t="2rem"}=e;const n=(0,o.u)();return(0,s.jsx)(r.A,{style:{width:t,height:t},color:n.themeColor})}},27061:(e,t,n)=>{n.d(t,{D:()=>h});var o=n(46287),r=n(20994),s=n(63696),i=n(97233),l=n(5513),a=n(62540);const c=(0,o.A)("div",{target:"ex1t7oo2"})({name:"5thnkd",styles:"display:flex;flex-grow:1"}),d=(0,o.A)("input",{target:"ex1t7oo1"})({name:"1fuj9tb",styles:"flex-grow:1;border:none;border-radius:0.2rem;padding:0.5rem 1rem;font-size:0.8rem;outline:none;margin-right:0.5rem"}),u=(0,o.A)("div",{target:"ex1t7oo0"})(""),h=e=>{let{text:t}=e;const n=(0,r.dj)(),o=(0,i.B2)(),h=(0,s.useCallback)((()=>{navigator.clipboard.writeText(t),n.success(o.copied)}),[t]);return(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{type:"text",value:t,readOnly:!0,onFocus:e=>{e.target.select()}}),(0,a.jsx)(u,{children:(0,a.jsx)(l.j,{onClick:h,children:(0,a.jsx)(i.Oj,{name:"copy"})})})]})}},13906:(e,t,n)=>{n.d(t,{K:()=>o});const o=(0,n(46287).A)("button",{target:"e1pg8lm40"})("width:2rem;height:2rem;display:flex;align-items:center;justify-content:center;border:none;border-radius:999px;background:none;color:",(e=>{let{theme:t,active:n}=e;return n?t.textColor:t.secondaryTextColor}),";cursor:pointer;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}")},15467:(e,t,n)=>{n.d(t,{J:()=>o});const o=(0,n(46287).A)("label",{target:"e1xwgi3w0"})("display:block;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:0.8rem;font-family:inherit;")},24343:(e,t,n)=>{n.d(t,{h:()=>o});const o=(0,n(46287).A)("progress",{target:"e1fs5k4i0"})("width:100%;-moz-appearance:none;-webkit-appearance:none;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";&::-webkit-progress-bar{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border-radius:0.25rem;height:0.5rem;}&::-webkit-progress-value{background:",(e=>{let{theme:t}=e;return t.themeColor}),";border-radius:0.25rem;height:100%;}border:none;border-radius:0.25rem;height:0.5rem;box-sizing:border-box;&::-moz-progress-bar{background:",(e=>{let{theme:t}=e;return t.themeColor}),";border-radius:0.25rem;height:100%;}")},87944:(e,t,n)=>{n.d(t,{C:()=>a});var o=n(46287),r=n(45432),s=n(27061),i=n(62540);const l=(0,o.A)("div",{target:"e12tas5b0"})({name:"106oewt",styles:"margin-top:1rem;display:grid;grid-template-columns:repeat(auto-fill, minmax(32px, 1fr));grid-gap:0.5rem;&>button:hover{opacity:0.8;}"}),a=e=>{let{url:t,text:n}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.D,{text:t}),(0,i.jsxs)(l,{children:[(0,i.jsx)(r.r6,{url:t,title:n,children:(0,i.jsx)(r.uv,{size:32,round:!0})}),(0,i.jsx)(r.uI,{url:t,children:(0,i.jsx)(r.ik,{size:32,round:!0})}),(0,i.jsx)(r.Kz,{url:t,title:n,children:(0,i.jsx)(r.Y4,{size:32,round:!0})}),(0,i.jsx)(r.rx,{url:t,title:n,children:(0,i.jsx)(r.Hu,{size:32,round:!0})}),(0,i.jsx)(r.mJ,{url:t,title:n,children:(0,i.jsx)(r.aT,{size:32,round:!0})}),(0,i.jsx)(r.Ot,{url:t,subject:"Check out this song on signal",children:(0,i.jsx)(r.aZ,{size:32,round:!0})})]})]})}},94724:(e,t,n)=>{n.d(t,{Dr:()=>u,Nj:()=>h,W1:()=>c,_e:()=>y,g8:()=>v});var o=n(46287),r=n(91785),s=n(4955),i=(n(63696),n(62540));const l=(0,o.A)(s.UC,{target:"egxm11s6"})("min-width:8rem;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border-radius:0.5rem;box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.popupBorderColor}),";margin:0 1rem;padding:0.5rem 0;"),a=(0,o.A)("ul",{target:"egxm11s5"})({name:"v5al3",styles:"list-style:none;padding:0;margin:0"}),c=e=>{let{trigger:t,open:n,onOpenChange:o,children:r}=e;return(0,i.jsxs)(s.bL,{open:n,onOpenChange:o,children:[(0,i.jsx)(s.l9,{asChild:!0,children:t}),(0,i.jsx)(s.ZL,{children:(0,i.jsx)(l,{children:(0,i.jsx)(a,{children:r})})})]})},d=(0,o.A)("li",{target:"egxm11s4"})("font-size:0.8rem;color:",(e=>{let{theme:t,disabled:n}=e;return n?t.secondaryTextColor:t.textColor}),";display:flex;align-items:center;padding:0.5rem 1rem;pointer-events:",(e=>{let{disabled:t}=e;return t?"none":"auto"}),";cursor:pointer;&:hover{background:",(e=>{let{theme:t,disabled:n}=e;return n?"transparent":t.highlightColor}),";}"),u=e=>{let{children:t,...n}=e;return(0,i.jsx)(d,{...n,children:t})},h=(0,o.A)("hr",{target:"egxm11s3"})("border:none;border-top:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";"),p=r.i7`
	from {
		opacity: 0;
		transform: translateY(2px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
`,m=r.i7`
	from {
		opacity: 0;
		transform: translateX(-2px);
	}
	to {
		opacity: 1;
		transform: translateX(0);
	}
`,g=r.i7`
	from {
		opacity: 0;
		transform: translateY(-2px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
`,x=r.i7`
	from {
		opacity: 0;
		transform: translateX(2px);
	}
	to {
		opacity: 1;
		transform: translateX(0);
	}
`,w=(0,o.A)(s.G5,{target:"egxm11s2"})('min-width:8rem;border-radius:6px;box-shadow:0px 10px 38px -10px rgba(22, 23, 24, 0.35),0px 10px 20px -15px rgba(22, 23, 24, 0.2);animation-duration:400ms;animation-timing-function:cubic-bezier(0.16, 1, 0.3, 1);will-change:transform,opacity;&[data-side="top"]{animation-name:',g,';}&[data-side="bottom"]{animation-name:',p,';}$[data-side="left"]{animation-name:',m,';}&[data-side="right"]{animation-name:',x,";}background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border-radius:0.5rem;box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.popupBorderColor}),";padding:0.5rem 0;"),f=(0,o.A)(s.ZP,{target:"egxm11s1"})({name:"12mkfdx",styles:"outline:none"}),v=e=>{let{trigger:t,children:n}=e;return(0,i.jsxs)(s.Pb,{children:[(0,i.jsx)(f,{children:t}),(0,i.jsx)(s.ZL,{children:(0,i.jsx)(w,{sideOffset:-4,alignOffset:-4,children:(0,i.jsx)(a,{children:n})})})]})},y=(0,o.A)("div",{target:"egxm11s0"})("font-size:0.9em;flex-grow:1;text-align:right;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";margin-left:2em;")},70612:(e,t,n)=>{n.d(t,{a:()=>u});var o=n(46287),r=n(89472),s=n.n(r),i=n(62540);const l=(0,o.A)("div",{target:"egmu54m3"})("display:inline-flex;width:1.25rem;height:1.25rem;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";align-items:center;justify-content:center;border-radius:9999px;"),a=(0,o.A)(s(),{target:"egmu54m2"})("fill:",(e=>{let{theme:t}=e;return t.textColor}),";width:0.7rem;height:0.7rem;"),c=(0,o.A)("div",{target:"egmu54m1"})("display:flex;padding:0.5rem 0;align-items:center;&:hover ",l,"{border-color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}"),d=(0,o.A)("span",{target:"egmu54m0"})("margin-left:0.5rem;font-size:0.8rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),u=e=>{let{label:t,isSelected:n,onClick:o}=e;return(0,i.jsxs)(c,{onClick:o,children:[(0,i.jsx)(l,{children:n&&(0,i.jsx)(a,{})}),(0,i.jsx)(d,{children:t})]})}},95881:(e,t,n)=>{n.d(t,{l:()=>d});var o=n(46287),r=n(10716),s=n.n(r),i=n(62540);const l=(0,o.A)("select",{target:"evg0ddz2"})("display:block;width:100%;appearance:none;border:none;background:inherit;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";border-radius:0.25rem;height:3rem;padding:0 1rem;display:flex;align-items:center;justify-content:center;box-sizing:border-box;color:inherit;font-size:1rem;font-family:inherit;outline:none;&:focus{border-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}option{color:",(e=>{let{theme:t}=e;return t.textColor}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";}"),a=(0,o.A)(s(),{target:"evg0ddz1"})({name:"6watob",styles:"position:absolute;right:0.5rem;top:0.8rem;pointer-events:none"}),c=(0,o.A)("div",{target:"evg0ddz0"})({name:"bjn8wh",styles:"position:relative"}),d=e=>(0,i.jsxs)(c,{children:[(0,i.jsx)(l,{...e}),(0,i.jsx)(a,{})]})},60962:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(46287),r=n(99245),s=n(62540);const i=(0,o.A)(r.bL,{target:"e1kkyjvb4"})({name:"qb5ck1",styles:"position:relative;display:flex;flex-grow:1;align-items:center;user-select:none;touch-action:none;height:2rem"}),l=(0,o.A)(r.CC,{target:"e1kkyjvb3"})("background-color:",(e=>{let{theme:t}=e;return t.tertiaryTextColor}),";position:relative;flex-grow:1;border-radius:9999px;height:0.1rem;"),a=(0,o.A)(r.Q6,{target:"e1kkyjvb2"})("position:absolute;background-color:",(e=>{let{theme:t}=e;return t.textColor}),";border-radius:9999px;height:100%;"),c=(0,o.A)(r.zi,{target:"e1kkyjvb1"})("display:block;width:0.75rem;height:0.75rem;background-color:",(e=>{let{theme:t}=e;return t.textColor}),";box-shadow:0 0.1rem 1rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";border-radius:999px;&:hover{background-color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}&:focus{outline:none;}"),d=(0,o.A)("div",{target:"e1kkyjvb0"})("width:0.1rem;height:100%;position:absolute;background-color:",(e=>{let{theme:t}=e;return t.textColor}),";"),u=e=>{let{value:t,onChange:n,defaultValue:o,marks:r,...u}=e;return(0,s.jsxs)(i,{value:[t],defaultValue:void 0!==o?[o]:void 0,onValueChange:e=>n(e[0]),...u,children:[(0,s.jsxs)(l,{children:[(0,s.jsx)(a,{}),r?.map(((e,t)=>(0,s.jsx)(d,{style:{left:e/(u.max??100)*100+"%"}},t)))]}),(0,s.jsx)(c,{tabIndex:-1})]})}},57499:(e,t,n)=>{n.d(t,{l:()=>s});var o=n(46287),r=n(50029);const s=(0,o.A)(r.Q,{target:"e1izyqwe0"})("display:block;appearance:none;border:none;background:inherit;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";border-radius:0.25rem;height:3rem;padding:0 1rem;align-items:center;justify-content:center;box-sizing:border-box;color:inherit;font-size:1rem;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";outline:none;&:focus{border-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}")},4830:(e,t,n)=>{n.d(t,{A:()=>o});const o=(0,n(46287).A)("input",{target:"ev1z3q10"})("display:block;appearance:none;border:none;background:inherit;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";border-radius:0.25rem;height:3rem;padding:0 1rem;align-items:center;justify-content:center;box-sizing:border-box;color:inherit;font-size:1rem;font-family:inherit;outline:none;&:focus{border-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}")},77684:(e,t,n)=>{n.d(t,{y:()=>k});var o=n(46287),r=n(91785),s=n(83785),i=n(22538),l=n(57890),a=n.n(l),c=n(79478),d=n.n(c),u=n(54112),h=n.n(u),p=n(32354),m=n.n(p),g=n(63696),x=n(62540);const w=r.i7`
  from {
    opacity: 0;
    transform: translate(0, 0.5rem) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translate(0, 0) scale(1);
  }
`,f=r.i7`
  from {
    opacity: 1;
    transform: translate(0, 0) scale(1);
  }
  to {
    opacity: 0;
    transform: translate(0, 0.5rem) scale(0.96);
  }
`,v=(0,o.A)(i.b,{target:"euru6zc1"})({name:"sgtmti",styles:"position:fixed;bottom:2rem;left:0;right:0;display:flex"}),y=(0,o.A)("div",{target:"euru6zc0"})("margin:0 auto;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";padding:1rem;border-radius:0.5rem;font-size:0.8rem;box-shadow:0 0.5rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";display:flex;align-items:center;animation:",(e=>{let{show:t}=e;return t?w:f})," 500ms cubic-bezier(0.16, 1, 0.3, 1) forwards;"),j=e=>{let{severity:t}=e;const n=(0,s.u)(),o=b(t,n);switch(t){case"error":return(0,x.jsx)(a(),{style:{fill:o}});case"info":return(0,x.jsx)(m(),{style:{fill:o}});case"success":return(0,x.jsx)(h(),{style:{fill:o}});case"warning":return(0,x.jsx)(d(),{style:{fill:o}})}},k=e=>{let{message:t,severity:n,onExited:o}=e;const[r,s]=(0,g.useState)(!0);return(0,g.useEffect)((()=>{const e=setTimeout((()=>s(!1)),4500),t=setTimeout(o,5e3);return()=>{clearTimeout(e),clearTimeout(t)}})),(0,x.jsx)(v,{children:(0,x.jsxs)(y,{show:r,children:[(0,x.jsx)(j,{severity:n}),(0,x.jsx)("div",{style:{width:"0.5rem"}}),t]})})},b=(e,t)=>{switch(e){case"error":return t.redColor;case"info":return t.textColor;case"success":return t.greenColor;case"warning":return t.yellowColor}}},96016:(e,t,n)=>{n.d(t,{m:()=>c});var o=n(46287),r=n(70791),s=n(44308),i=n.n(s),l=n(62540);const a=(0,o.A)(r.UC,{target:"e116mko0"})("background:",(e=>{let{theme:t}=e;return i()(t.backgroundColor).darken(.2).hex()}),";color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";padding:0.5rem;border-radius:0.5rem;box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";"),c=e=>{let{children:t,title:n,side:o="bottom",...s}=e;return(0,l.jsx)(r.Kq,{...s,children:(0,l.jsxs)(r.bL,{children:[(0,l.jsx)(r.l9,{asChild:!0,children:t}),(0,l.jsx)(r.ZL,{children:(0,l.jsx)(a,{side:o,sideOffset:5,children:n})})]})})}},86738:(e,t,n)=>{n.d(t,{HN:()=>a,UX:()=>l,lU:()=>s,wi:()=>i});var o=n(38038),r=n(51930);const s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cg-wheatstone-30";const n=r.n[t].layout,o=[];return n.forEach((t=>{i(t.push,e)&&o.push("push"),i(t.pull,e)&&o.push("pull")})),o.includes("push")&&o.includes("pull")?"both":o.includes("push")?"push":o.includes("pull")?"pull":void 0},i=(e,t)=>o.IN.toMidi(e)===o.IN.toMidi(t),l=(e,t)=>{let n=0,o=-1,r=0;for(const s of e.layout){if(s.newRow?(n++,o=0):o++,r===t)return{row:n,col:o};r++}throw new Error("Index out of bounds")},a=(e,t,n)=>{const o=l(e,t);let r=-1,s=1/0;return e.layout.forEach(((t,i)=>{if(!n.includes(i))return;const a=l(e,i),c=Math.abs(o.row-a.row)+Math.abs(o.col-a.col);c<s&&(s=c,r=i)})),{index:r,distance:s}}},51930:(e,t,n)=>{n.d(t,{n:()=>o});const o={"cg-wheatstone-30":{title:"CG Wheatstone 30",layout:[{push:"E3",pull:"F3",x:30,newRow:!1,cooverNotationId:{hand:"left",id:"1a"}},{push:"A3",pull:"Bb3",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"2a"}},{push:"C#4",pull:"D#4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"3a"}},{push:"A4",pull:"G4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"4a"}},{push:"G#4",pull:"Bb4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"5a"}},{push:"C#5",pull:"D#5",x:50,newRow:!1,cooverNotationId:{hand:"right",id:"1a"}},{push:"A5",pull:"G5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"2a"}},{push:"G#5",pull:"Bb5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"3a"}},{push:"C#6",pull:"D#6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"4a"}},{push:"A6",pull:"F6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"5a"}},{push:"C3",pull:"G3",x:15,newRow:!0,cooverNotationId:{hand:"left",id:"1"}},{push:"G3",pull:"B3",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"2"}},{push:"C4",pull:"D4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"3"}},{push:"E4",pull:"F4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"4"}},{push:"G4",pull:"A4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"5"}},{push:"C5",pull:"B4",x:80,newRow:!1,cooverNotationId:{hand:"right",id:"1"}},{push:"E5",pull:"D5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"2"}},{push:"G5",pull:"F5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"3"}},{push:"C6",pull:"A5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"4"}},{push:"E6",pull:"B5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"5"}},{push:"B3",pull:"A3",x:0,newRow:!0,cooverNotationId:{hand:"left",id:"6"}},{push:"D4",pull:"F#4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"7"}},{push:"G4",pull:"A4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"8"}},{push:"B4",pull:"C5",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"9"}},{push:"D5",pull:"E5",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"10"}},{push:"G5",pull:"F#5",x:110,newRow:!1,cooverNotationId:{hand:"right",id:"6"}},{push:"B5",pull:"A5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"7"}},{push:"D6",pull:"C6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"8"}},{push:"G6",pull:"E6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"9"}},{push:"B6",pull:"F#6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"10"}}]},"cg-jeffries-30":{title:"CG Jeffries 30",layout:[{push:"E3",pull:"F3",x:30,newRow:!1,cooverNotationId:{hand:"left",id:"1a"}},{push:"A3",pull:"Bb3",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"2a"}},{push:"C#4",pull:"D#4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"3a"}},{push:"A4",pull:"G4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"4a"}},{push:"G#4",pull:"Bb4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"5a"}},{push:"D#5",pull:"C#5",x:50,newRow:!1,cooverNotationId:{hand:"right",id:"1a"}},{push:"C#5",pull:"D#5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"2a"}},{push:"G#5",pull:"G5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"3a"}},{push:"C#6",pull:"Bb5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"4a"}},{push:"A5",pull:"D6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"5a"}},{push:"C3",pull:"G3",x:15,newRow:!0,cooverNotationId:{hand:"left",id:"1"}},{push:"G3",pull:"B3",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"2"}},{push:"C4",pull:"D4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"3"}},{push:"E4",pull:"F4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"4"}},{push:"G4",pull:"A4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"5"}},{push:"C5",pull:"B4",x:80,newRow:!1,cooverNotationId:{hand:"right",id:"1"}},{push:"E5",pull:"D5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"2"}},{push:"G5",pull:"F5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"3"}},{push:"C6",pull:"A5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"4"}},{push:"E6",pull:"B5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"5"}},{push:"B3",pull:"A3",x:0,newRow:!0,cooverNotationId:{hand:"left",id:"6"}},{push:"D4",pull:"F#4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"7"}},{push:"G4",pull:"A4",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"8"}},{push:"B4",pull:"C5",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"9"}},{push:"D5",pull:"E5",x:0,newRow:!1,cooverNotationId:{hand:"left",id:"10"}},{push:"G5",pull:"F#5",x:110,newRow:!1,cooverNotationId:{hand:"right",id:"6"}},{push:"B5",pull:"A5",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"7"}},{push:"D6",pull:"C6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"8"}},{push:"G6",pull:"E6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"9"}},{push:"B6",pull:"F#6",x:0,newRow:!1,cooverNotationId:{hand:"right",id:"10"}}]},"cg-wheatstone-40":{title:"CG Wheatstone 40",layout:[{push:"E3",pull:"F3",x:30,newRow:!1},{push:"A3",pull:"Bb3",x:0,newRow:!1},{push:"C#4",pull:"D#4",x:0,newRow:!1},{push:"A4",pull:"G4",x:0,newRow:!1},{push:"G#4",pull:"Bb4",x:0,newRow:!1},{push:"F#4",pull:"C#4",x:0,newRow:!1},{push:"F#5",pull:"C#5",x:50,newRow:!1},{push:"C#5",pull:"D#5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"G#5",pull:"Bb5",x:0,newRow:!1},{push:"C#6",pull:"D#6",x:0,newRow:!1},{push:"A6",pull:"F6",x:0,newRow:!1},{push:"C7",pull:"D6",x:0,newRow:!1},{push:"C3",pull:"G3",x:15,newRow:!0},{push:"G3",pull:"B3",x:0,newRow:!1},{push:"C4",pull:"D4",x:0,newRow:!1},{push:"E4",pull:"F4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"Bb4",pull:"C#5",x:0,newRow:!1},{push:"F5",pull:"G4",x:80,newRow:!1},{push:"C5",pull:"B4",x:0,newRow:!1},{push:"E5",pull:"D5",x:0,newRow:!1},{push:"G5",pull:"F5",x:0,newRow:!1},{push:"C6",pull:"A5",x:0,newRow:!1},{push:"E6",pull:"B5",x:0,newRow:!1},{push:"B3",pull:"A3",x:0,newRow:!0},{push:"D4",pull:"F#4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"B4",pull:"C5",x:0,newRow:!1},{push:"D5",pull:"E5",x:0,newRow:!1},{push:"F4",pull:"G#4",x:0,newRow:!1},{push:"Bb5",pull:"G#5",x:110,newRow:!1},{push:"G5",pull:"F#5",x:0,newRow:!1},{push:"B5",pull:"A5",x:0,newRow:!1},{push:"D6",pull:"C6",x:0,newRow:!1},{push:"G6",pull:"E6",x:0,newRow:!1},{push:"B6",pull:"F#6",x:0,newRow:!1},{push:"C4",pull:"C4",x:330,newRow:!0},{push:"D#5",pull:"A4",x:160,newRow:!1},{push:"D5",pull:"E5",x:55,newRow:!1}]},"cg-jeffries-38":{title:"CG Jeffries 38",layout:[{push:"E3",pull:"F3",x:30,newRow:!1},{push:"A3",pull:"Bb3",x:0,newRow:!1},{push:"C#4",pull:"D#4",x:0,newRow:!1},{push:"A4",pull:"G4",x:0,newRow:!1},{push:"G#4",pull:"Bb4",x:0,newRow:!1},{push:"D#5",pull:"C#5",x:170,newRow:!1},{push:"C#5",pull:"D#5",x:0,newRow:!1},{push:"G#5",pull:"G5",x:0,newRow:!1},{push:"C#6",pull:"Bb5",x:0,newRow:!1},{push:"A5",pull:"D6",x:0,newRow:!1},{push:"C3",pull:"G3",x:15,newRow:!0},{push:"G3",pull:"B3",x:0,newRow:!1},{push:"C4",pull:"D4",x:0,newRow:!1},{push:"E4",pull:"F4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"Bb4",pull:"Bb3",x:0,newRow:!1},{push:"F#5",pull:"A4",x:80,newRow:!1},{push:"C5",pull:"B4",x:0,newRow:!1},{push:"E5",pull:"D5",x:0,newRow:!1},{push:"G5",pull:"F5",x:0,newRow:!1},{push:"C6",pull:"A5",x:0,newRow:!1},{push:"E6",pull:"B5",x:0,newRow:!1},{push:"F5",pull:"E5",x:0,newRow:!1},{push:"B3",pull:"A3",x:0,newRow:!0},{push:"D4",pull:"F#4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"B4",pull:"C5",x:0,newRow:!1},{push:"D5",pull:"E5",x:0,newRow:!1},{push:"F#4",pull:"G#4",x:0,newRow:!1},{push:"D5",pull:"C5",x:110,newRow:!1},{push:"G5",pull:"F#5",x:0,newRow:!1},{push:"B5",pull:"A5",x:0,newRow:!1},{push:"D6",pull:"C6",x:0,newRow:!1},{push:"G6",pull:"E6",x:0,newRow:!1},{push:"B6",pull:"F#6",x:0,newRow:!1},{push:"D#4",pull:"E4",x:145,newRow:!0},{push:"C4",pull:"C4",x:125,newRow:!1},{push:"F#6",pull:"F6",x:220,newRow:!1}]},"gd-wheatstone-30":{title:"GD Wheatstone 30",layout:[{push:"B2",pull:"C3",x:30,newRow:!1},{push:"E3",pull:"F3",x:0,newRow:!1},{push:"G#3",pull:"Bb3",x:0,newRow:!1},{push:"E4",pull:"D4",x:0,newRow:!1},{push:"D#4",pull:"F4",x:0,newRow:!1},{push:"G#4",pull:"Bb4",x:50,newRow:!1},{push:"E5",pull:"D5",x:0,newRow:!1},{push:"D#5",pull:"F5",x:0,newRow:!1},{push:"G#5",pull:"Bb5",x:0,newRow:!1},{push:"E6",pull:"C6",x:0,newRow:!1},{push:"G2",pull:"D3",x:15,newRow:!0},{push:"D3",pull:"F#3",x:0,newRow:!1},{push:"G3",pull:"A3",x:0,newRow:!1},{push:"B3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"G4",pull:"F#4",x:80,newRow:!1},{push:"B4",pull:"A4",x:0,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"G5",pull:"E5",x:0,newRow:!1},{push:"B5",pull:"F#5",x:0,newRow:!1},{push:"F#3",pull:"E3",x:0,newRow:!0},{push:"A3",pull:"C#4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F#4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"B4",x:0,newRow:!1},{push:"D5",pull:"C#5",x:110,newRow:!1},{push:"F#5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"B5",x:0,newRow:!1},{push:"F#6",pull:"C#6",x:0,newRow:!1}]},"gd-jeffries-30":{title:"GD Jeffries 30",layout:[{push:"B2",pull:"C3",x:30,newRow:!1},{push:"E3",pull:"F3",x:0,newRow:!1},{push:"G#3",pull:"Bb3",x:0,newRow:!1},{push:"E4",pull:"D4",x:0,newRow:!1},{push:"D#4",pull:"F4",x:0,newRow:!1},{push:"Bb4",pull:"G#4",x:50,newRow:!1},{push:"G#4",pull:"Bb4",x:0,newRow:!1},{push:"D#5",pull:"D5",x:0,newRow:!1},{push:"G#5",pull:"F5",x:0,newRow:!1},{push:"Bb5",pull:"A5",x:0,newRow:!1},{push:"G2",pull:"D3",x:15,newRow:!0},{push:"D3",pull:"F#3",x:0,newRow:!1},{push:"G3",pull:"A3",x:0,newRow:!1},{push:"B3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"G4",pull:"F#4",x:80,newRow:!1},{push:"B4",pull:"A4",x:0,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"G5",pull:"E5",x:0,newRow:!1},{push:"B5",pull:"F#5",x:0,newRow:!1},{push:"F#3",pull:"E3",x:0,newRow:!0},{push:"A3",pull:"C#4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F#4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"B4",x:0,newRow:!1},{push:"D5",pull:"C#5",x:110,newRow:!1},{push:"F#5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"B5",x:0,newRow:!1},{push:"F#6",pull:"C#6",x:0,newRow:!1}]},"gd-wheatstone-40":{title:"GD Wheatstone 40",layout:[{push:"B2",pull:"C3",x:30,newRow:!1},{push:"E3",pull:"F3",x:0,newRow:!1},{push:"G#3",pull:"Bb3",x:0,newRow:!1},{push:"E4",pull:"D4",x:0,newRow:!1},{push:"D#4",pull:"F4",x:0,newRow:!1},{push:"C#4",pull:"G#3",x:0,newRow:!1},{push:"C#5",pull:"G#4",x:50,newRow:!1},{push:"G#4",pull:"Bb4",x:0,newRow:!1},{push:"E5",pull:"D5",x:0,newRow:!1},{push:"D#5",pull:"F5",x:0,newRow:!1},{push:"G#5",pull:"Bb5",x:0,newRow:!1},{push:"E6",pull:"C6",x:0,newRow:!1},{push:"G6",pull:"A5",x:0,newRow:!1},{push:"G2",pull:"D3",x:15,newRow:!0},{push:"D3",pull:"F#3",x:0,newRow:!1},{push:"G3",pull:"A3",x:0,newRow:!1},{push:"B3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F4",pull:"G#4",x:0,newRow:!1},{push:"C5",pull:"D4",x:80,newRow:!1},{push:"G4",pull:"F#4",x:0,newRow:!1},{push:"B4",pull:"A4",x:0,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"G5",pull:"E5",x:0,newRow:!1},{push:"B5",pull:"F#5",x:0,newRow:!1},{push:"F#3",pull:"E3",x:0,newRow:!0},{push:"A3",pull:"C#4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F#4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"B4",x:0,newRow:!1},{push:"C4",pull:"D#4",x:0,newRow:!1},{push:"F5",pull:"D#5",x:110,newRow:!1},{push:"D5",pull:"C#5",x:0,newRow:!1},{push:"F#5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"B5",x:0,newRow:!1},{push:"F#6",pull:"C#6",x:0,newRow:!1},{push:"G3",pull:"G3",x:330,newRow:!0},{push:"Bb4",pull:"E4",x:160,newRow:!1},{push:"A4",pull:"B4",x:55,newRow:!1}]},"gd-jeffries-38":{title:"GD Jeffries 38",layout:[{push:"B2",pull:"C3",x:30,newRow:!1},{push:"E3",pull:"F3",x:0,newRow:!1},{push:"G#3",pull:"Bb3",x:0,newRow:!1},{push:"E4",pull:"D4",x:0,newRow:!1},{push:"D#4",pull:"F4",x:0,newRow:!1},{push:"Bb4",pull:"G#4",x:170,newRow:!1},{push:"G#4",pull:"Bb4",x:0,newRow:!1},{push:"D#5",pull:"D5",x:0,newRow:!1},{push:"G#5",pull:"F5",x:0,newRow:!1},{push:"Bb5",pull:"A5",x:0,newRow:!1},{push:"G2",pull:"D3",x:15,newRow:!0},{push:"D3",pull:"F#3",x:0,newRow:!1},{push:"G3",pull:"A3",x:0,newRow:!1},{push:"B3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F4",pull:"F3",x:0,newRow:!1},{push:"C#5",pull:"E4",x:80,newRow:!1},{push:"G4",pull:"F#4",x:0,newRow:!1},{push:"B4",pull:"A4",x:0,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"G5",pull:"E5",x:0,newRow:!1},{push:"B5",pull:"F#5",x:0,newRow:!1},{push:"C5",pull:"B4",x:0,newRow:!1},{push:"F#3",pull:"E3",x:0,newRow:!0},{push:"A3",pull:"C#4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F#4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"B4",x:0,newRow:!1},{push:"C#4",pull:"D#4",x:0,newRow:!1},{push:"A4",pull:"G4",x:110,newRow:!1},{push:"D5",pull:"C#5",x:0,newRow:!1},{push:"F#5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"B5",x:0,newRow:!1},{push:"F#6",pull:"C#6",x:0,newRow:!1},{push:"Bb3",pull:"B3",x:145,newRow:!0},{push:"G3",pull:"G3",x:125,newRow:!1},{push:"C#6",pull:"C6",x:220,newRow:!1}]},"bbf-wheatstone-30":{title:"BbF Wheatstone 30",layout:[{push:"D3",pull:"D#3",x:30,newRow:!1},{push:"G3",pull:"G#3",x:0,newRow:!1},{push:"B3",pull:"C#4",x:0,newRow:!1},{push:"G4",pull:"F4",x:0,newRow:!1},{push:"F#4",pull:"G#4",x:0,newRow:!1},{push:"B4",pull:"C#5",x:50,newRow:!1},{push:"G5",pull:"F5",x:0,newRow:!1},{push:"F#5",pull:"G#5",x:0,newRow:!1},{push:"B5",pull:"C#6",x:0,newRow:!1},{push:"G6",pull:"D#6",x:0,newRow:!1},{push:"Bb2",pull:"F3",x:15,newRow:!0},{push:"F3",pull:"A3",x:0,newRow:!1},{push:"Bb3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"D#4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"Bb4",pull:"A4",x:80,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"F5",pull:"D#5",x:0,newRow:!1},{push:"Bb5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"A5",x:0,newRow:!1},{push:"A3",pull:"G3",x:0,newRow:!0},{push:"C4",pull:"E4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"Bb4",x:0,newRow:!1},{push:"C5",pull:"D5",x:0,newRow:!1},{push:"F5",pull:"E5",x:110,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"C6",pull:"Bb5",x:0,newRow:!1},{push:"F6",pull:"D6",x:0,newRow:!1},{push:"A6",pull:"E6",x:0,newRow:!1}]},"bbf-jeffries-30":{title:"BbF Jeffries 30",layout:[{push:"D3",pull:"D#3",x:30,newRow:!1},{push:"G3",pull:"G#3",x:0,newRow:!1},{push:"B3",pull:"C#4",x:0,newRow:!1},{push:"G4",pull:"F4",x:0,newRow:!1},{push:"F#4",pull:"G#4",x:0,newRow:!1},{push:"C#5",pull:"B4",x:50,newRow:!1},{push:"B4",pull:"C#5",x:0,newRow:!1},{push:"F#5",pull:"F5",x:0,newRow:!1},{push:"B5",pull:"G#5",x:0,newRow:!1},{push:"C#6",pull:"C6",x:0,newRow:!1},{push:"Bb2",pull:"F3",x:15,newRow:!0},{push:"F3",pull:"A3",x:0,newRow:!1},{push:"Bb3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"D#4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"Bb4",pull:"A4",x:80,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"F5",pull:"D#5",x:0,newRow:!1},{push:"Bb5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"A5",x:0,newRow:!1},{push:"A3",pull:"G3",x:0,newRow:!0},{push:"C4",pull:"E4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"Bb4",x:0,newRow:!1},{push:"C5",pull:"D5",x:0,newRow:!1},{push:"F5",pull:"E5",x:110,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"C6",pull:"Bb5",x:0,newRow:!1},{push:"F6",pull:"D6",x:0,newRow:!1},{push:"A6",pull:"E6",x:0,newRow:!1}]},"bbf-wheatstone-40":{title:"BbF Wheatstone 40",layout:[{push:"D3",pull:"D#3",x:30,newRow:!1},{push:"G3",pull:"G#3",x:0,newRow:!1},{push:"B3",pull:"C#4",x:0,newRow:!1},{push:"G4",pull:"F4",x:0,newRow:!1},{push:"F#4",pull:"G#4",x:0,newRow:!1},{push:"E4",pull:"B3",x:0,newRow:!1},{push:"E5",pull:"B4",x:50,newRow:!1},{push:"B4",pull:"C#5",x:0,newRow:!1},{push:"G5",pull:"F5",x:0,newRow:!1},{push:"F#5",pull:"G#5",x:0,newRow:!1},{push:"B5",pull:"C#6",x:0,newRow:!1},{push:"G6",pull:"D#6",x:0,newRow:!1},{push:"Bb6",pull:"C6",x:0,newRow:!1},{push:"Bb2",pull:"F3",x:15,newRow:!0},{push:"F3",pull:"A3",x:0,newRow:!1},{push:"Bb3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"D#4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"G#4",pull:"B4",x:0,newRow:!1},{push:"D#5",pull:"F4",x:80,newRow:!1},{push:"Bb4",pull:"A4",x:0,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"F5",pull:"D#5",x:0,newRow:!1},{push:"Bb5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"A5",x:0,newRow:!1},{push:"A3",pull:"G3",x:0,newRow:!0},{push:"C4",pull:"E4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"Bb4",x:0,newRow:!1},{push:"C5",pull:"D5",x:0,newRow:!1},{push:"D#4",pull:"F#4",x:0,newRow:!1},{push:"G#5",pull:"F#5",x:110,newRow:!1},{push:"F5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"C6",pull:"Bb5",x:0,newRow:!1},{push:"F6",pull:"D6",x:0,newRow:!1},{push:"A6",pull:"E6",x:0,newRow:!1},{push:"Bb3",pull:"Bb3",x:330,newRow:!0},{push:"C#5",pull:"G4",x:160,newRow:!1},{push:"C5",pull:"D5",x:55,newRow:!1}]},"bbf-jeffries-38":{title:"BbF Jeffries 38",layout:[{push:"D3",pull:"D#3",x:30,newRow:!1},{push:"G3",pull:"G#3",x:0,newRow:!1},{push:"B3",pull:"C#4",x:0,newRow:!1},{push:"G4",pull:"F4",x:0,newRow:!1},{push:"F#4",pull:"G#4",x:0,newRow:!1},{push:"C#5",pull:"B4",x:170,newRow:!1},{push:"B4",pull:"C#5",x:0,newRow:!1},{push:"F#5",pull:"F5",x:0,newRow:!1},{push:"B5",pull:"G#5",x:0,newRow:!1},{push:"C#6",pull:"C6",x:0,newRow:!1},{push:"Bb2",pull:"F3",x:15,newRow:!0},{push:"F3",pull:"A3",x:0,newRow:!1},{push:"Bb3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"D#4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"G#4",pull:"G#3",x:0,newRow:!1},{push:"E5",pull:"G4",x:80,newRow:!1},{push:"Bb4",pull:"A4",x:0,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"F5",pull:"D#5",x:0,newRow:!1},{push:"Bb5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"A5",x:0,newRow:!1},{push:"D#5",pull:"D5",x:0,newRow:!1},{push:"A3",pull:"G3",x:0,newRow:!0},{push:"C4",pull:"E4",x:0,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"Bb4",x:0,newRow:!1},{push:"C5",pull:"D5",x:0,newRow:!1},{push:"E4",pull:"F#4",x:0,newRow:!1},{push:"C5",pull:"Bb4",x:110,newRow:!1},{push:"F5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"C6",pull:"Bb5",x:0,newRow:!1},{push:"F6",pull:"D6",x:0,newRow:!1},{push:"A6",pull:"E6",x:0,newRow:!1},{push:"C#4",pull:"D4",x:145,newRow:!0},{push:"Bb3",pull:"Bb3",x:125,newRow:!1},{push:"E6",pull:"D#6",x:220,newRow:!1}]},jones:{title:'G. Jones "Improved Anglo"',layout:[{push:"E3",pull:"F3",x:30,newRow:!1},{push:"A3",pull:"A3",x:0,newRow:!1},{push:"G#3",pull:"Bb3",x:0,newRow:!1},{push:"C#4",pull:"C#4",x:0,newRow:!1},{push:"D#4",pull:"D#4",x:0,newRow:!1},{push:"G#4",pull:"G#4",x:0,newRow:!1},{push:"Bb4",pull:"Bb4",x:0,newRow:!1},{push:"A5",pull:"G5",x:70,newRow:!1},{push:"C#5",pull:"C#5",x:0,newRow:!1},{push:"D#5",pull:"D#5",x:0,newRow:!1},{push:"G#5",pull:"G#5",x:0,newRow:!1},{push:"Bb5",pull:"Bb5",x:0,newRow:!1},{push:"C#6",pull:"C#6",x:0,newRow:!1},{push:"D#6",pull:"D6",x:0,newRow:!1},{push:"Bb3",pull:"C4",x:0,newRow:!0},{push:"C3",pull:"G3",x:0,newRow:!1},{push:"G3",pull:"B3",x:0,newRow:!1},{push:"C4",pull:"D4",x:0,newRow:!1},{push:"E4",pull:"F4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"A4",pull:"G4",x:0,newRow:!1},{push:"F#5",pull:"F#5",x:70,newRow:!1},{push:"C5",pull:"B4",x:0,newRow:!1},{push:"E5",pull:"D5",x:0,newRow:!1},{push:"G5",pull:"F5",x:0,newRow:!1},{push:"C6",pull:"A5",x:0,newRow:!1},{push:"E6",pull:"B5",x:0,newRow:!1},{push:"C7",pull:"F6",x:0,newRow:!1},{push:"B3",pull:"D4",x:30,newRow:!0},{push:"D4",pull:"F#4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"B4",pull:"C5",x:0,newRow:!1},{push:"D5",pull:"E5",x:0,newRow:!1},{push:"F4",pull:"E4",x:0,newRow:!1},{push:"F#4",pull:"F#4",x:0,newRow:!1},{push:"F5",pull:"F5",x:70,newRow:!1},{push:"G5",pull:"F#5",x:0,newRow:!1},{push:"B5",pull:"A5",x:0,newRow:!1},{push:"D6",pull:"C6",x:0,newRow:!1},{push:"G6",pull:"E6",x:0,newRow:!1},{push:"B6",pull:"F#6",x:0,newRow:!1},{push:"G#6",pull:"A6",x:0,newRow:!1}]},"cg-20":{title:"CG 20",layout:[{push:"C3",pull:"G3",x:20,newRow:!1},{push:"G3",pull:"B3",x:0,newRow:!1},{push:"C4",pull:"D4",x:0,newRow:!1},{push:"E4",pull:"F4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"C5",pull:"B4",x:70,newRow:!1},{push:"E5",pull:"D5",x:0,newRow:!1},{push:"G5",pull:"F5",x:0,newRow:!1},{push:"C6",pull:"A5",x:0,newRow:!1},{push:"E6",pull:"B5",x:0,newRow:!1},{push:"G3",pull:"D4",x:0,newRow:!0},{push:"D4",pull:"F#4",x:0,newRow:!1},{push:"G4",pull:"A4",x:0,newRow:!1},{push:"B4",pull:"C5",x:0,newRow:!1},{push:"D5",pull:"E5",x:0,newRow:!1},{push:"G5",pull:"F#5",x:110,newRow:!1},{push:"B5",pull:"A5",x:0,newRow:!1},{push:"D6",pull:"C6",x:0,newRow:!1},{push:"G6",pull:"E6",x:0,newRow:!1},{push:"B6",pull:"F#6",x:0,newRow:!1}]},"gd-20":{title:"GD 20",layout:[{push:"G2",pull:"D3",x:20,newRow:!1},{push:"D3",pull:"F#3",x:0,newRow:!1},{push:"G3",pull:"A3",x:0,newRow:!1},{push:"B3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"G4",pull:"F#4",x:70,newRow:!1},{push:"B4",pull:"A4",x:0,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"G5",pull:"E5",x:0,newRow:!1},{push:"B5",pull:"F#5",x:0,newRow:!1},{push:"D3",pull:"A3",x:0,newRow:!0},{push:"A3",pull:"C#4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F#4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"B4",x:0,newRow:!1},{push:"D5",pull:"C#5",x:110,newRow:!1},{push:"F#5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"B5",x:0,newRow:!1},{push:"F#6",pull:"C#6",x:0,newRow:!1}]},"da-20":{title:"DA 20",layout:[{push:"D3",pull:"A3",x:20,newRow:!1},{push:"A3",pull:"C#4",x:0,newRow:!1},{push:"D4",pull:"E4",x:0,newRow:!1},{push:"F#4",pull:"G4",x:0,newRow:!1},{push:"A4",pull:"B4",x:0,newRow:!1},{push:"D5",pull:"C#5",x:70,newRow:!1},{push:"F#5",pull:"E5",x:0,newRow:!1},{push:"A5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"B5",x:0,newRow:!1},{push:"F#6",pull:"C#6",x:0,newRow:!1},{push:"A3",pull:"E4",x:0,newRow:!0},{push:"E4",pull:"G#4",x:0,newRow:!1},{push:"A4",pull:"B4",x:0,newRow:!1},{push:"C#5",pull:"D5",x:0,newRow:!1},{push:"E5",pull:"F#5",x:0,newRow:!1},{push:"A5",pull:"G#5",x:110,newRow:!1},{push:"C#6",pull:"B5",x:0,newRow:!1},{push:"E6",pull:"D6",x:0,newRow:!1},{push:"A6",pull:"F#6",x:0,newRow:!1},{push:"C#7",pull:"G#6",x:0,newRow:!1}]},squashbox:{title:"Zulu Squashbox",layout:[{push:"D#2",pull:"Bb2",x:20,newRow:!1},{push:"Bb2",pull:"D3",x:0,newRow:!1},{push:"D#3",pull:"F3",x:0,newRow:!1},{push:"G3",pull:"G#3",x:0,newRow:!1},{push:"Bb3",pull:"C4",x:0,newRow:!1},{push:"D4",pull:"D#4",x:70,newRow:!1},{push:"F4",pull:"G4",x:0,newRow:!1},{push:"G#4",pull:"Bb4",x:0,newRow:!1},{push:"C5",pull:"D5",x:0,newRow:!1},{push:"D5",pull:"G5",x:0,newRow:!1},{push:"F3",pull:"Bb2",x:0,newRow:!0},{push:"A3",pull:"F3",x:0,newRow:!1},{push:"C4",pull:"Bb3",x:0,newRow:!1},{push:"D#4",pull:"D4",x:0,newRow:!1},{push:"G4",pull:"F4",x:0,newRow:!1},{push:"Bb4",pull:"A4",x:110,newRow:!1},{push:"D5",pull:"C5",x:0,newRow:!1},{push:"F5",pull:"D#5",x:0,newRow:!1},{push:"Bb5",pull:"G5",x:0,newRow:!1},{push:"D6",pull:"A5",x:0,newRow:!1}]}}},76646:(e,t,n)=>{n.d(t,{d:()=>r});var o=n(52188);let r;(r||(r={})).createInRange=(e,t,n)=>{const r=[],s=o.t.getMeasuresInRange(e,n);return s.forEach(((e,o)=>{const i=s[o+1],l=4*t/e.denominator,a=i?i.tick:n[1],c=Math.max(0,Math.floor((n[0]-e.tick)/l)),d=(a-e.tick)/l;for(let t=c;t<d;t++){const n=e.tick+l*t;r.push({measure:e.measure+Math.floor(t/e.numerator),beat:t%e.numerator,tick:n})}})),r}},8660:(e,t,n)=>{n.d(t,{B:()=>s});var o=n(71229),r=n(76646);let s;(s||(s={})).createInRange=(e,t,n,s,i)=>r.d.createInRange(e,n,o.Q.fromLength(t.getTick(s),t.getTick(i))).map((e=>({...e,x:Math.round(t.getX(e.tick))})))},29909:(e,t,n)=>{n.d(t,{a:()=>s});var o=n(6358),r=n(22095);let s;var i;(i=s||(s={})).getEventFactory=e=>t=>{switch(e.type){case"pitchBend":return(0,o.fJ)(0,0,Math.round(t));case"controller":return(0,o.Q9)(0,0,e.controllerType,Math.round(t))}},i.getEventPredicate=e=>{switch(e.type){case"pitchBend":return r.Y6;case"controller":return(0,r.HG)(e.controllerType)}},i.equals=(e,t)=>{switch(e.type){case"pitchBend":return"pitchBend"===t.type;case"controller":return"controller"===t.type&&e.controllerType===t.controllerType}}},51382:(e,t,n)=>{let o;var r;n.d(t,{b:()=>o}),(r=o||(o={})).sub=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},r.add=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},r.zero={x:0,y:0}},71229:(e,t,n)=>{let o;var r;n.d(t,{Q:()=>o}),(r=o||(o={})).fromLength=function(e,t){return[e,e+t]},r.create=function(e,t){return[e,t]},r.point=function(e){return[e,e]},r.contains=function(e,t){const[n,o]=e;return n<=t&&t<o},r.intersects=function(e,t){const[n,o]=e,[r,s]=t;return n<s&&r<o},r.clamp=function(e,t){const[n,o]=e;return Math.min(Math.max(n,t),o)}},70480:(e,t,n)=>{let o;n.d(t,{r:()=>o}),function(e){function t(e){return e.x+e.width}function n(e){return e.y+e.height}function r(e){return{x:t(e),y:n(e)}}e.containsPoint=function(e,t){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},e.right=t,e.bottom=n,e.intersects=function(e,o){return t(e)>o.x&&t(o)>e.x&&n(e)>o.y&&n(o)>e.y},e.containsRect=function(e,t){return o.containsPoint(e,t)&&o.containsPoint(e,r(t))},e.br=r,e.fromPoints=function(e,t){const n=Math.min(e.x,t.x),o=Math.max(e.x,t.x),r=Math.min(e.y,t.y);return{x:n,y:r,width:o-n,height:Math.max(e.y,t.y)-r}},e.scale=function(e,t,n){return{x:e.x*t,y:e.y*n,width:e.width*t,height:e.height*n}},e.zero={x:0,y:0,width:0,height:0},e.move=function(e,t){return{x:e.x+t.x,y:e.y+t.y,width:e.width,height:e.height}}}(o||(o={}))},52188:(e,t,n)=>{let o;n.d(t,{t:()=>o}),function(e){const t={tick:0,measure:0,denominator:4,numerator:4};e.fromTimeSignatures=function(e,n){if(0===e.length)return[t];{let t=0;return e.map(((o,r)=>{let s=0;if(r>0){const i=e[r-1],l=4*n/i.denominator,a=Math.floor((o.tick-i.tick)/l/i.numerator);s=t+a,t=s}return{tick:o.tick,measure:s,numerator:o.numerator,denominator:o.denominator}}))}},e.getMBTString=function(e,t,o){return(arguments.length>3&&void 0!==arguments[3]?arguments[3]:s)(n(e,t,o))},e.getMeasuresInRange=(e,n)=>{let o=0;const r=[];for(const s of e){const i=e[o+1];if(o++,0===r.length){if(void 0!==i&&i.tick<=n[0])continue;s.tick>n[0]?(console.warn("There is no initial time signature. Use 4/4 by default"),r.push(t)):r.push(s)}if(0!==r.length){if(!(s.tick<=n[1]))break;r.push(s)}}return r};const n=(e,n,o)=>((e,t,n)=>{const o=4*n/e.denominator,r=o*e.numerator;let s=t-e.tick;const i=Math.floor(s/r);s-=i*r;const l=Math.floor(s/o);return s-=l*o,{measure:e.measure+i,beat:l,tick:s}})(i(e,n)??t,n,o);function o(e,n,o){const r=i(e,n)??t,s=4*o/r.denominator*r.numerator,l=Math.floor((n-r.tick)/s);return{tick:r.tick+s*l,duration:s,ticksPerBeat:4*o/r.denominator,eventTick:r.tick,numerator:r.numerator}}e.getMeasureStart=o,e.getPreviousMeasureTick=function(e,t,n){const r=o(e,t,n);return t>r.tick+r.ticksPerBeat?r.tick:o(e,r.tick-1,n).tick},e.getNextMeasureTick=function(e,t,n){const r=o(e,t,n);return r.tick+r.duration}}(o||(o={}));const r=(e,t)=>{const n=e.toFixed(0);return("0".repeat(t)+n).slice(-Math.max(t,n.length))};function s(e){return`${r(e.measure+1,4)}:${r(e.beat+1,2)}:${r(e.tick,3)}`}function i(e,t){let n=null;for(const o of e){if(o.tick>t)break;n=o}return n}},64659:(e,t,n)=>{n.d(t,{u:()=>r});var o=n(54164);let r;(r||(r={})).getIntervals=e=>o.F.getIntegerNotation(e.scale).map((t=>(t+e.key)%12))},54164:(e,t,n)=>{n.d(t,{F:()=>o});let o;var r;(r=o||(o={})).values=["major","minor","harmonicMajor","harmonicMinor","melodicMinor","ionian","dorian","phrygian","lydian","mixolydian","aeolian","locrian","majorPentatonic","minorPentatonic","majorBlues","minorBlues","halfWholeDiminished","wholeHalfDiminished","wholeTone"],r.getIntegerNotation=e=>{switch(e){case"major":case"ionian":return[0,2,4,5,7,9,11];case"minor":case"aeolian":return[0,2,3,5,7,8,10];case"harmonicMinor":return[0,2,3,5,7,8,11];case"harmonicMajor":return[0,2,4,5,7,8,11];case"melodicMinor":return[0,2,3,5,7,9,11];case"dorian":return[0,2,3,5,7,9,10];case"phrygian":return[0,1,3,5,7,8,10];case"lydian":return[0,2,4,6,7,9,11];case"mixolydian":return[0,2,4,5,7,9,10];case"locrian":return[0,1,3,5,6,8,10];case"majorPentatonic":return[0,2,4,7,9];case"minorPentatonic":return[0,3,5,7,10];case"majorBlues":return[0,2,3,4,7,9];case"minorBlues":return[0,3,5,6,7,10];case"halfWholeDiminished":return[0,1,3,4,6,7,9,10];case"wholeHalfDiminished":return[0,2,3,5,6,8,9,11];case"wholeTone":return[0,2,4,6,8,10]}}},95949:(e,t,n)=>{let o;n.d(t,{p:()=>o}),function(e){e.fromPoints=function(e,r,s,i){const l=t(e,s),a=t(r,s);return o(n(l,a),i)};const t=e.fromPoint=(e,t)=>({fromTick:t.floor(e.tick),toTick:t.ceil(e.tick),fromTrackIndex:Math.floor(e.trackIndex),toTrackIndex:Math.floor(e.trackIndex)+1}),n=e.union=(e,t)=>({fromTick:Math.min(e.fromTick,t.fromTick),toTick:Math.max(e.toTick,t.toTick),fromTrackIndex:Math.min(e.fromTrackIndex,t.fromTrackIndex),toTrackIndex:Math.max(e.toTrackIndex,t.toTrackIndex)}),o=e.clamp=(e,t)=>({fromTick:Math.max(0,e.fromTick),toTick:Math.max(0,e.toTick),fromTrackIndex:Math.min(t,Math.max(0,e.fromTrackIndex)),toTrackIndex:Math.min(t,Math.max(0,e.toTrackIndex))});e.moved=(e,t)=>({fromTick:e.fromTick+t.tick,toTick:e.toTick+t.tick,fromTrackIndex:e.fromTrackIndex+t.trackIndex,toTrackIndex:e.toTrackIndex+t.trackIndex}),e.start=function(e){return{tick:e.fromTick,trackIndex:e.fromTrackIndex}},e.end=function(e){return{tick:e.toTick,trackIndex:e.toTrackIndex}}}(o||(o={}))},40540:(e,t,n)=>{n.d(t,{L:()=>s});var o=n(17243),r=n(92770);let s;var i;(i=s||(s={})).getBounds=(e,t)=>{const n=t.getX(e.fromTick),o=t.getX(e.toTick),r=t.getY(e.fromNoteNumber);return{x:n,y:r,width:o-n,height:t.getY(e.toNoteNumber)-r}},i.moved=(e,t,n)=>({fromTick:e.fromTick+t,fromNoteNumber:e.fromNoteNumber+n,toTick:e.toTick+t,toNoteNumber:e.toNoteNumber+n}),i.fromPoints=function(e,t){const n=Math.min(e.tick,t.tick),s=Math.max(e.tick,t.tick),i=Math.ceil(Math.max(e.noteNumber,t.noteNumber)),l=Math.floor(Math.min(e.noteNumber,t.noteNumber));return{fromTick:Math.max(0,n),fromNoteNumber:(0,o.clamp)(i,-1,r.a2),toTick:Math.max(0,s),toNoteNumber:(0,o.clamp)(l,-1,r.a2)}},i.getFrom=function(e){return{tick:e.fromTick,noteNumber:e.fromNoteNumber}},i.getTo=function(e){return{tick:e.toTick,noteNumber:e.toNoteNumber}}},6463:(e,t,n)=>{let o;n.d(t,{w:()=>o}),(o||(o={})).getBounds=(e,t)=>{const n=t.getX(e.fromTick);return{x:n,y:0,width:t.getX(e.toTick)-n,height:t.height}}},20883:(e,t,n)=>{n.d(t,{w:()=>o});class o{constructor(e,t){this.transform=e,this.pixelsPerTrack=t}getX(e){return this.transform.getX(e)}getY(e){return e*this.pixelsPerTrack}getTick(e){return this.transform.getTick(e)}getTrackIndex(e){return e/this.pixelsPerTrack}getArrangePoint(e){return{tick:this.getTick(e.x),trackIndex:this.getTrackIndex(e.y)}}}},30876:(e,t,n)=>{let o;var r;n.d(t,{n:()=>o}),(r=o||(o={})).sub=function(e,t){return{tick:e.tick-t.tick,trackIndex:e.trackIndex-t.trackIndex}},r.clamp=function(e,t){return{tick:Math.max(0,e.tick),trackIndex:Math.max(0,Math.min(t,e.trackIndex))}}},67178:(e,t,n)=>{n.d(t,{d:()=>o});class o{constructor(e,t,n,o){this.transform=e,this.maxValue=t,this.height=n,this.lineWidth=o}getX(e){return this.transform.getX(e)}getTick(e){return Math.floor(this.transform.getTick(e))}getY(e){return(1-e/this.maxValue)*(this.height-2*this.lineWidth)+this.lineWidth}getValue(e){return Math.floor((1-(e-this.lineWidth)/(this.height-2*this.lineWidth))*this.maxValue)}toPosition(e,t){return{x:Math.round(this.getX(e)),y:Math.round(this.getY(t))}}fromPosition(e){return{tick:this.getTick(e.x),value:this.getValue(e.y)}}transformSelection(e){const t=this.getX(e.fromTick);return{x:t,y:0,width:this.getX(e.toTick)-t,height:this.height}}}},48077:(e,t,n)=>{n.d(t,{a:()=>o});class o{constructor(e,t,n){this.pixelsPerTick=e,this.pixelsPerKey=t,this.maxNoteNumber=n}getX(e){return e*this.pixelsPerTick}getY(e){return(this.maxNoteNumber-e)*this.pixelsPerKey}getTick(e){return e/this.pixelsPerTick}getNoteNumber(e){return Math.ceil(this.getNoteNumberFractional(e))}getNoteNumberFractional(e){return this.maxNoteNumber-e/this.pixelsPerKey}getDeltaNoteNumber(e){return-e/this.pixelsPerKey}get numberOfKeys(){return this.maxNoteNumber+1}getMaxY(){return this.numberOfKeys*this.pixelsPerKey}getRect(e){return{x:this.getX(e.tick),y:this.getY(e.noteNumber),width:this.getX(e.duration),height:this.pixelsPerKey}}getDrumRect(e){return{x:this.getX(e.tick)-this.pixelsPerKey/2,y:this.getY(e.noteNumber),width:this.pixelsPerKey,height:this.pixelsPerKey}}getNotePoint(e){return{tick:this.getTick(e.x),noteNumber:this.getNoteNumber(e.y)}}getNotePointFractional(e){return{tick:this.getTick(e.x),noteNumber:this.getNoteNumberFractional(e.y)}}equals(e){return this.pixelsPerKey===e.pixelsPerKey&&this.pixelsPerTick===e.pixelsPerTick&&this.maxNoteNumber===e.maxNoteNumber}get horizontalId(){return this.pixelsPerTick}}},3354:(e,t,n)=>{n.d(t,{T:()=>r});var o=n(2265);let r;var s;(s=r||(r={})).clamp=e=>({tick:Math.max(0,e.tick),noteNumber:o.i.clamp(e.noteNumber)}),s.equals=function(e,t){return e.tick===t.tick&&e.noteNumber===t.noteNumber},s.sub=function(e,t){return{tick:e.tick-t.tick,noteNumber:e.noteNumber-t.noteNumber}},s.add=function(e,t){return{tick:e.tick+t.tick,noteNumber:e.noteNumber+t.noteNumber}}},81220:(e,t,n)=>{n.d(t,{L:()=>o});class o{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:320;this.pixelsPerTick=e,this.height=t,this.maxBPM=n}getX(e){return e*this.pixelsPerTick}getY(e){return(1-e/this.maxBPM)*this.height}getMaxY(){return this.height}getTick(e){return e/this.pixelsPerTick}getBPM(e){return(1-e/this.height)*this.maxBPM}getDeltaBPM(e){return-e/this.height*this.maxBPM}equals(e){return this.pixelsPerTick===e.pixelsPerTick&&this.height===e.height&&this.maxBPM===e.maxBPM}fromPosition(e){return{tick:this.getTick(e.x),bpm:this.getBPM(e.y)}}}},2265:(e,t,n)=>{n.d(t,{i:()=>r});var o=n(92770);let r;var s;(s=r||(r={})).clamp=e=>Math.min(o.a2,Math.max(0,e)),s.isValid=e=>e>=0&&e<=o.a2},52932:(e,t,n)=>{n.d(t,{Cn:()=>u,j2:()=>c,kA:()=>d});var o=n(64913),r=n(17354),s=n(491),i=n(45271);const l={apiKey:"MISSING_ENV_VAR".FIREBASE_API_KEY,authDomain:"MISSING_ENV_VAR".FIREBASE_AUTH_DOMAIN,projectId:"MISSING_ENV_VAR".FIREBASE_PROJECT_ID,storageBucket:"MISSING_ENV_VAR".FIREBASE_STORAGE_BUCKET,messagingSenderId:"MISSING_ENV_VAR".FIREBASE_MESSAGING_SENDER_ID,appId:"MISSING_ENV_VAR".FIREBASE_APP_ID},a=(()=>{try{const e=(0,o.Wp)(l),t=(0,r.xI)(e);return{app:e,auth:t,firestore:(0,s.aU)(e),functions:(0,i.Uz)(e)}}catch(e){console.warn(`Failed to initialize Firebase: ${e}`)}return{app:null,auth:null,firestore:null,functions:null}})(),c=(a.app,a.auth),d=a.firestore,u=a.functions},72343:(e,t,n)=>{n.d(t,{B:()=>o,N:()=>r});const o=e=>{const t=e.rgb().array();return[t[0]/255,t[1]/255,t[2]/255,e.alpha()]},r=(e,t,n)=>t?e.lighten(n):e.darken(n)},80406:(e,t,n)=>{function o(e,t){const n=window.URL.createObjectURL(e);!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"noname";const n=document.createElement("a");n.href=e,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),n.remove()}(n,t),setTimeout((()=>window.URL.revokeObjectURL(n)),1e3)}n.d(t,{W:()=>o})},20604:(e,t,n)=>{function o(e){return null!==e}function r(e){return void 0!==e}n.d(t,{EA:()=>r,F9:()=>s,Pe:()=>o,Q6:()=>i});const s=(e,t)=>{const n=[];for(let o=0;o<e.length;o++)n.push(e[o]),o<e.length-1&&n.push(t(e[o],e[o+1]));return n},i=(e,t,n)=>{const o=[];for(let r=e;r<=t;r+=n)o.push(r);return o}},26556:(e,t,n)=>{n.d(t,{M:()=>r,bU:()=>i,w4:()=>s});const o=6e7;function r(e){return o/e}function s(e){return o/e}function i(e,t,n){return e/(n/60)/t*1e3}},30013:(e,t,n)=>{n.d(t,{X:()=>i,l:()=>l});var o=n(38257),r=n(17243),s=n(46952);const i=async e=>{const t=new o.x3(e.numberOfChannels,e.sampleRate,128),n=[],[s,i]=[e.getChannelData(0),e.getChannelData(1)],l=new Int16Array(s.length),a=new Int16Array(i.length),c=Math.max((0,r.max)(s.map((e=>Math.abs(e))))??0,(0,r.max)(i.map((e=>Math.abs(e))))??0);for(let e=0;e<s.length;e++)l[e]=s[e]/c*32767.5,a[e]=i[e]/c*32767.5;const d=1152;for(let e=0;e<l.length;e+=d){const o=l.subarray(e,e+d),r=a.subarray(e,e+d),s=t.encodeBuffer(o,r);s.length>0&&n.push(s)}const u=t.flush();return u.length>0&&n.push(u),function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let o=0;for(const t of e)n.set(t,o),o+=t.length;return n}(n)},l=async e=>await(0,s.l)({sampleRate:e.sampleRate,channelData:[e.getChannelData(0),e.getChannelData(1)]})},51046:(e,t,n)=>{n.d(t,{F:()=>r,L:()=>s});var o=n(71229);const r=e=>t=>o.Q.contains(e,t.tick),s=e=>t=>{if("duration"in t&&"number"==typeof t.duration){const n=t.tick+t.duration,r=o.Q.create(t.tick,n);return o.Q.intersects(e,r)}return o.Q.contains(e,t.tick)}},28632:(e,t,n)=>{n.d(t,{L:()=>s});var o=n(50416),r=n(70429);const s=(e,t)=>{const n=o.vt();return o.kN(n,r.fA(e,t,0)),n}},12968:(e,t,n)=>{n.d(t,{i:()=>o});const o=e=>({x:e.clientX,y:e.clientY})},28011:(e,t,n)=>{n.d(t,{C:()=>s,f:()=>r});var o=n(6358);function r(e){const t=[],n=[];return e.forEach((e=>{if("subtype"in e)switch(e.subtype){case"noteOn":t.push(e);break;case"noteOff":{const o=function(e){const n=t.findIndex((t=>t.noteNumber===e.noteNumber));if(n<0)return null;const o=t[n];return t.splice(n,1),o}(e);if(null!=o){const t={...o,subtype:"note",id:-1,tick:o.tick,duration:e.tick-o.tick};n.push(t)}break}default:n.push(e)}else n.push(e)})),n}function s(e){if("subtype"in e&&"note"===e.subtype){const t=e.channel??-1,n=(0,o.d1)(0,t,e.noteNumber,e.velocity),r=(0,o.dG)(0,t,e.noteNumber);return[{...n,tick:e.tick},{...r,tick:e.tick+e.duration}]}return[e]}},44569:(e,t,n)=>{n.d(t,{bF:()=>s,mi:()=>i});var o=n(10962);const r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function s(e){const t=Math.floor(e/12)-1;return`${r[e%12]}${t}`}function i(e){return o.ZG[e]}},54015:(e,t,n)=>{n.d(t,{R:()=>i,b:()=>s});var o=n(51382),r=n(12968);const s=e=>{let{onMouseMove:t,onMouseUp:n,onClick:o}=e,r=!1;const s=e=>{r=!0,t?.(e)},i=e=>{n?.(e),r||o?.(e),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",i)},i=(e,t)=>{let{onMouseMove:n,onMouseUp:s,onClick:i}=t,l=!1;const a=(0,r.i)(e),c=e=>{l=!0;const t=(0,r.i)(e),s=o.b.sub(t,a);n?.(e,s)},d=e=>{s?.(e),l||i?.(e),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",d)}},92390:(e,t,n)=>{function o(e){return e.split("/").pop()}n.d(t,{P:()=>o})},92234:(e,t,n)=>{function o(){const e=navigator.platform.toLowerCase();let t=null;return e.indexOf("win")>=0?t="Windows":e.indexOf("mac")>=0&&(t="macOS"),t}function r(){return navigator.userAgent.toLowerCase().indexOf(" electron/")>-1}n.d(t,{r:()=>r,u:()=>o})},99119:(e,t,n)=>{n.d(t,{Z:()=>o});const o=(0,n(39013).Ie)((e=>e),(e=>e))},54493:(e,t,n)=>{n.d(t,{R:()=>c,T:()=>l});var o=n(73406),r=n.n(o),s=n(63166),i=n(28011);function l(e){let t=0;return e.sort(((e,t)=>e.tick-t.tick)).map((e=>{const n={...e,deltaTime:Math.round(e.tick)-Math.round(t)};return delete n.tick,t=e.tick,n}))}const a=e=>(0,s.XS)(e)?(0,s.X6)(e):e;function c(e){return l(r()(e.map(a).map(i.C)))}},67200:(e,t,n)=>{n.d(t,{$z:()=>i,TN:()=>u,os:()=>d});var o=n(22095),r=n(63166),s=n(28011);function i(e){let t=0;return e.map((e=>{const{deltaTime:n,...o}=e;return t+=n,{...o,tick:t}}))}const l=e=>{const{channel:t,...n}=e;return n},a=e=>!("meta"===e.type&&"endOfTrack"===e.subtype),c=e=>(0,o.c_)(e)?(0,r.m0)(e):e;function d(e){return(0,s.f)(i(e.filter(a)).map(c)).map(l)}function u(e){return(0,s.f)(e.filter(a).map(c)).map(l)}},25649:(e,t,n)=>{n.d(t,{T:()=>o});const o=e=>{if(!e.shiftKey&&0!==e.deltaX)return!0;if(e.shiftKey&&0!==e.deltaY)return!0;const{wheelDeltaY:t}=e;return Number.isInteger(e.deltaX)&&Number.isInteger(e.deltaY)&&Math.abs(t)%120!=0}},2316:(e,t,n)=>{n.d(t,{R:()=>d});var o=n(20994),r=n(50119),s=n(11735),i=n(13917),l=n(97233),a=n(35521),c=n(59061);const d=()=>{const{songStore:e,rootViewStore:t}=(0,c.g)(),{song:n}=e,d=(0,o.dj)(),u=(0,o.kc)(),h=(0,o.sp)(),{show:p}=(0,o.p1)(),m=(0,l.B2)(),g=(0,r.pC)(),x=(0,r.jX)(),w=(0,r.k9)(),f=(0,i.q5)(),v=(0,s.cx)(),y=(0,s.ps)(),j=async()=>{const{song:t}=e;if(null!==t.cloudSongId){if(0===t.name.length){const e=await u.show({title:m["save-as"]});null!==e&&e.length>0&&(t.name=e)}const e=p(m["song-saving"]);try{await v(t),d.success(m["song-saved"])}catch(e){alert(e.message)}finally{e()}}else{if(0===t.name.length){const e=await u.show({title:m["save-as"]});null!==e&&e.length>0&&(t.name=e)}const e=p(m["song-saving"]);try{await y(t),d.success(m["song-created"])}catch(e){alert(e.message)}finally{e()}}},k=async()=>{const{song:t}=e;if(t.isSaved)return!0;switch(await h.show({title:m["save-changes"],actions:[{title:m.yes,key:"yes"},{title:m.no,key:"no"},{title:m.cancel,key:"cancel"}]})){case"yes":return await j(),!0;case"no":return!0;case"cancel":return!1}};return{async createNewSong(){try{if(!await k())return;const e=(0,a.p)();g(e),await y(e),d.success(m["song-created"])}catch(e){d.error(e.message)}},async openSong(){try{if(!await k())return;t.openCloudFileDialog=!0}catch(e){d.error(e.message)}},async saveSong(){await j()},async saveAsSong(){try{const e=await u.show({title:m["save-as"],initialText:n.name});if(!(null!==e&&e.length>0))return;n.name=e,await y(n),d.success(m["song-saved"])}catch(e){d.error(e.message)}},async renameSong(){try{const e=await u.show({title:m.rename});if(!(null!==e&&e.length>0))return Promise.resolve(!1);n.name=e,null!==n.cloudSongId?await v(n):await y(n),d.success(m["song-saved"])}catch(e){d.error(e.message)}},async importSong(){try{if(!await k())return;await f(),await j()}catch(e){d.error(e.message)}},async importSongLegacy(e){try{await x(e.currentTarget),await j()}catch(e){d.error(e.message)}},async exportSong(){try{i.Ye?await(0,i.c6)(n):w()}catch(e){d.error(e.message)}},async publishSong(){t.openPublishDialog=!0}}}},78439:(e,t,n)=>{n.d(t,{E:()=>r});var o=n(63696);const r=()=>{const[e,t]=(0,o.useState)({mouseX:0,mouseY:0,isOpen:!1});return{onContextMenu:(0,o.useCallback)((e=>{e.preventDefault(),t({mouseX:e.clientX-2,mouseY:e.clientY-4,isOpen:!0})}),[]),menuProps:{handleClose:()=>{t({...e,isOpen:!1})},isOpen:e.isOpen,position:{x:e.mouseX,y:e.mouseY}}}}},53416:(e,t,n)=>{n.d(t,{P:()=>a});var o=n(20994),r=n(50119),s=n(13917),i=n(97233),l=n(59061);const a=()=>{const{song:e}=(0,l.g)(),t=(0,o.dj)(),n=(0,i.B2)(),a=(0,r.ps)(),c=(0,r.jX)(),d=(0,r.k9)(),u=(0,s.q5)();return{async createNewSong(){(e.isSaved||confirm(n["confirm-new"]))&&a()},async openSong(){try{(e.isSaved||confirm(n["confirm-open"]))&&await u()}catch(e){t.error(e.message)}},async openSongLegacy(o){try{(e.isSaved||confirm(n["confirm-new"]))&&await c(o.currentTarget)}catch(o){t.error(o.message)}},async saveSong(){await(0,s.OJ)(e)},async saveAsSong(){await(0,s.c6)(e)},async downloadSong(){d()}}}},59061:(e,t,n)=>{n.d(t,{P:()=>r,g:()=>s});var o=n(63696);const r=(0,o.createContext)(null),s=()=>(0,o.useContext)(r)},9357:(e,t,n)=>{var o=n(36206),r=n(64687),s=n(89193),i=n(7470),l=n(46685),a=n(62540);o.Ts({dsn:"MISSING_ENV_VAR".SENTRY_DSN,environment:"MISSING_ENV_VAR".VERCEL_ENV,integrations:[r.dp()],tracesSampleRate:1}),(0,s.jK)({enforceActions:"never"}),(0,i.H)(document.querySelector("#root")).render((0,a.jsx)(l.q,{})),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js",{scope:"/edit"}).then((e=>{console.log("SW registered: ",e)})).catch((e=>{console.log("SW registration failed: ",e)}))}))},69673:(e,t,n)=>{n.d(t,{t:()=>o});const o=(()=>{switch(-1!=navigator.userAgent.indexOf("Mac")?"macOS":"PC"){case"macOS":return{cmdOrCtrl:"Cmd",altOrOption:"Option"};case"PC":return{cmdOrCtrl:"Ctrl",altOrOption:"Alt"}}})()},97233:(e,t,n)=>{n.d(t,{B2:()=>i,Oj:()=>a,f4:()=>l,xt:()=>s});var o=n(64478),r=n(70646);const{LocalizationContext:s,useLocalization:i,useCurrentLanguage:l,Localized:a}=(0,o.o)(r.A,"en",[[/^fr/,"fr"],[/^zh-Hans/,"zh-Hans"],[/^zh-Hant/,"zh-Hant"],[/^zh$/,"zh-Hans"],[/^zh-TW$/,"zh-Hant"],[/^zh-HK$/,"zh-Hant"],[/^zh-MO$/,"zh-Hant"],[/^zh-CN$/,"zh-Hans"],[/^zh-SG$/,"zh-Hans"]])},16053:(e,t,n)=>{n.d(t,{g:()=>r,h:()=>o});const o=e=>Math.floor(e/8),r=["","","","","","","","","","","","","","","",""]},6358:(e,t,n)=>{function o(e){return{deltaTime:e,type:"meta",subtype:"endOfTrack"}}function r(e,t){return{deltaTime:e,type:"meta",subtype:"trackName",text:t}}function s(e,t){return{deltaTime:e,type:"meta",subtype:"setTempo",microsecondsPerBeat:t}}function i(e){return{deltaTime:e,type:"meta",subtype:"timeSignature",numerator:arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,denominator:arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,metronome:arguments.length>3&&void 0!==arguments[3]?arguments[3]:24,thirtyseconds:arguments.length>4&&void 0!==arguments[4]?arguments[4]:8}}function l(e,t,n,o){return{deltaTime:e,type:"channel",subtype:"noteOn",channel:t,noteNumber:n,velocity:o}}function a(e,t,n){return{deltaTime:e,type:"channel",subtype:"noteOff",channel:t,noteNumber:n,velocity:arguments.length>3&&void 0!==arguments[3]?arguments[3]:0}}function c(e,t,n){return{deltaTime:e,type:"channel",subtype:"pitchBend",channel:t,value:n}}function d(e,t,n){return{deltaTime:e,type:"channel",subtype:"programChange",channel:t,value:n}}function u(e,t,n,o){return{deltaTime:e,type:"channel",subtype:"controller",channel:t,controllerType:n,value:o}}function h(e,t,n){return u(e,t,1,n)}function p(e,t,n){return u(e,t,7,n)}function m(e,t,n){return u(e,t,10,n)}function g(e,t,n){return u(e,t,11,n)}function x(e,t){return u(e,t,121,0)}function w(e,t,n,o,r,s){const i=[u(e,t,101,n),u(0,t,100,o)],l=[];return void 0!==r&&l.push(u(0,t,6,r)),void 0!==s&&l.push(u(0,t,38,s)),[...i,...l]}function f(e,t){return w(e,t,0,0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)}function v(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)+8192,o=Math.floor(n/128);return w(e,t,0,1,o,n-128*o)}function y(e,t){return w(e,t,0,2,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)+64)}n.d(t,{BQ:()=>i,Ch:()=>d,E0:()=>p,Ey:()=>y,F8:()=>s,GF:()=>g,Q9:()=>u,WY:()=>f,d1:()=>l,dG:()=>a,fJ:()=>c,jq:()=>v,ly:()=>o,qL:()=>r,qZ:()=>x,t3:()=>m,ww:()=>h})},96684:(e,t,n)=>{n.d(t,{FI:()=>j,KO:()=>y,fp:()=>f});var o=n(17243),r=n(38750),s=n.n(r),i=n(10962),l=n(89193),a=n(20604),c=n(80406),d=n(54493),u=n(67200),h=n(35521),p=n(22095);const m=e=>{const t=new p.Ay,n=g(e);return void 0!==n&&(t.channel=n),t.addEvents((0,u.os)(e)),t},g=e=>{const t=e.find((e=>"channel"===e.type));if(void 0!==t&&"channel"in t)return t.channel},x=e=>void 0===g(e),w=e=>{switch(e.header.formatType){case 0:return(e=>{const t=(0,u.$z)(e),n=s()(t,(e=>"channel"in e?e.channel+1:0)),o=[];for(const e of Object.keys(n)){const t=n[e],r=parseInt(e);for(;o.length<=r;){const e=new p.Ay;e.channel=r>0?r-1:void 0,o.push(e)}const s=o[r],i=(0,u.TN)(t);s.addEvents(i)}return o})(e.tracks[0]);case 1:return(e=>{const[t,n]=(0,o.partition)(e,x);0===t.length&&t.push([]);const[r,...s]=[...t,...n].map(u.$z),i=s.map((e=>e.map((e=>(e=>"subtype"in e&&("timeSignature"===e.subtype||"setTempo"===e.subtype))(e)?(r.push(e),null):e)).filter(a.Pe)));return[r,...i].map(d.T)})(e.tracks).map(m);default:throw new Error(`Unsupported midi format ${e.header.formatType}`)}};function f(e){const t=new h.A,n=(0,i.LF)(e);if(w(n).forEach((e=>t.addTrack(e))),1===n.header.formatType&&t.tracks.length>0){const e=t.tracks[0].name;void 0!==e&&(t.name=e)}return t.timebase=n.header.ticksPerBeat,t}const v=e=>t=>"channel"===t.type?{...t,channel:e}:t;function y(e){const t=function(e){return(0,l.HO)(e.tracks).map((e=>{const t=[...(0,d.R)(e.events),{deltaTime:0,type:"meta",subtype:"endOfTrack"}];return void 0!==e.channel?t.map(v(e.channel)):t}))}(e);return(0,i.M9)(t,e.timebase)}function j(e){const t=y(e),n=new Blob([t],{type:"application/octet-stream"});(0,c.W)(n,e.filepath.length>0?e.filepath:"no name.mid")}},12320:(e,t,n)=>{n.d(t,{G:()=>d,Z:()=>c});var o=n(76646),r=n(71229),s=n(51046),i=n(6358),l=n(49214),a=n(62405);const c=99999;class d{constructor(e){this.songStore=e}get timebase(){return this.songStore.song.timebase}get endOfSong(){return this.songStore.song.endOfSong}getEvents(e,t){const{song:n}=this.songStore,l=r.Q.create(e,t),a=o.d.createInRange(n.measures,n.timebase,l).filter((0,s.F)(l)).flatMap((e=>function(e){const t=0===e.beat?100:70,n=0===e.beat?76:77;return[{...(0,i.d1)(0,9,n,t),tick:e.tick,trackId:c}]}(e)));return n.allEvents.filter((0,s.F)(l)).concat(a)}getCurrentStateEvents(e){return this.songStore.song.tracks.flatMap((t=>{const n=(0,l._g)(t.events,e);return(0,a.K)(n,t.channel,t.id)}))}}},62405:(e,t,n)=>{n.d(t,{K:()=>r,T:()=>s});var o=n(28011);const r=(e,t,n)=>e.filter((e=>!(!0===e.isRecording))).flatMap((e=>(0,o.C)(e))).map((e=>({...e,channel:t,trackId:n}))),s=e=>e.flatMap((e=>r(e.events,e.channel,e.id)))},65672:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(52188);class r{denominator;songStore;isEnabled=!0;constructor(e,t,n){this.songStore=e,this.denominator=t,this.isEnabled=n}get timebase(){return this.songStore.song.timebase}calc(e,t){if(!this.isEnabled)return Math.round(e);const n=o.t.getMeasureStart(this.songStore.song.measures,e,this.songStore.song.timebase),r=1===this.denominator?n.numerator??4:4,s=this.timebase*r/this.denominator,i=n?.tick??0;return t((e-i)/s)*s+i}round(e){return this.calc(e,Math.round)}ceil(e){return this.calc(e,Math.ceil)}floor(e){return this.calc(e,Math.floor)}get unit(){return 4*this.timebase/this.denominator}}},28091:(e,t,n)=>{n.d(t,{A:()=>o.A});var o=n(65672)},15738:(e,t,n)=>{n.d(t,{A:()=>o});const o=new class{data={};writeText(e){this.data.text=e}readText(){return this.data.text}clear(e){delete this.data[e]}write(e,t){this.data[t]=e}}},26666:(e,t,n)=>{n.d(t,{P:()=>s});var o=n(89193),r=n(12320);class s{outputs=[];isMetronomeEnabled=!1;constructor(e,t){this.trackMute=e,this.metronomeOutput=t,(0,o.Gn)(this,{isMetronomeEnabled:o.sH})}activate(){this.outputs.filter((e=>e.isEnabled)).forEach((e=>e.synth.activate()))}getOutputs(e){return e===r.Z?this.isMetronomeEnabled?[this.metronomeOutput]:[]:void 0===e||null===this.trackMute||this.trackMute.shouldPlayTrack(e)?this.outputs.filter((e=>e.isEnabled)).map((e=>e.synth)):[]}sendEvent(e,t,n,o){this.getOutputs(o).forEach((r=>r.sendEvent(e,t,n,o)))}}},83710:(e,t,n)=>{n.d(t,{X:()=>s});const o="files",r="catalog";class s{db=null;constructor(e,t){this.dbName=e,this.version=t}async init(){this.db=await this.openDatabase()}openDatabase(){return new Promise(((e,t)=>{const n=indexedDB.open(this.dbName,this.version);n.onsuccess=()=>e(n.result),n.onupgradeneeded=()=>{const e=n.result;e.objectStoreNames.contains(o)||e.createObjectStore(o,{autoIncrement:!0}),e.objectStoreNames.contains(r)||e.createObjectStore(r)},n.onerror=()=>t(n.error)}))}async getCatalog(){if(!this.db)throw new Error("Database not initialized");const e=this.db.transaction(r,"readonly").objectStore(r).get(0);return await i(e)??{files:{}}}async setCatalog(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(r,"readwrite").objectStore(r).put(e,0);await i(t)}async updateCatalog(e){const t=e(await this.getCatalog());await this.setCatalog(t)}async save(e,t){return(await this.saveMany([{data:e,metadata:t}]))[0].id}async saveMany(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(o,"readwrite").objectStore(o),n=[];for await(const o of e){const e=t.add(o.data),r=await i(e);n.push({id:r,metadata:o.metadata})}return await this.updateCatalog((e=>{for(const{id:t,metadata:o}of n)e.files[t]=o;return e})),n}async load(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(o,"readonly").objectStore(o).get(e);return await i(t)??null}async delete(e){await this.deleteMany([e])}async deleteMany(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(o,"readwrite").objectStore(o);for(const n of e)t.delete(n);await this.updateCatalog((t=>{for(const n of e)delete t.files[n];return t}))}async list(){return(await this.getCatalog()).files}}function i(e){return new Promise(((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)}))}},2463:(e,t,n)=>{n.d(t,{E:()=>s,g:()=>r});var o=n(10962);class r{devices=[];onMessage;removeAllDevices=()=>{this.devices.forEach(this.removeDevice)};removeDevice=e=>{e.removeEventListener("midimessage",this.onMidiMessage),this.devices=this.devices.filter((t=>t.id!==e.id))};addDevice=e=>{e.addEventListener("midimessage",this.onMidiMessage),this.devices.push(e)};onMidiMessage=e=>{this.onMessage?.(e)}}const s=e=>t=>{const{pianoRollStore:n,pianoRollStore:{selectedTrack:r},player:s}=e;if(void 0===r)return;const{channel:i}=r;if(void 0===i)return;const l=new o.Z6(t.data),a=(0,o.ac)(l);"channel"===a.type&&(a.channel=i,s.sendEvent(a),"noteOn"===a.subtype?n.previewingNoteNumbers.add(a.noteNumber):"noteOff"===a.subtype&&n.previewingNoteNumbers.delete(a.noteNumber))}},45322:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(10962);class r{midiOutput;constructor(e){this.midiOutput=e}activate(){this.midiOutput.open()}sendEvent(e,t,n){const r=(0,o.lK)({...e,deltaTime:0},!1),s=1e3*t+n;if("connected"===this.midiOutput.state)try{this.midiOutput.send(r,s)}catch(e){console.warn(e)}}}},79565:(e,t,n)=>{n.d(t,{o:()=>s});var o=n(10962),r=n(89193);class s{recordedNotes=[];player;rootStore;isRecording=!1;constructor(e,t){this.player=e,this.rootStore=t,(0,r.Gn)(this,{isRecording:r.sH}),(0,r.lB)(e,"position",(e=>{if(!this.isRecording)return;const n=t.pianoRollStore.selectedTrack;if(void 0===n)return;const o=e.object.get();this.recordedNotes.forEach((e=>{n.updateEvent(e.id,{duration:Math.max(0,o-e.tick)})}))})),(0,r.lB)(this,"isRecording",(e=>{this.recordedNotes=[],e.newValue||this.rootStore.song.tracks.forEach((e=>{const t=e.events.filter((e=>!0===e.isRecording)).map((e=>({...e,isRecording:!1})));e.updateEvents(t)}))}))}onMessage(e){if(!this.isRecording)return;const t=this.rootStore.pianoRollStore.selectedTrack;if(void 0===t)return;const n=new o.Z6(e.data),r=(0,o.ac)(n);if("channel"!==r.type)return;const s=this.player.position;switch(r.subtype){case"noteOn":{const e=t.addEvent({type:"channel",subtype:"note",noteNumber:r.noteNumber,tick:s,velocity:r.velocity,duration:0,isRecording:!0});this.recordedNotes.push(e);break}case"noteOff":this.recordedNotes.filter((e=>e.noteNumber===r.noteNumber)).forEach((e=>{t.updateEvent(e.id,{duration:Math.max(0,s-e.tick)})})),this.recordedNotes=this.recordedNotes.filter((e=>e.noteNumber!==r.noteNumber));break;default:t.addEvent({...r,tick:s,isRecording:!0})}}}},94398:(e,t,n)=>{async function o(e,t){const n=await e.createWritable();await n.write(t),await n.close()}n.d(t,{_:()=>o})},69340:(e,t,n)=>{n.d(t,{A:()=>d});var o=n(89193),r=n(39013),s=n(52188),i=n(2265),l=n(20604),a=n(62405),c=n(22095);class d{tracks=[];filepath="";timebase=480;name="";fileHandle=null;cloudSongId=null;cloudSongDataId=null;isSaved=!0;lastTrackId=0;constructor(){(0,o.Gn)(this,{addTrack:o.XI,removeTrack:o.XI,insertTrack:o.XI,conductorTrack:o.EW,measures:o.EW,timeSignatures:o.EW,endOfSong:o.EW,allEvents:(0,o.EW)({keepAlive:!0}),tracks:o.sH.shallow,filepath:o.sH,timebase:o.sH,name:o.sH,isSaved:o.sH}),(0,o.mJ)((()=>[this.tracks.map((e=>({channel:e.channel,events:e.events}))),this.name]),(()=>this.isSaved=!1))}generateTrackId(){return this.lastTrackId++}insertTrack(e,t){void 0===e.channel&&this.tracks.length>0&&(e.channel=e.channel||this.tracks.length-1),e.id=this.generateTrackId(),this.tracks.splice(t,0,e)}addTrack(e){this.insertTrack(e,this.tracks.length)}removeTrack(e){this.tracks=this.tracks.filter((t=>t.id!==e))}moveTrack(e,t){const[n]=this.tracks.splice(e,1);this.tracks.splice(t,0,n)}get conductorTrack(){return this.tracks.find((e=>e.isConductorTrack))}getTrack(e){return this.tracks.find((t=>t.id===e))}get measures(){const{timeSignatures:e,timebase:t}=this;return s.t.fromTimeSignatures(e,t)}get timeSignatures(){const{conductorTrack:e}=this;return void 0===e?[]:e.events.filter(c.y5).slice().sort(((e,t)=>e.tick-t.tick))}get endOfSong(){return(Math.max(...this.tracks.map((e=>e.endOfTrack)).filter(l.EA))??0)+14400}get allEvents(){return(0,a.T)(this.tracks)}transposeNotes(e,t){for(const n in t){const o=parseInt(n),r=t[o],s=this.tracks[o];void 0!==s&&s.updateEvents(r.map((t=>{const n=s.getEventById(t);return null!=n&&(0,c.Fb)(n)?{id:t,noteNumber:i.i.clamp(n.noteNumber+e)}:null})).filter(l.Pe))}}}(0,r.PL)(d,{tracks:(0,r.p_)((0,r.Ik)(c.Ay)),filepath:(0,r.MY)(),timebase:(0,r.MY)(),lastTrackId:(0,r.MY)()})},57108:(e,t,n)=>{n.d(t,{p:()=>s});var o=n(22095),r=n(69340);function s(){const e=new r.A;return e.addTrack((0,o.bL)()),e.addTrack((0,o.BQ)(0)),e.isSaved=!0,e}},35521:(e,t,n)=>{n.d(t,{A:()=>o.A,p:()=>r.p});var o=n(69340),r=n(57108)},67498:(e,t,n)=>{n.d(t,{A:()=>g});var o=n(17243),r=n(89193),s=n(92770),i=n(20038),l=n(71229),a=n(20883),c=n(48077),d=n(51046),u=n(28091),h=n(22095),p=n(16541),m=n(11631);class g{rulerStore;tickScrollStore;scaleX=1;scaleY=1;SCALE_Y_MIN=.5;SCALE_Y_MAX=4;selection=null;selectedEventIds={};autoScroll=!0;quantize=1;scrollLeftTicks=0;scrollTop=0;canvasWidth=0;canvasHeight=0;selectedTrackIndex=0;openTransposeDialog=!1;openVelocityDialog=!1;constructor(e){this.rootStore=e,this.rootStore=e,this.rulerStore=new p.A(this,e.songStore),this.tickScrollStore=new m.M(this,.15,15),(0,r.Gn)(this,{scaleX:r.sH,scaleY:r.sH,selection:r.sH.shallow,selectedEventIds:r.sH,autoScroll:r.sH,quantize:r.sH,scrollLeftTicks:r.sH,scrollTop:r.sH,canvasWidth:r.sH,canvasHeight:r.sH,selectedTrackIndex:r.sH,openTransposeDialog:r.sH,openVelocityDialog:r.sH,scrollLeft:r.EW,transform:r.EW,trackTransform:r.EW,notes:r.EW,cursorX:r.EW,trackHeight:r.EW,selectionRect:r.EW,contentWidth:r.EW,contentHeight:r.EW,quantizer:r.EW,selectedTrackId:r.EW,setScrollLeftInPixels:r.XI,setScrollTop:r.XI})}setUpAutorun(){this.tickScrollStore.setUpAutoScroll()}serialize(){return{selection:(0,o.cloneDeep)(this.selection),selectedEventIds:(0,o.cloneDeep)(this.selectedEventIds)}}restore(e){this.selection=e.selection,this.selectedEventIds=e.selectedEventIds}get scrollLeft(){return this.tickScrollStore.scrollLeft}setScrollLeftInPixels(e){this.tickScrollStore.setScrollLeftInPixels(e)}setScrollTop(e){const t=this.contentHeight+s.PE.rulerHeight+i.ZW-this.canvasHeight;this.scrollTop=(0,o.clamp)(e,0,t)}scrollBy(e,t){this.setScrollLeftInPixels(this.scrollLeft-e),this.setScrollTop(this.scrollTop-t)}scaleAroundPointX(e,t){this.tickScrollStore.scaleAroundPointX(e,t)}setScaleY(e){this.scaleY=(0,o.clamp)(e,this.SCALE_Y_MIN,this.SCALE_Y_MAX),this.setScrollTop(this.scrollTop)}resetSelection(){this.selection=null,this.selectedEventIds={}}get contentWidth(){return this.tickScrollStore.contentWidth}get contentHeight(){return this.trackTransform.getY(this.rootStore.song.tracks.length)}get transform(){return new c.a(s.PE.pixelsPerTick*this.scaleX,.5*this.scaleY,127)}get trackTransform(){const{transform:e,trackHeight:t}=this;return new a.w(e,t)}get trackHeight(){const{transform:e}=this;return Math.ceil(e.pixelsPerKey*e.numberOfKeys)+1}get notes(){const{transform:e,trackTransform:t,scrollLeft:n,canvasWidth:o,scaleY:r}=this;return this.rootStore.song.tracks.map(((s,i)=>s.events.filter((0,d.L)(l.Q.fromLength(e.getTick(n),e.getTick(o)))).filter(h.Fb).map((n=>{const o=e.getRect(n);return{...o,height:r,y:t.getY(i)+o.y}})))).flat()}get cursorX(){return this.transform.getX(this.rootStore.player.position)}get selectionRect(){const{selection:e,trackTransform:t}=this;if(null===e)return null;const n=t.getX(e.fromTick),o=t.getX(e.toTick),r=t.getY(e.fromTrackIndex);return{x:n,width:o-n,y:r,height:t.getY(e.toTrackIndex)-r}}get quantizer(){return new u.A(this.rootStore,this.quantize,!0)}get selectedTrackId(){return this.rootStore.song.tracks[this.selectedTrackIndex].id}}},32025:(e,t,n)=>{n.d(t,{a:()=>s});var o=n(89193),r=n(92234);class s{authUser=null;user=null;constructor(e){this.userRepository=e,(0,o.Gn)(this,{authUser:o.sH,user:o.sH});let t=null;try{e.observeAuthUser((async n=>{this.authUser=n,(0,r.r)()&&window.electronAPI.authStateChanged(null!==n),t?.(),null!==n&&(t=e.observeCurrentUser((e=>{this.user=e})),await this.createProfileIfNeeded(n))}))}catch(e){console.warn(e)}}async createProfileIfNeeded(e){if(null===await this.userRepository.getCurrentUser()){const t={name:e.displayName??"",bio:""};await this.userRepository.create(t)}}get isLoggedIn(){return null!==this.authUser}}},1296:(e,t,n)=>{n.d(t,{L:()=>s});var o=n(17243),r=n(89193);class s{isLoading=!1;selectedColumn="date";dateType="created";sortAscending=!1;_files=[];constructor(e,t,n){this.songStore=e,this.cloudSongRepository=t,this.cloudSongDataRepository=n,(0,r.Gn)(this,{isLoading:r.sH,selectedColumn:r.sH,dateType:r.sH,sortAscending:r.sH,_files:r.sH,files:r.EW})}async load(){this.isLoading=!0,this._files=await this.cloudSongRepository.getMySongs(),this.isLoading=!1}get files(){return(0,o.orderBy)(this._files,(e=>{switch(this.selectedColumn){case"name":return e.name;case"date":switch(this.dateType){case"created":return e.createdAt.getTime();case"updated":return e.updatedAt.getTime()}}}),this.sortAscending?"asc":"desc")}async deleteSong(e){await this.cloudSongDataRepository.delete(e.songDataId),await this.cloudSongRepository.delete(e.id),this.songStore.song.cloudSongId===e.id&&(this.songStore.song.cloudSongId=null,this.songStore.song.cloudSongDataId=null),await this.load()}}},60790:(e,t,n)=>{n.d(t,{$e:()=>h,Tk:()=>d,jL:()=>u,qw:()=>c});var o=n(17243),r=n(10962),s=n(89193),i=n(78193),l=n(29909),a=n(22095);const c=e=>{switch(e.type){case"concertina":return"concertina";case"velocity":return"velocity";case"pitchBend":return"pitchBend";case"controller":return`controller-${e.controllerType}`}},d=(e,t)=>{switch(e.type){case"concertina":case"velocity":case"pitchBend":return e.type===t.type;case"controller":switch(t.type){case"concertina":case"velocity":case"pitchBend":return!1;case"controller":return l.a.equals(e,t)}}},u=[{type:"concertina"},{type:"velocity"},{type:"pitchBend"},{type:"controller",controllerType:r.M$.MSB_MAIN_VOLUME},{type:"controller",controllerType:r.M$.MSB_PAN},{type:"controller",controllerType:r.M$.MSB_EXPRESSION},{type:"controller",controllerType:r.M$.SUSTAIN},{type:"controller",controllerType:r.M$.MSB_MODWHEEL}];class h{controlMode={type:"concertina"};selection=null;selectedEventIds=[];controlModes=(()=>u)();constructor(e){this.pianoRollStore=e,(0,s.Gn)(this,{controlMode:s.sH,selection:s.sH,selectedEventIds:s.sH,controlModes:s.sH,scrollLeft:s.EW,cursorX:s.EW,transform:s.EW,rulerStore:s.EW,selectedTrack:s.EW,quantizer:s.EW,mouseMode:s.EW,cursor:s.EW}),(0,i.pu)(this,{name:"ControlStore",properties:["controlModes"],storage:window.localStorage})}serialize(){return{controlModes:(0,o.cloneDeep)(this.controlModes)}}restore(e){this.controlModes=e.controlModes}get controlValueEvents(){const{controlMode:e}=this;switch(e.type){case"concertina":throw new Error("don't use this method for concertina");case"velocity":throw new Error("don't use this method for velocity");case"pitchBend":return this.pianoRollStore.filteredEvents(a.Y6);case"controller":return this.pianoRollStore.filteredEvents((0,a.HG)(e.controllerType))}}get scrollLeft(){return this.pianoRollStore.scrollLeft}get cursorX(){return this.pianoRollStore.cursorX}get transform(){return this.pianoRollStore.transform}get rulerStore(){return this.pianoRollStore.rulerStore}get selectedTrack(){return this.pianoRollStore.selectedTrack}get quantizer(){return this.pianoRollStore.quantizer}get mouseMode(){return this.pianoRollStore.mouseMode}get cursor(){return this.pianoRollStore.controlCursor}}},93501:(e,t,n)=>{n.d(t,{u:()=>r});var o=n(89193);class r{openExportProgressDialog=!1;progress=0;isCanceled=!1;constructor(){(0,o.Gn)(this,{openExportProgressDialog:o.sH,progress:o.sH})}}},62217:(e,t,n)=>{n.d(t,{A:()=>o});class o{undoHistory=[];redoHistory=[];constructor(e){this.serializable=e}push(){const e=this.serializable.serialize();this.undoHistory.push(e),this.redoHistory=[]}get hasUndo(){return this.undoHistory.length>0}undo(){const e=this.serializable.serialize(),t=this.undoHistory.pop();t&&(this.redoHistory.push(e),this.serializable.restore(t))}get hasRedo(){return this.redoHistory.length>0}redo(){const e=this.serializable.serialize(),t=this.redoHistory.pop();t&&(this.undoHistory.push(e),this.serializable.restore(t))}clear(){this.undoHistory=[],this.redoHistory=[]}}},92198:(e,t,n)=>{n.d(t,{$:()=>s});var o=n(89193),r=n(78193);class s{inputs=[];outputs=[];requestError=null;isLoading=!1;enabledOutputs={};enabledInputs={};isFactorySoundEnabled=!0;constructor(){(0,o.Gn)(this,{inputs:o.sH,outputs:o.sH,requestError:o.sH,isLoading:o.sH,enabledOutputs:o.sH,enabledInputs:o.sH,isFactorySoundEnabled:o.sH,setInputEnable:o.XI,setOutputEnable:o.XI}),(0,r.pu)(this,{name:"MIDIDeviceStore",properties:["isFactorySoundEnabled","enabledOutputs","enabledInputs"],storage:window.localStorage}),this.requestMIDIAccess()}async requestMIDIAccess(){if(this.isLoading=!0,this.inputs=[],this.outputs=[],void 0===navigator.requestMIDIAccess)return this.isLoading=!1,void(this.requestError=new Error("Web MIDI API is not supported by your browser"));try{const e=await navigator.requestMIDIAccess({sysex:!0});this.updatePorts(e),e.onstatechange=()=>{this.updatePorts(e)}}catch(e){this.requestError=e}finally{this.isLoading=!1}}updatePorts(e){this.inputs=Array.from(e.inputs.values()),this.outputs=Array.from(e.outputs.values())}setInputEnable(e,t){this.enabledInputs={...this.enabledInputs,[e]:t}}setOutputEnable(e,t){this.enabledOutputs={...this.enabledOutputs,[e]:t}}}},34755:(e,t,n)=>{n.d(t,{A:()=>f});var o=n(17243),r=n(89193),s=n(92770),i=n(71229),l=n(70480),a=n(52188),c=n(40540),d=n(48077),u=n(3354),h=n(20604),p=n(51046),m=n(28091),g=n(22095),x=n(16541),w=n(11631);class f{rulerStore;tickScrollStore;scrollLeftTicks=0;scrollTopKeys=70;SCALE_Y_MIN=.5;SCALE_Y_MAX=4;notesCursor="auto";mouseMode="pencil";scaleX=1;scaleY=1;autoScroll=!0;quantize=8;isQuantizeEnabled=!0;selectedTrackId=(()=>g.ql)();selection=null;selectedNoteIds=[];lastNoteDuration=null;openInstrumentBrowser=!1;instrumentBrowserSetting={isRhythmTrack:!1,programNumber:0};notGhostTrackIds=(()=>new Set)();canvasWidth=0;canvasHeight=0;showTrackList=!1;showEventList=!1;openTransposeDialog=!1;openVelocityDialog=!1;newNoteVelocity=100;keySignature=null;previewingNoteNumbers=(()=>new Set)();constructor(e){this.rootStore=e,this.rulerStore=new x.A(this,e.songStore),this.tickScrollStore=new w.M(this,.15,15),(0,r.Gn)(this,{scrollLeftTicks:r.sH,scrollTopKeys:r.sH,notesCursor:r.sH,mouseMode:r.sH,scaleX:r.sH,scaleY:r.sH,autoScroll:r.sH,quantize:r.sH,isQuantizeEnabled:r.sH,selectedTrackId:r.sH,selection:r.sH.shallow,selectedNoteIds:r.sH,lastNoteDuration:r.sH,openInstrumentBrowser:r.sH,instrumentBrowserSetting:r.sH,notGhostTrackIds:r.sH,canvasWidth:r.sH,canvasHeight:r.sH,showTrackList:r.sH,showEventList:r.sH,openTransposeDialog:r.sH,openVelocityDialog:r.sH,newNoteVelocity:r.sH,keySignature:r.sH,previewingNoteNumbers:r.sH,contentWidth:r.EW,contentHeight:r.EW,scrollLeft:r.EW,scrollTop:r.EW,transform:r.EW,windowedEvents:r.EW,allNotes:r.EW,notes:r.EW,selectedTrackIndex:r.EW,ghostTrackIds:r.EW,selectionBounds:r.EW,currentVolume:r.EW,currentPan:r.EW,currentTempo:r.EW,currentMBTTime:r.EW,cursorX:r.EW,quantizer:r.EW,controlCursor:r.EW,selectedTrack:r.EW,setScrollLeftInPixels:r.XI,setScrollTopInPixels:r.XI,setScrollLeftInTicks:r.XI,scaleAroundPointX:r.XI,scaleAroundPointY:r.XI,scrollBy:r.XI,toggleTool:r.XI})}setUpAutorun(){this.tickScrollStore.setUpAutoScroll(),(0,r.mJ)((()=>({selectedTrackId:this.selectedTrackId,mouseMode:this.mouseMode})),(()=>{this.resetSelection()}))}serialize(){return{selection:this.selection?{...this.selection}:null,selectedNoteIds:(0,o.cloneDeep)(this.selectedNoteIds),selectedTrackId:this.selectedTrackId}}restore(e){this.selection=e.selection,this.selectedNoteIds=e.selectedNoteIds,this.selectedTrackId=e.selectedTrackId}get contentWidth(){return this.tickScrollStore.contentWidth}get contentHeight(){const{transform:e}=this;return e.getMaxY()}get scrollLeft(){return this.tickScrollStore.scrollLeft}get scrollTop(){return Math.round(this.transform.getY(this.scrollTopKeys))}setScrollLeftInPixels(e){this.tickScrollStore.setScrollLeftInPixels(e)}setScrollTopInPixels(e){const{transform:t,canvasHeight:n}=this,r=t.getMaxY()-n,s=(0,o.clamp)(e,0,r);this.scrollTopKeys=this.transform.getNoteNumberFractional(s)}setScrollLeftInTicks(e){this.tickScrollStore.setScrollLeftInTicks(e)}setScrollTopInKeys(e){this.setScrollTopInPixels(this.transform.getY(e))}scrollBy(e,t){this.setScrollLeftInPixels(this.scrollLeft-e),this.setScrollTopInPixels(this.scrollTop-t)}scaleAroundPointX(e,t){this.tickScrollStore.scaleAroundPointX(e,t)}scaleAroundPointY(e,t){const n=this.transform.getNoteNumberFractional(this.scrollTop+t);this.scaleY=(0,o.clamp)(this.scaleY*(1+e),this.SCALE_Y_MIN,this.SCALE_Y_MAX);const r=this.transform.getNoteNumberFractional(this.scrollTop+t)-n;this.setScrollTopInKeys(this.scrollTopKeys-r)}toggleTool(){this.mouseMode="pencil"===this.mouseMode?"selection":"pencil"}resetSelection(){this.selection=null,this.selectedNoteIds=[]}get selectedTrackIndex(){return this.rootStore.song.tracks.findIndex((e=>e.id===this.selectedTrackId))}set selectedTrackIndex(e){this.selectedTrackId=this.rootStore.song.tracks[e]?.id}get selectedTrack(){return this.rootStore.song.getTrack(this.selectedTrackId)}get transform(){return new d.a(s.PE.pixelsPerTick*this.scaleX,s.PE.keyHeight*this.scaleY,127)}get windowedEvents(){const{transform:e,scrollLeft:t,canvasWidth:n,selectedTrack:o}=this;return void 0===o?[]:o.events.filter((0,p.L)(i.Q.fromLength(e.getTick(t),e.getTick(n))))}get allNotes(){const{transform:e,selectedTrack:t,selectedNoteIds:n}=this;return void 0===t?[]:t.events.filter(g.Fb).map((o=>{const r=t.isRhythmTrack?e.getDrumRect(o):e.getRect(o),s=n.includes(o.id);return{...r,id:o.id,velocity:o.velocity,isSelected:s}}))}get notes(){const{scrollLeft:e,canvasWidth:t,selectedTrack:n,allNotes:o}=this;if(void 0===n)return[];const r=i.Q.fromLength(e,t);return o.filter((e=>i.Q.intersects(i.Q.fromLength(e.x,e.width),r)))}get ghostTrackIds(){const e=this.rootStore.song,{notGhostTrackIds:t,selectedTrackId:n}=this;return e.tracks.filter((e=>e.id!==n&&!t.has(e.id))).map((e=>e.id))}getNotes(e){return this.notes.filter((t=>l.r.containsPoint(t,e)))}getLocal(e){return{x:e.offsetX+this.scrollLeft,y:e.offsetY+this.scrollTop}}get selectionBounds(){return null!==this.selection?c.L.getBounds(this.selection,this.transform):null}filteredEvents(e){const{windowedEvents:t,scrollLeft:n,canvasWidth:r,transform:s,selectedTrack:i}=this,l=(i?.events??[]).filter(e),a=t.filter(e),c=s.getTick(n),d=s.getTick(n+r);return[(0,o.maxBy)(l.filter((e=>e.tick<c)),(e=>e.tick)),...a,(0,o.minBy)(l.filter((e=>e.tick>d)),(e=>e.tick))].filter(h.EA)}get currentVolume(){return this.selectedTrack?.getVolume(this.rootStore.player.position)}get currentPan(){return this.selectedTrack?.getPan(this.rootStore.player.position)}get currentTempo(){return this.rootStore.song.conductorTrack?.getTempo(this.rootStore.player.position)}get currentMBTTime(){return a.t.getMBTString(this.rootStore.song.measures,this.rootStore.player.position,this.rootStore.song.timebase)}get cursorX(){return this.transform.getX(this.rootStore.player.position)}get quantizer(){return new m.A(this.rootStore,this.quantize,this.isQuantizeEnabled)}get enabledQuantizer(){return new m.A(this.rootStore,this.quantize,!0)}get controlCursor(){return"pencil"===this.mouseMode?'url("./cursor-pencil.svg") 0 20, pointer':"auto"}getDraggablePosition(e){switch(e.type){case"note":{const{selectedTrack:t}=this;if(void 0===t)return null;const n=t.getEventById(e.noteId);if(void 0===n||!(0,g.Fb)(n))return null;switch(e.position){case"center":case"left":return n;case"right":return{tick:n.tick+n.duration,noteNumber:n.noteNumber}}break}case"selection":{const{selection:t}=this;if(null===t)return null;switch(e.position){case"center":case"left":return c.L.getFrom(t);case"right":return c.L.getTo(t)}break}}}updateDraggable(e,t){switch(e.type){case"note":{const{selectedTrack:n}=this;if(void 0===n)return;const o=n.getEventById(e.noteId);if(void 0===o||!(0,g.Fb)(o))return;switch(e.position){case"center":n.updateEvent(o.id,t);break;case"left":if(void 0===t.tick)return;n.updateEvent(o.id,{tick:t.tick,duration:o.duration+o.tick-t.tick});break;case"right":if(void 0===t.tick)return;n.updateEvent(o.id,{duration:t.tick-o.tick})}break}case"selection":{const{selection:n}=this;if(null===n)return;switch(e.position){case"center":{const e=c.L.getFrom(n),o={...e,...t},r=u.T.sub(o,e);this.selection=c.L.moved(n,r.tick,r.noteNumber);break}case"left":if(void 0===t.tick)return;this.selection={...n,fromTick:t.tick};break;case"right":if(void 0===t.tick)return;this.selection={...n,toTick:t.tick}}break}}}getDraggableArea(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{selectedTrack:n}=this;if(void 0===n)return null;switch(e.type){case"note":{const r=n.getEventById(e.noteId);if(void 0===r||!(0,g.Fb)(r))return null;const l=this.selectedNoteIds.map((e=>n.getEventById(e))).filter(h.EA).filter(g.Fb),a=(0,o.min)(l.map((e=>e.tick)))??0,c=r.tick-a;switch(e.position){case"center":{const e=(0,o.max)(l.map((e=>e.noteNumber)))??0,t=(0,o.min)(l.map((e=>e.noteNumber)))??0,n=r.noteNumber-t,a=s.a2-(e-r.noteNumber);return{tickRange:i.Q.create(c,1/0),noteNumberRange:i.Q.create(n,a)}}case"left":return{tickRange:i.Q.create(c,r.tick+r.duration-t),noteNumberRange:i.Q.point(r.noteNumber)};case"right":return{tickRange:i.Q.create(r.tick+t,1/0),noteNumberRange:i.Q.point(r.noteNumber)}}break}case"selection":{const{selection:r}=this;if(null===r)return null;const l=this.selectedNoteIds.map((e=>n.getEventById(e))).filter(h.EA).filter(g.Fb),a=(0,o.min)(l.map((e=>e.tick)))??0,c=r.fromTick-a;switch(e.position){case"center":{const e=r.fromNoteNumber-r.toNoteNumber;return{tickRange:i.Q.create(c,1/0),noteNumberRange:i.Q.create(e-1,s.a2+1)}}case"left":{const e=(0,o.max)(l.map((e=>e.duration)))??0,n=r.toTick-t,s=r.fromTick+(e-t);return{tickRange:i.Q.create(c,Math.min(n,s)),noteNumberRange:i.Q.point(r.fromNoteNumber)}}case"right":{const e=(0,o.max)(l.map((e=>e.duration)))??0,n=r.fromTick+t,s=r.toTick-(e-t);return{tickRange:i.Q.create(Math.max(n,s),1/0),noteNumberRange:i.Q.point(r.fromNoteNumber)}}}}}}}},9111:(e,t,n)=>{n.d(t,{A:()=>D});var o=n(69825),r=n(1902),s=n(89193),i=n(39013),l=n(52932),a=n(92234),c=n(12320),d=n(26666),u=n(2463),h=n(79565),p=n(35521),m=n(22095),g=n(74124),x=n(67498),w=n(32025),f=n(1296),v=n(60790),y=n(93501),j=n(62217),k=n(92198),b=n(34755),C=n(61426),S=n(45936),R=n(97829),A=n(98597),T=n(45331),E=n(53603),I=n(55610);class D{song=(()=>(0,p.p)())();cloudSongRepository=(()=>(0,o.XW)(l.kA,l.j2))();cloudSongDataRepository=(()=>(0,o.TA)(l.kA,l.j2))();cloudMidiRepository=(()=>(0,o.n2)(l.kA,l.Cn))();userRepository=(()=>(0,o._x)(l.kA,l.j2))();router=(()=>new R.A)();trackMute=(()=>new g.A)();historyStore=(()=>new j.A(this))();rootViewStore=(()=>new S.A)();pianoRollStore;controlStore;arrangeViewStore=(()=>new x.A(this))();tempoEditorStore=(()=>new E.A(this))();midiDeviceStore=(()=>new k.$)();exportStore=(()=>new y.u)();authStore=(()=>new w.a(this.userRepository))();cloudFileStore=(()=>new f.L(this,this.cloudSongRepository,this.cloudSongDataRepository))();settingStore=(()=>new A.A)();player;synth;metronomeSynth;synthGroup;midiInput=(()=>new u.g)();midiRecorder;soundFontStore;themeStore=(()=>new I.Z)();constructor(){(0,s.Gn)(this,{song:s.sH.ref});const e=new(window.AudioContext||window.webkitAudioContext);this.synth=new r.Fu(e),this.metronomeSynth=new r.Fu(e),this.synthGroup=new d.P(this.trackMute,this.metronomeSynth),this.synthGroup.outputs.push({synth:this.synth,isEnabled:!0});const t=new c.G(this);this.player=new r.ai(this.synthGroup,t),this.midiRecorder=new h.o(this.player,this),this.pianoRollStore=new b.A(this),this.controlStore=new v.$e(this.pianoRollStore),this.soundFontStore=new T.M(this.synth);const n=(0,u.E)(this);this.midiInput.onMidiMessage=e=>{n(e),this.midiRecorder.onMessage(e)},this.pianoRollStore.setUpAutorun(),this.arrangeViewStore.setUpAutorun(),this.tempoEditorStore.setUpAutorun(),(0,C._)(this)}serialize(){return{song:(0,i.lK)(this.song),pianoRollStore:this.pianoRollStore.serialize(),controlStore:this.controlStore.serialize(),arrangeViewStore:this.arrangeViewStore.serialize()}}restore(e){const t=(0,i.iu)(p.A,e.song);this.song=t,this.pianoRollStore.restore(e.pianoRollStore),this.controlStore.restore(e.controlStore),this.arrangeViewStore.restore(e.arrangeViewStore)}async init(){this.pianoRollStore.selectedTrackId=this.song.tracks.find((e=>!e.isConductorTrack))?.id??m.ql,await this.synth.setup(),await this.soundFontStore.init(),this.setupMetronomeSynth()}async setupMetronomeSynth(){const e=await async function(){if((0,a.r)())return await window.electronAPI.readFile("./assets/soundfonts/A320U_drums.sf2");const e=await fetch("https://cdn.jsdelivr.net/gh/ryohey/signal@6959f35/public/A320U_drums.sf2");return await e.arrayBuffer()}();await this.metronomeSynth.loadSoundFont(e)}get pushHistory(){return()=>this.historyStore.push()}get songStore(){return this}}},45936:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(89193);class r{isArrangeViewSelected=!1;openFileDrawer=!1;openEditDrawer=!1;openHelp=!1;eventEditorEvents=[];openSignInDialog=!1;openCloudFileDialog=!1;openSettingDialog=!1;openControlSettingDialog=!1;initializeError=null;openInitializeErrorDialog=!1;openPublishDialog=!1;openUserSettingsDialog=!1;openDeleteAccountDialog=!1;constructor(){(0,o.Gn)(this,{isArrangeViewSelected:o.sH,openFileDrawer:o.sH,openEditDrawer:o.sH,openHelp:o.sH,eventEditorEvents:o.sH.shallow,openSignInDialog:o.sH,openCloudFileDialog:o.sH,openSettingDialog:o.sH,openControlSettingDialog:o.sH,initializeError:o.sH,openInitializeErrorDialog:o.sH,openPublishDialog:o.sH,openUserSettingsDialog:o.sH,openDeleteAccountDialog:o.sH})}}},97829:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(89193);class r{path="/track";constructor(){(0,o.Gn)(this,{path:o.sH})}pushArrange(){this.path="/arrange"}pushTrack(){this.path="/track"}}},16541:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(89193),r=n(8660),s=n(71229),i=n(51046);class l{selectedTimeSignatureEventIds=[];constructor(e,t){this.parent=e,this.songStore=t,(0,o.Gn)(this,{selectedTimeSignatureEventIds:o.sH.shallow,beats:o.EW,timeSignatures:o.EW,quantizer:o.EW})}get beats(){const{scrollLeft:e,transform:t,canvasWidth:n}=this.parent,{song:{measures:o,timebase:s}}=this.songStore;return r.B.createInRange(o,t,s,e,n)}get timeSignatures(){const{transform:e,scrollLeft:t,canvasWidth:n}=this.parent,{selectedTimeSignatureEventIds:o}=this,{song:{timeSignatures:r}}=this.songStore;return r.filter((0,i.F)(s.Q.fromLength(e.getTick(t),e.getTick(n)))).map((e=>({...e,isSelected:o.includes(e.id)})))}get quantizer(){return this.parent.quantizer}getTick(e){const{transform:t,scrollLeft:n}=this.parent;return t.getTick(e+n)}getQuantizedTick(e){const{quantizer:t}=this.parent;return t.round(this.getTick(e))}}},98597:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(89193),r=n(78193);class s{language=null;constructor(){(0,o.Gn)(this,{language:o.sH}),(0,r.pu)(this,{name:"SettingStore",properties:["language"],storage:window.localStorage})}}},45331:(e,t,n)=>{n.d(t,{M:()=>c});var o=n(89193),r=n(78193),s=n(92390),i=n(92234),l=n(83710);const a=(0,i.r)()?[{id:-999,type:"file",path:"./assets/soundfonts/A320U.sf2",name:"A320U.sf2 (Signal Factory Sound)"}]:[{id:-999,type:"remote",name:"A320U.sf2 (Signal Factory Sound)",url:"https://cdn.jsdelivr.net/gh/ryohey/signal@4569a31/public/A320U.sf2"}];class c{storage;files=[];selectedSoundFontId=null;scanPaths=[];isLoading=!1;constructor(e){this.synth=e,(0,o.Gn)(this,{files:o.sH,selectedSoundFontId:o.sH,scanPaths:o.sH,isLoading:o.sH}),this.storage=new l.X("soundfonts",1)}async init(){await(0,r.pu)(this,{name:"SoundFontStore",properties:["selectedSoundFontId","scanPaths"],storage:window.localStorage}),await this.storage.init(),await this.updateFileList(),await this.load(this.selectedSoundFontId??a[0].id)}async updateFileList(){const e=await this.storage.list(),t=Object.keys(e).map((t=>({...e[Number(t)],id:Number(t)})));this.files=[...a,...t]}async getSoundFont(e){const t=a.find((t=>t.id===e));return void 0!==t?t:await this.storage.load(e)}async load(e){const t=await this.getSoundFont(e);if(null===t)throw new Error("SoundFont not found");switch(this.isLoading=!0,t.type){case"local":await this.synth.loadSoundFont(t.data);break;case"remote":await this.synth.loadSoundFontFromURL(t.url);break;case"file":{const e=await window.electronAPI.readFile(t.path);await this.synth.loadSoundFont(e);break}}this.selectedSoundFontId=e,this.isLoading=!1}async addSoundFont(e,t){await this.storage.save(e,t),await this.updateFileList()}async removeSoundFont(e){await this.storage.delete(e),await this.updateFileList()}async scanSoundFonts(){if(!(0,i.r)())return;await this.clearScannedSoundFonts();const e=[];for(const t of this.scanPaths){const n=(await window.electronAPI.searchSoundFonts(t)).map((e=>({data:{type:"file",path:e},metadata:{name:(0,s.P)(e),scanPath:t}})));e.push(...n)}await this.storage.saveMany(e),await this.updateFileList()}async clearScannedSoundFonts(){const e=await this.storage.list(),t=Object.entries(e).filter((e=>{let[,t]=e;return void 0!==t.scanPath&&this.scanPaths.includes(t.scanPath)})).map((e=>{let[t]=e;return Number(t)}));await this.storage.deleteMany(t)}async removeScanPath(e){await this.clearScannedSoundFonts(),this.scanPaths=this.scanPaths.filter((t=>t!==e)),this.scanSoundFonts()}async addScanPath(e){this.scanPaths.includes(e)||(this.scanPaths.push(e),await this.scanSoundFonts())}}},53603:(e,t,n)=>{n.d(t,{A:()=>h,o:()=>p});var o=n(89193),r=n(92770),s=n(61885),i=n(70480),l=n(6463),a=n(81220),c=n(28091),d=n(16541),u=n(11631);class h{rulerStore;tickScrollStore;scrollLeftTicks=0;scaleX=1;autoScroll=!0;canvasWidth=0;canvasHeight=0;quantize=4;isQuantizeEnabled=!0;mouseMode="pencil";selection=null;selectedEventIds=[];constructor(e){this.rootStore=e,this.rulerStore=new d.A(this,e.songStore),this.tickScrollStore=new u.M(this,.15,15),(0,o.Gn)(this,{scrollLeftTicks:o.sH,scaleX:o.sH,autoScroll:o.sH,canvasWidth:o.sH,canvasHeight:o.sH,quantize:o.sH,isQuantizeEnabled:o.sH,mouseMode:o.sH,selection:o.sH,selectedEventIds:o.sH,scrollLeft:o.EW,transform:o.EW,items:o.EW,cursorX:o.EW,contentWidth:o.EW,controlPoints:o.EW,selectionRect:o.EW})}setUpAutorun(){this.tickScrollStore.setUpAutoScroll()}setScrollLeftInPixels(e){this.tickScrollStore.setScrollLeftInPixels(e)}get scrollLeft(){return this.tickScrollStore.scrollLeft}get transform(){const e=r.PE.pixelsPerTick*this.scaleX;return new a.L(e,this.canvasHeight)}get cursorX(){return this.transform.getX(this.rootStore.player.position)}get items(){const{transform:e,canvasWidth:t,scrollLeft:n}=this,o=this.rootStore.song.conductorTrack?.events??[];return(0,s.i)(o,e,t+n)}get contentWidth(){return this.tickScrollStore.contentWidth}get quantizer(){return new c.A(this.rootStore,this.quantize,this.isQuantizeEnabled)}get controlPoints(){const{items:e}=this;return e.map((e=>({...p(e.bounds,4),id:e.id})))}get selectionRect(){const{selection:e,transform:t}=this;return null!=e?l.w.getBounds(e,t):null}hitTest(e){return this.controlPoints.find((t=>i.r.containsPoint(t,e)))?.id}}const p=(e,t)=>({x:e.x-t,y:e.y-t,width:2*t,height:2*t})},55610:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(89193),r=n(78193);class s{themeType="dark";constructor(){(0,o.Gn)(this,{themeType:o.sH}),(0,r.pu)(this,{name:"ThemeStore",properties:["themeType"],storage:window.localStorage})}}},11631:(e,t,n)=>{n.d(t,{M:()=>s});var o=n(17243),r=n(89193);class s{constructor(e,t,n){this.parent=e,this.minScaleX=t,this.maxScaleX=n,(0,r.Gn)(this,{scrollLeft:r.EW,playheadPosition:r.EW,playheadInScrollZone:r.EW})}get scrollLeft(){return Math.round(this.parent.transform.getX(this.parent.scrollLeftTicks))}setUpAutoScroll(){(0,r.fm)((()=>{const{autoScroll:e,rootStore:{player:t}}=this.parent,{isPlaying:n,position:o}=t,{playheadInScrollZone:r}=this;e&&n&&r&&(this.parent.scrollLeftTicks=o)}))}setScrollLeftInPixels(e){const{contentWidth:t}=this,{transform:n,canvasWidth:r}=this.parent,s=t-r,i=(0,o.clamp)(e,0,s);this.parent.scrollLeftTicks=n.getTick(i)}setScrollLeftInTicks(e){this.setScrollLeftInPixels(this.parent.transform.getX(e))}get contentWidth(){const{transform:e,canvasWidth:t}=this.parent,n=this.parent.rootStore.song.endOfSong,o=e.getTick(this.scrollLeft)+e.getTick(t);return e.getX(Math.max(n,o))}scaleAroundPointX(e,t){const{maxScaleX:n,minScaleX:r}=this,s=this.parent.transform.getTick(this.scrollLeft+t);this.parent.scaleX=(0,o.clamp)(this.parent.scaleX*(1+e),r,n);const i=this.parent.transform.getTick(this.scrollLeft+t)-s;this.setScrollLeftInTicks(this.parent.scrollLeftTicks-i)}get playheadPosition(){const{transform:e,scrollLeftTicks:t,rootStore:{player:n}}=this.parent;return e.getX(n.position-t)}get playheadInScrollZone(){const{canvasWidth:e}=this.parent;return this.playheadPosition<0||this.playheadPosition>.7*e}}},61426:(e,t,n)=>{n.d(t,{_:()=>s});var o=n(89193),r=n(45322);const s=e=>{(0,o.lB)(e.midiDeviceStore,"enabledOutputs",i(e)),(0,o.fm)(l(e)),(0,o.fm)(i(e)),(0,o.lB)(e.midiRecorder,"isRecording",a(e)),(0,o.lB)(e.player,"isPlaying",c(e))},i=e=>{let{midiDeviceStore:t,player:n,synth:o,synthGroup:s}=e;return()=>{const{outputs:e,enabledOutputs:i,isFactorySoundEnabled:l}=t;n.allSoundsOff();const a=e.map((e=>({synth:new r.A(e),isEnabled:i[e.id]})));s.outputs=[{synth:o,isEnabled:l},...a]}},l=e=>{let{midiDeviceStore:t,midiInput:n}=e;return()=>{const{inputs:e,enabledInputs:o}=t,r=e.filter((e=>o[e.id]));n.removeAllDevices(),r.forEach(n.addDevice)}},a=e=>{let{player:t,midiRecorder:n}=e;return()=>t.disableSeek=n.isRecording},c=e=>{let{player:t,midiRecorder:n}=e;return()=>{t.isPlaying||(n.isRecording=!1)}}},11051:(e,t,n)=>{n.d(t,{V:()=>o});const o=e=>{let{themeType:t}=e;switch(t){case"dark":return"Dark";case"light":return"Light";default:return"Unknown"}}},21579:(e,t,n)=>{n.d(t,{N:()=>a});var o=n(83785),r=n(69229),s=n(59061),i=n(56416),l=n(62540);const a=(0,r.PA)((e=>{let{children:t}=e;const{themeStore:n}=(0,s.g)();return(0,l.jsx)(o.a,{theme:i.Z[n.themeType],children:t})}))},74124:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(89193);function r(e,t,n){return{...e,[t]:n}}class s{mutes={};solos={};constructor(){(0,o.Gn)(this,{mutes:o.sH,solos:o.sH})}reset(){this.mutes={},this.solos={}}_setMute(e,t){this.isSoloMode()||(this.mutes=r(this.mutes,e,t))}_getMute(e){return this.mutes[e]||!1}_setSolo(e,t){this.solos=r(this.solos,e,t)}_getSolo(e){return this.solos[e]||!1}mute(e){this._setMute(e,!0)}unmute(e){this._setMute(e,!1)}solo(e){this._setSolo(e,!0)}unsolo(e){this._setSolo(e,!1)}isSoloMode(){return Object.values(this.solos).some((e=>e))}shouldPlayTrack(e){return this.isSoloMode()?this._getSolo(e):!this._getMute(e)}isSolo(e){return this.isSoloMode()&&this.solos[e]}isMuted(e){return!this.shouldPlayTrack(e)}}},11864:(e,t,n)=>{n.d(t,{A:()=>f,q:()=>w});var o=n(18264),r=n.n(o),s=n(24319),i=n.n(s),l=n(1883),a=n.n(l),c=n(89193),d=n(39013),u=n(26556),h=n(99119),p=n(6358),m=n(97983),g=n(49214),x=n(63166);n(41357);const w=-1;class f{id=(()=>w)();events=[];channel=void 0;lastEventId=0;getEventById=e=>this.events.find((t=>t.id===e));constructor(){(0,c.Gn)(this,{updateEvent:c.XI,updateEvents:c.XI,removeEvent:c.XI,removeEvents:c.XI,addEvent:c.XI,addEvents:c.XI,sortByTick:c.XI,name:c.EW,endOfTrack:c.EW,programNumber:c.EW,isConductorTrack:c.EW,isRhythmTrack:c.EW,color:c.EW,id:c.sH,events:c.sH.shallow,channel:c.sH})}_updateEvent(e,t){const n=this.events.findIndex((t=>t.id===e));if(n<0)return console.warn(`unknown id: ${e}`),null;const o=this.events[n],s={...o,...t};return r()(s,o)?null:(this.events[n]=s,s)}updateEvent(e,t){const n=this._updateEvent(e,t);return n&&this.sortByTick(),n}updateEvents(e){(0,c.Rn)((()=>{e.forEach((e=>{void 0!==e.id&&this._updateEvent(e.id,e)}))})),this.sortByTick()}removeEvent(e){this.removeEvents([e])}removeEvents(e){this.events=this.events.filter((t=>!e.includes(t.id)))}_addEvent(e){if(!("tick"in e)||isNaN(e.tick))throw new Error("invalid event is added");if("subtype"in e&&"endOfTrack"===e.subtype)throw new Error("endOfTrack event is added");const t={...i()(e,["deltaTime","channel"]),id:this.lastEventId++};return this.events.push(t),t}addEvent(e){const t=this._addEvent(e);return this.didAddEvent(),t}addEvents(e){const t=(0,c.Rn)((()=>{const t=this.isConductorTrack;return e.filter((e=>!t||"channel"!==e.type)).map((e=>this._addEvent(e)))}));return this.didAddEvent(),t}didAddEvent(){this.sortByTick()}sortByTick(){this.events=a()(this.events,"tick")}transaction(e){return(0,c.Rn)((()=>e(this)))}getRedundantEvents(e){return this.events.filter((t=>!(t.type!==e.type||t.tick!==e.tick||"subtype"in t&&"subtype"in e&&t.subtype!==e.subtype||"controllerType"in t&&"controllerType"in e&&t.controllerType!==e.controllerType)))}createOrUpdate(e){const t=this.getRedundantEvents(e);return t.length>0?(this.transaction((n=>{t.forEach((t=>{n.updateEvent(t.id,{...e,id:t.id})}))})),t[0]):this.addEvent(e)}removeRedundantEvents(e){this.removeEvents(this.getRedundantEvents(e).filter((t=>t.id!==e.id)).map((e=>e.id)))}setControllerValue=(e,t,n)=>{const o=(0,g.Ps)(this.events.filter((0,m.HG)(e)).filter((0,g.pD)(t)));void 0!==o?this.updateEvent(o.id,{value:n}):this.addEvent({type:"channel",subtype:"controller",controllerType:e,tick:0,value:n})};get name(){return(0,g.pL)(this.events)?.text}get programNumber(){return(0,g.KW)(this.events)?.value}get endOfTrack(){let e=0;for(const t of this.events){const n=(0,m.Fb)(t)?t.tick+t.duration:t.tick;e=Math.max(e,n)}return e}get color(){return this.events.filter(x.t6)[0]}setColor(e){if(null===e){const e=this.color;return void(void 0!==e&&this.removeEvent(e.id))}const t=this.color;void 0!==t?this.updateEvent(t.id,e):this.addEvent({tick:0,type:"channel",subtype:"signal",signalEventType:"trackColor",...e})}getPan=e=>(0,g.C5)(this.events,e);getVolume=e=>(0,g.v1)(this.events,e);getTempo=e=>(0,g.ge)(this.events,e);getTimeSignatureEvent=e=>(0,g._C)(this.events,e);setVolume=(e,t)=>this.setControllerValue(7,t,e);setPan=(e,t)=>this.setControllerValue(10,t,e);setProgramNumber(e){const t=(0,g.KW)(this.events);void 0!==t?this.updateEvent(t.id,{value:e}):this.addEvent({...(0,p.Ch)(0,0,e),tick:0})}setTempo(e,t){const n=(0,g.uD)(this.events,t),o=Math.floor((0,u.w4)(e));void 0!==n?this.updateEvent(n.id,{microsecondsPerBeat:o}):this.addEvent({...(0,p.F8)(0,o),tick:0})}setName(e){const t=(0,g.pL)(this.events);void 0!==t?this.updateEvent(t.id,{text:e}):this.addEvent({...(0,p.qL)(0,e),tick:0})}get isConductorTrack(){return void 0===this.channel}get isRhythmTrack(){return 9===this.channel}clone(){const e=new f;return e.channel=this.channel,e.addEvents(this.events.map((e=>({...e})))),e}}(0,d.PL)(f,{id:(0,d.MY)(),events:(0,d.p_)(h.Z),lastEventId:(0,d.MY)(),channel:(0,d.MY)()})},30453:(e,t,n)=>{n.d(t,{I:()=>r,g:()=>o});const o=e=>`rgba(${e.red}, ${e.green}, ${e.blue}, ${e.alpha/255})`,r=e=>[e.red/255,e.green/255,e.blue/255,e.alpha/255]},18240:(e,t,n)=>{n.d(t,{BQ:()=>a,bL:()=>i});var o=n(67200),r=n(6358),s=n(11864);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=new s.A,n=(0,o.os)([(0,r.qL)(0,e),(0,r.BQ)(0),(0,r.F8)(0,5e5),(0,r.ly)(0)]);return t.addEvents(n),t}const l=e=>[(0,r.qZ)(0,e),(0,r.qL)(0,""),(0,r.t3)(0,e,64),(0,r.E0)(0,e,100),(0,r.GF)(0,e,127),...(0,r.Ey)(0,e),...(0,r.jq)(0,e),...(0,r.WY)(0,e,12),(0,r.fJ)(0,e,8192),(0,r.ww)(0,e,0),(0,r.Ch)(0,e,0)];function a(e){if(!Number.isInteger(e))throw new Error("channel is not integer");const t=new s.A;t.channel=e;const n=(0,o.os)([...l(e),(0,r.ly)(1)]);return t.addEvents(n),t}},97983:(e,t,n)=>{n.d(t,{D3:()=>u,Fb:()=>o,HG:()=>d,Hq:()=>c,SW:()=>h,XD:()=>r,Xz:()=>s,Y6:()=>i,c_:()=>p,u3:()=>l,y5:()=>a});const o=e=>"subtype"in e&&"note"===e.subtype,r=e=>"subtype"in e&&"trackName"===e.subtype,s=e=>"subtype"in e&&"programChange"===e.subtype,i=e=>"subtype"in e&&"pitchBend"===e.subtype,l=e=>"subtype"in e&&"setTempo"===e.subtype,a=e=>"subtype"in e&&"timeSignature"===e.subtype,c=e=>"subtype"in e&&"controller"===e.subtype,d=e=>t=>c(t)&&t.controllerType===e,u=d(7),h=d(10),p=(d(1),d(11),e=>"subtype"in e&&"sequencerSpecific"===e.subtype)},22095:(e,t,n)=>{n.d(t,{Ay:()=>r.A,BQ:()=>s.BQ,Fb:()=>o.Fb,HG:()=>o.HG,Y6:()=>o.Y6,bL:()=>s.bL,c_:()=>o.c_,ql:()=>r.q,u3:()=>o.u3,y5:()=>o.y5});var o=n(97983),r=n(11864),s=n(18240)},49214:(e,t,n)=>{n.d(t,{C5:()=>u,KW:()=>g,Ps:()=>a,_C:()=>m,_g:()=>w,ge:()=>x,pD:()=>c,pL:()=>h,uD:()=>p,v1:()=>d});var o=n(17243),r=n(13459),s=n.n(r),i=n(20604),l=n(97983);const a=e=>(0,o.maxBy)(e,(e=>e.tick)),c=e=>t=>t.tick<=e,d=(e,t)=>a(e.filter(l.D3).filter(c(t)))?.value,u=(e,t)=>a(e.filter(l.SW).filter(c(t)))?.value,h=e=>a(e.filter(l.XD)),p=(e,t)=>a(e.filter(l.u3).filter(c(t))),m=(e,t)=>a(e.filter(l.y5).filter(c(t))),g=e=>a(e.filter(l.Xz)),x=(e,t)=>{const n=p(e,t);if(void 0!==n)return 6e7/n.microsecondsPerBeat},w=(e,t)=>{const n=e.filter(l.Hq).filter(c(t));return[...s()(n.map((e=>e.controllerType))).map((e=>a(n.filter((0,l.HG)(e))))).filter(i.EA),a(e.filter(l.u3).filter(c(t))),a(e.filter(l.Xz).filter(c(t))),a(e.filter(l.Y6).filter(c(t)))].filter(i.EA)}},63166:(e,t,n)=>{n.d(t,{X6:()=>c,XS:()=>i,m0:()=>a,t6:()=>l});var o=n(17243);const r="Sign".split("").map((e=>e.charCodeAt(0)));var s=function(e){return e[e.preserved=0]="preserved",e[e.trackColor=1]="trackColor",e}(s||{});const i=e=>"subtype"in e&&"signal"===e.subtype,l=e=>i(e)&&"trackColor"===e.signalEventType,a=e=>e.data.length<=5||!(0,o.isEqual)(e.data.slice(0,4),r)?e:e.data[4]===s.trackColor?9!==e.data.length?e:{...e,subtype:"signal",signalEventType:"trackColor",alpha:e.data[5],blue:e.data[6],green:e.data[7],red:e.data[8]}:e,c=e=>{if("trackColor"===e.signalEventType)return{id:e.id,tick:e.tick,type:"meta",subtype:"sequencerSpecific",data:[...r,s.trackColor,e.alpha,e.blue,e.green,e.red]}}},41357:(e,t,n)=>{n(17243)},83537:(e,t,n)=>{n.d(t,{n:()=>s});var o=n(491),r=n(45271);const s=(e,t)=>new i(e,t);class i{firestore;functions;constructor(e,t){this.firestore=e,this.functions=t}async get(e){const t=(0,o.rJ)(this.firestore,"midis"),n=await(0,o.x7)((0,o.H9)(t,e).withConverter(l)),r=n.data()?.data;if(void 0===r)throw new Error("Midi data does not exist");return r.toUint8Array()}async storeMidiFile(e){const t=(0,r.Qg)(this.functions,"storeMidiFile");return(await t({midiFileUrl:e})).data.docId}}const l={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e}},69345:(e,t,n)=>{n.d(t,{TA:()=>r,es:()=>l});var o=n(491);const r=(e,t)=>new s(e,t);class s{firestore;auth;constructor(e,t){this.firestore=e,this.auth=t}get songDataCollection(){return l(this.firestore)}songDataRef(e){return(0,o.H9)(this.songDataCollection,e)}async create(e){if(null===this.auth.currentUser)throw new Error("You must be logged in to save songs to the cloud");const t=this.auth.currentUser.uid,n=(0,o.H9)(this.songDataCollection);return await(0,o.c4)(this.firestore,(async r=>{r.set(n,{createdAt:(0,o.O5)(),updatedAt:(0,o.O5)(),data:o.Ix.fromUint8Array(e.data),userId:t})})),n.id}async get(e){const t=this.songDataRef(e),n=await(0,o.x7)(t),r=n.data()?.data;if(void 0===r)throw new Error("Song data does not exist");return r.toUint8Array()}async update(e,t){const n=this.songDataRef(e);await(0,o.c4)(this.firestore,(async e=>{e.update(n,{updatedAt:(0,o.O5)(),data:o.Ix.fromUint8Array(t.data)})}))}async publish(e){const t=this.songDataRef(e);await(0,o.c4)(this.firestore,(async e=>{e.update(t,{isPublic:!0})}))}async unpublish(e){const t=this.songDataRef(e);await(0,o.c4)(this.firestore,(async e=>{e.update(t,{isPublic:!1})}))}async delete(e){await(0,o.c4)(this.firestore,(async t=>{t.delete(this.songDataRef(e))}))}}const i={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e},l=e=>(0,o.rJ)(e,"songData").withConverter(i)},34865:(e,t,n)=>{n.d(t,{X:()=>i});var o=n(491),r=n(69345),s=n(41862);const i=(e,t)=>new l(e,t);class l{firestore;auth;constructor(e,t){this.firestore=e,this.auth=t}get songCollection(){return d(this.firestore)}songRef(e){return(0,o.H9)(this.songCollection,e)}async get(e){const t=await(0,o.x7)(this.songRef(e));return t.exists()?a(t):null}async create(e){if(null===this.auth.currentUser)throw new Error("You must be logged in to save songs to the cloud");const t=this.auth.currentUser.uid,n=(0,o.H9)((0,r.es)(this.firestore),e.songDataId),s=(0,o.H9)(this.songCollection);return await(0,o.c4)(this.firestore,(async r=>{r.set(s,{name:e.name,createdAt:(0,o.O5)(),updatedAt:(0,o.O5)(),dataRef:n,userId:t})})),s.id}async update(e,t){const n=this.songRef(e);await(0,o.c4)(this.firestore,(async e=>{e.update(n,{updatedAt:(0,o.O5)(),name:t.name})}))}async delete(e){await(0,o.c4)(this.firestore,(async t=>{t.delete(this.songRef(e))}))}async publish(e,t){const n=this.songRef(e);await(0,o.c4)(this.firestore,(async e=>{e.update(n,{isPublic:!0,publishedAt:(0,o.O5)(),user:t})}))}async unpublish(e){const t=this.songRef(e);await(0,o.c4)(this.firestore,(async e=>{e.update(t,{isPublic:!1,publishedAt:null})}))}async getMySongs(){if(null===this.auth.currentUser)throw new Error("You must be logged in to get songs from the cloud");return(await(0,o.GG)((0,o.P)(this.songCollection,(0,o._M)("userId","==",this.auth.currentUser.uid),(0,o.My)("updatedAt","desc")))).docs.map(a)}async getPublicSongs(){const e=(0,o.P)(this.songCollection,(0,o._M)("isPublic","==",!0),(0,o.My)("publishedAt","desc"));return(await(0,o.GG)(e)).docs.map(a)}async getPublicSongsByUser(e){const t=(0,o.P)(this.songCollection,(0,o._M)("isPublic","==",!0),(0,o._M)("userId","==",e),(0,o.My)("publishedAt","desc"));return(await(0,o.GG)(t)).docs.map(a)}async incrementPlayCount(e){const t=this.songRef(e);await(0,o.c4)(this.firestore,(async e=>{e.update(t,{playCount:(0,o.GV)(1)})}))}}const a=e=>{const t=e.data();return{...t,id:e.id,songDataId:t.dataRef.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),publishedAt:t.publishedAt?.toDate(),user:t.user&&(0,s.n)(t.userId,t.user)}},c={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e},d=e=>(0,o.rJ)(e,"songs").withConverter(c)},41862:(e,t,n)=>{n.d(t,{_:()=>s,n:()=>l});var o=n(17354),r=n(491);const s=(e,t)=>new i(e,t);class i{firestore;auth;constructor(e,t){this.firestore=e,this.auth=t}get userCollection(){return(0,r.rJ)(this.firestore,"users").withConverter(c)}get userRef(){if(null===this.auth.currentUser)throw new Error("You must be logged in to get the current user");return(0,r.H9)(this.userCollection,this.auth.currentUser.uid)}async create(e){await(0,r.c4)(this.firestore,(async t=>{t.set(this.userRef,{name:e.name,bio:e.bio,createdAt:r.Dc.now(),updatedAt:r.Dc.now()})}))}async update(e){await(0,r.c4)(this.firestore,(async t=>{t.update(this.userRef,{name:e.name,bio:e.bio,updatedAt:r.Dc.now()})}))}async delete(){if(null===this.auth.currentUser)throw new Error("You must be logged in to delete the current user");await(0,r.c4)(this.firestore,(async e=>{e.delete(this.userRef)})),(0,o.hG)(this.auth.currentUser)}async getCurrentUser(){const e=await(0,r.x7)(this.userRef);return e.exists()?a(e):null}async get(e){const t=await(0,r.x7)((0,r.H9)(this.userCollection,e));return t.exists()?a(t):null}async getByUsername(e){const t=(0,r.P)(this.userCollection,(0,r._M)("name","==",e)),n=await(0,r.GG)(t);if(n.empty)return null;const o=n.docs[0];return a(o)}observeCurrentUser(e){try{return(0,r.aQ)(this.userRef,(t=>{t.exists()?e(a(t)):e(null)}))}catch(e){return console.warn(e),()=>{}}}observeAuthUser(e){return this.auth?.onAuthStateChanged((t=>{e(t)}))}}const l=(e,t)=>({id:e,name:t.name,bio:t.bio,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate()}),a=e=>{const t=e.data();return l(e.id,t)},c={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e}},69825:(e,t,n)=>{n.d(t,{TA:()=>r.TA,XW:()=>s.X,_x:()=>i._,n2:()=>o.n});var o=n(83537),r=n(69345),s=n(34865),i=n(41862)},20994:(e,t,n)=>{n.d(t,{Co:()=>o.Co,MV:()=>o.MV,QI:()=>s.QI,Vx:()=>r.Vx,dj:()=>i.dj,kc:()=>s.kc,p1:()=>r.p1,sk:()=>s.sk,sp:()=>o.sp,tE:()=>i.tE});var o=n(16829),r=n(80302),s=n(16959),i=n(45582)},16829:(e,t,n)=>{n.d(t,{Co:()=>s,MV:()=>i,sp:()=>l});var o=n(62540),r=n(63696);const s=e=>{let{children:t,component:n}=e;const[s,l]=(0,r.useState)(null);return(0,o.jsxs)(i.Provider,{value:{setDialog:l},children:[t,null!==s&&(0,o.jsx)(n,{...s})]})},i=(0,r.createContext)(null),l=()=>{const{setDialog:e}=(0,r.useContext)(i);return{show:async t=>new Promise(((n,o)=>{e({...t,callback:e=>n(e)})}))}}},80302:(e,t,n)=>{n.d(t,{Vx:()=>i,p1:()=>l});var o=n(62540),r=n(63696);const s=(0,r.createContext)(null),i=e=>{let{children:t,component:n}=e;const[i,l]=(0,r.useState)([]);return(0,o.jsxs)(s.Provider,{value:{addMessage:e=>(l((t=>[...t,e])),()=>{return t=e.key,l((e=>e.filter((e=>e.key!==t))));var t})},children:[t,i.map((e=>(0,o.jsx)(n,{open:!0,message:e.message},e.key)))]})},l=()=>{const{addMessage:e}=(0,r.useContext)(s);return{show:t=>e({message:t,key:(new Date).getTime()})}}},16959:(e,t,n)=>{n.d(t,{QI:()=>i,kc:()=>l,sk:()=>s});var o=n(62540),r=n(63696);const s=e=>{let{children:t,component:n}=e;const[s,l]=(0,r.useState)(null);return(0,o.jsxs)(i.Provider,{value:{setPrompt:l},children:[t,null!==s&&(0,o.jsx)(n,{...s})]})},i=(0,r.createContext)(null),l=()=>{const{setPrompt:e}=(0,r.useContext)(i);return{show:async t=>new Promise(((n,o)=>{e({...t,callback:e=>n(e)})}))}}},45582:(e,t,n)=>{n.d(t,{dj:()=>l,tE:()=>i});var o=n(62540),r=n(63696);const s=(0,r.createContext)(null),i=e=>{let{children:t,component:n}=e;const[i,l]=(0,r.useState)([]);return(0,o.jsxs)(s.Provider,{value:{addMessage(e){l((t=>[...t,e]))}},children:[t,i.map((e=>(0,o.jsx)(n,{message:e.message,severity:e.severity,onExited:()=>{return t=e.key,l((e=>e.filter((e=>e.key!==t))));var t}},e.key)))]})},l=()=>{const{addMessage:e}=(0,r.useContext)(s),t=(t,n)=>{e({message:t,...n,key:(new Date).getTime()})};return{show:t,info(e){t(e,{severity:"info"})},success(e){t(e,{severity:"success"})},warning(e){t(e,{severity:"warning"})},error(e){t(e,{severity:"error"})}}}},6205:(e,t,n)=>{n.d(t,{a:()=>r});var o=n(40889);class r{lookAheadTime=100;timebase=480;loop=null;_currentTick=0;_scheduledTick=0;_prevTime=void 0;_getEvents;_createLoopEndEvents;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:480,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this._getEvents=e,this._createLoopEndEvents=t,this._currentTick=n,this._scheduledTick=n,this.timebase=o,this.lookAheadTime=r}get scheduledTick(){return this._scheduledTick}millisecToTick(e,t){return e/1e3*t/60*this.timebase}seek(e){this._currentTick=this._scheduledTick=Math.max(0,e)}readNextEvents(e,t){const n=n=>r=>{const s=r.tick-n;return{event:r,timestamp:t+Math.max(0,(0,o.b)(s,e,this.timebase))}},r=(e,t,o)=>this._getEvents(e,t).map(n(o));void 0===this._prevTime&&(this._prevTime=t);const s=t-this._prevTime,i=Math.max(0,this.millisecToTick(s,e)),l=this._currentTick+i,a=this.millisecToTick(this.lookAheadTime,e),c=this._scheduledTick,d=l+a;if(this._prevTime=t,null!==this.loop&&c<this.loop.end&&d>=this.loop.end){const e=this.loop,t=d-e.end,o=e.begin+t,s=e.begin-(e.end-l);return this._currentTick=s,this._scheduledTick=o,[...r(c,e.end,l),...this._createLoopEndEvents().map((t=>n(s)({...t,tick:e.begin}))),...r(e.begin,o,s)]}return this._currentTick=l,this._scheduledTick=d,r(c,d,l)}}},70467:(e,t,n)=>{function o(e,t,n,o){return{deltaTime:e,type:"channel",subtype:"controller",channel:t,controllerType:n,value:o}}n.d(t,{Q:()=>o})},94801:(e,t,n)=>{n.d(t,{a:()=>d,g:()=>c});var o=n(53649),r=n(32858),s=n(10962),i=n(89193),l=n(6205),a=n(70467);const c=120;class d{output;eventSource;scheduler=null;interval=null;_currentTempo=(()=>c)();_currentTick=0;_isPlaying=!1;disableSeek=!1;loop=null;constructor(e,t){this.output=e,this.eventSource=t,(0,i.Gn)(this,{_currentTick:i.sH,_isPlaying:i.sH,loop:i.sH,position:i.EW,isPlaying:i.EW})}play(){this.isPlaying?console.warn("called play() while playing. aborted."):(this.scheduler=new l.a(((e,t)=>this.eventSource.getEvents(e,t)),(()=>this.allNotesOffEvents()),this._currentTick,this.eventSource.timebase,100),this._isPlaying=!0,this.output.activate(),this.interval=window.setInterval((()=>this._onTimer()),50),this.output.activate())}set position(e){Number.isInteger(e)||console.warn("Player.tick should be an integer",e),this.disableSeek||(e=Math.min(Math.max(Math.floor(e),0),this.eventSource.endOfSong),this.scheduler&&this.scheduler.seek(e),this._currentTick=e,this.isPlaying&&this.allSoundsOff(),this.sendCurrentStateEvents())}get position(){return this._currentTick}get isPlaying(){return this._isPlaying}get numberOfChannels(){return 15}allSoundsOffChannel(e){this.sendEvent((0,a.Q)(0,e,s.M$.ALL_SOUNDS_OFF,0))}allSoundsOff(){for(const e of o(0,this.numberOfChannels))this.allSoundsOffChannel(e)}allSoundsOffExclude(e){for(const t of o(0,this.numberOfChannels))t!==e&&this.allSoundsOffChannel(t)}allNotesOffEvents(){return o(0,this.numberOfChannels).map((e=>({...(0,a.Q)(0,e,s.M$.ALL_NOTES_OFF,0),trackId:-1})))}resetControllers(){for(const e of o(0,this.numberOfChannels))this.sendEvent((0,a.Q)(0,e,s.M$.RESET_CONTROLLERS,127))}stop(){this.scheduler=null,this.allSoundsOff(),this._isPlaying=!1,null!==this.interval&&(clearInterval(this.interval),this.interval=null)}reset(){this.resetControllers(),this.stop(),this._currentTick=0}sendCurrentStateEvents(){this.eventSource.getCurrentStateEvents(this._currentTick).forEach((e=>{this.applyPlayerEvent(e),this.sendEvent(e)}))}get currentTempo(){return this._currentTempo}set currentTempo(e){this._currentTempo=e}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:performance.now(),o=arguments.length>3?arguments[3]:void 0;this.output.sendEvent(e,t,n,o)}syncPosition=(()=>r((()=>{null!==this.scheduler&&(this._currentTick=this.scheduler.scheduledTick)}),50))();applyPlayerEvent(e){"channel"!==e.type&&"subtype"in e&&"setTempo"===e.subtype&&(this._currentTempo=6e7/e.microsecondsPerBeat)}_onTimer(){if(null===this.scheduler)return;const e=performance.now();this.scheduler.loop=null!==this.loop&&this.loop.enabled?this.loop:null,this.scheduler.readNextEvents(this._currentTempo,e).forEach((t=>{let{event:n,timestamp:o}=t;if("channel"===n.type){const t=(o-e)/1e3;this.sendEvent(n,t,e,n.trackId)}else this.applyPlayerEvent(n)})),this.scheduler.scheduledTick>=this.eventSource.endOfSong&&this.stop(),this.syncPosition()}playOrPause(){this.isPlaying?this.stop():this.play()}setLoopBegin(e){this.loop={end:Math.max(e,this.loop?.end??e),enabled:this.loop?.enabled??!1,begin:e}}setLoopEnd(e){this.loop={begin:Math.min(e,this.loop?.begin??e),enabled:this.loop?.enabled??!1,end:e}}toggleEnableLoop(){null!==this.loop&&(this.loop={...this.loop,enabled:!this.loop.enabled})}}},70012:(e,t,n)=>{n.d(t,{F:()=>r});var o=n(15172);class r{context;synth=null;_loadedSoundFontData=null;get loadedSoundFontData(){return this._loadedSoundFontData}get isLoaded(){return null!==this._loadedSoundFontData}sequenceNumber=0;constructor(e){this.context=e}async setup(){const e=new URL(n(55570),n.b);await this.context.audioWorklet.addModule(e)}async loadSoundFontFromURL(e){const t=await fetch(e),n=await t.arrayBuffer();await this.loadSoundFont(n)}async loadSoundFont(e){null!==this.synth&&this.synth.disconnect(),this.synth=new AudioWorkletNode(this.context,"synth-processor",{numberOfInputs:0,outputChannelCount:[2]}),this.synth.connect(this.context.destination),this.sequenceNumber=0;const t=(0,o.AM)(new Uint8Array(e));this._loadedSoundFontData=e;for(const e of t)this.postSynthMessage(e.event,e.transfer)}postSynthMessage(e,t){this.synth?.port.postMessage({...e,sequenceNumber:this.sequenceNumber++},t??[])}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.postSynthMessage({type:"midi",midi:e,delayTime:t*this.context.sampleRate})}activate(){this.context.resume()}}},1902:(e,t,n)=>{n.d(t,{Fu:()=>r.F,ai:()=>o.a,b7:()=>s.b,gg:()=>o.g});var o=n(94801),r=n(70012),s=n(52516)},52516:(e,t,n)=>{n.d(t,{b:()=>s});var o=n(15172),r=n(94726);const s=async(e,t,n,s,i)=>{const l=(0,o.AM)(new Uint8Array(e)),a=(0,r.V)(t,n,s),c=l.map((e=>e.event)),d=await(0,o.b7)(c,a,{sampleRate:s,bufferSize:i.bufferSize,cancel:i.cancel,waitForEventLoop:i.waitForEventLoop,onProgress:i.onProgress});return(0,o.Mf)(d)}},40889:(e,t,n)=>{function o(e,t,n){return e/(n/60)/t*1e3}n.d(t,{b:()=>o})},94726:(e,t,n)=>{n.d(t,{V:()=>r});var o=n(40889);const r=(e,t,n)=>{e=e.sort(((e,t)=>e.tick-t.tick));let r={tick:0,bpm:120,timestamp:0};const s=[];for(const i of e){const e=(0,o.b)(i.tick-r.tick,r.bpm,t)+r.timestamp,l=e/1e3*n;switch(i.type){case"channel":s.push({type:"midi",midi:i,delayTime:l});case"meta":"setTempo"===i.subtype&&(r={tick:i.tick,bpm:6e7/i.microsecondsPerBeat,timestamp:e})}}return s}}},r={};function s(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,loaded:!1,exports:{}};return o[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=o,s.amdD=function(){throw new Error("define cannot be used indirect")},e=[],s.O=(t,n,o,r)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,o,r]=e[d],l=!0,a=0;a<n.length;a++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](n[a])))?n.splice(a--,1):(l=!1,r<i&&(i=r));if(l){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var r=Object.create(null);s.r(r);var i={};t=t||[null,n({}),n([]),n(n)];for(var l=2&o&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(r,i),r},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={154:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[i,l,a]=n,c=0;if(i.some((t=>0!==e[t]))){for(o in l)s.o(l,o)&&(s.m[o]=l[o]);if(a)var d=a(s)}for(t&&t(n);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},n=self.webpackChunksignal=self.webpackChunksignal||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var i=s.O(void 0,[422,929,534,595],(()=>s(9357)));i=s.O(i)})();